{"version":3,"sources":["data/tsne/p_numProjectsSDG.csv","images/siris_logo_menu1.png","common/index.js","components/tooltip.js","components/CountryPlotGenerator.js","components/tsne/tsne.js","components/tsne/tsnePlot.js","containers/CountryPlots/countriesLayoutUtils.js","containers/CountryPlots/statemachine.js","components/ternayPlot/TernaryPlot.js","common/constants.js","common/vega/VegaChart.js","common/vega/VegaSignalListener.js","common/vega/specifications/VegaSpecStripPlot.js","common/fisheye.js","containers/CountryPlots/index.js","common/vega/specifications/areaChart.js","common/vega/specifications/areaChartAll.js","common/vega/specifications/sdg-keyword-trend.js","common/vega/specifications/streamgraph.js","common/vega/specifications/keywords-increments.js","components/AreaCharts.js","containers/Introduction/index.js","containers/Header.js","common/vega/VegaUtils.js","containers/Streamriver/wordcloud2.js","containers/Streamriver/canvasSDG.js","components/Annotation.js","containers/Streamriver/WordleGenerator.js","containers/Streamriver/StreamRiver.js","common/sparql/PostQuery.js","common/sparql/vocab/xsd.js","common/sparql/rdf/DatatypeLabel.js","common/sparql/rdf/DatatypeLabelInteger.js","common/sparql/rdf/DatatypeLabelString.js","common/sparql/rdf/DatatypeLabelFloat.js","common/sparql/rdf/DatatypeLabelDate.js","common/sparql/rdf/DatatypeLabelBoolean.js","common/sparql/rdf/defaultRdfDatatypes.js","common/sparql/ResultSet.js","components/SDGTreemap.js","components/CORDISKeywords.js","components/KeywordData.js","images/svg/SI-legend.svg","containers/Home/index.js","routes.js","App.js","serviceWorker.js","webpack:///./src/index.js?b635"],"names":["module","exports","history","createBrowserHistory","EMPTY_OBJECT","SDG","undefined","numProjectsSDG","p_fundingSDG","p_numProjectsSDG","SI_numProjects","SI_funding","p_totalNumCORDIS","p_totalFundingCORDIS","sorting","totalFundingCountry","totalProjectsCountry","shortTitle","SDG_INFO","SDG_ARR","SDG_GROUPING","name","includes","color","SELECTED_COUNTRIES","countryName","REFS","PRIMARY_COUNTRY","SECONDARY_COUNTRY_0","SECONDARY_COUNTRY_1","SECONDARY_COUNTRY_2","SECONDARY_COUNTRY_3","SECONDARY_HEADER","CONTINENT_COLORS","Tooltip","show","title","subtitle","datablocks","vizspecs","footer","tooltip","d3","style","pageX","noData","length","select","selectAll","remove","html","forEach","datablock","datablockDiv","append","attr","key","value","offsetHeight","node","spec","height","pageY","tooltipWidth","getBoundingClientRect","width","tooltipX","left","window","innerWidth","hide","move","coords","CountryPlotGenerator","elementSelector","label","id","placeholderInfo","data","countryVariable","ghostVariable","sortingVariable","callbacks","this","HIDDEN","VISIBLE","FOLDED","UNFOLDED","dotRadius","dotLabelSize","x","y","isFake","radius","setRadius","config","svg","innerRadius","setInnerRadius","pie","sort","d","texture","textures","lines","size","strokeWidth","stroke","display","createPlaceholder","drawMultidimensionalPlot","drawDotPlot","selection","self","classed","isPrimary","Math","min","updateMultidimensionalPlot","calculateGroupsScore","svgGroup","state","gPlaceholder","dotGroup","isStatic","info","interrupt","transition","duration","ease","on","fold","delay","i","svgCoords","moveTo","ternaryCoords","datum","datid","_","call","continent","darker","text","countryText","updateTitle","calculateScore","country","ghostProjectsValue","ghostScore","countryScore","group","score","paintGroups","r","groupArc","padAngle","outerRadius","insideConfig","join","enter","insert","each","newArc","exec","replace","update","pieData","maxPercentage","radiusScale","domain","range","o","lineCoord","angle","startAngle","endAngle","PI","cos","sin","strokeWidthSDG","exit","coordsSI","fixedSIValue","scaleSI","base","pos","SI_values","startX","startY","endX","endY","atan2","dist","p","tsnejs","REVISION","assert","condition","message","getopt","opt","field","defaultval","hasOwnProperty","return_v","v_val","randn","mu","std","gaussRandom","u","random","v","c","sqrt","log","zeros","n","isNaN","ArrayBuffer","arr","Array","Float64Array","randn2d","s","uses","xhere","j","push","L2","x1","x2","D","x1i","x2i","d2p","perplexity","tol","Nf","N","floor","Htarget","P","prow","betamin","Infinity","betamax","beta","done","num","psum","pj","exp","Hhere","abs","Pout","N2","max","sign","tSNE","dim","epsilon","iter","initDataRaw","X","dists","xtod","initSolution","initDataDist","Y","gains","ystep","getSolution","step","cg","costGrad","cost","grad","ymean","gid","sid","gainid","newgain","newsid","debugGrad","e","yold","cg0","cg1","analytic","numerical","console","pmul","Qu","qsum","dsum","dhere","qu","NN","Q","q","gsum","premult","tsnePlot","dataRaw","tsne","k","loadData","Promise","resolve","reject","indexOf","then","result","tsneCoords","getData","draw","_elementSelector","g","tsneCoordsToSVGCoords","tsneSolver","showStaticPlaceholders","visibility","toggle","pickPlotsForStaticLayout","plots","isMobile","staticPlots","plot","related","contains","y1","w","h","TSNE","fsm","StateMachine","init","transitions","from","to","methods","onToStatic","onToTsne","onToTernary","onFromTernary","onFromTsne","margin","axis_ticks","axis_labels","minor_axis_ticks","ternaryPlot","side","axes","corners","translateX","translateY","coord","sum","a","b","gradient","coordAnnotation","line","theta","coord1","coord2","coord3","coord4","offsetAnnotation","getCoord","ternaryGraph","VEGA_CONFIG","fontFamily","vegaTooltip","require","VegaChart","refCallback","renderVega","props","autoSize","padding","dataDefs","signals","signalListeners","runAfterCallback","onVegaViewCreated","values","dataDef","dd","map","find","top","right","bottom","autosize","view","vega","renderer","Handler","theme","initialize","runAsync","listener","addSignalListener","handler","ref","className","chartClass","PureComponent","VegaSignalListener","VegaSpecStripPlot","fisheye","scale","scaleType","d3_fisheye_scale","m","distortion","arguments","focus","copy","target","source","method","d3_rebind","apply","rebind","circular","k0","k1","dx","dy","z","rescale","countrySelectOptions","sdg_by_country_data","uniqBy","sortBy","CountryPlots","getRelatedCountries","selectedOption","related_countries_data","handleChange","newOption","newStaticPlots","showStaticPlots","setState","mockData","phase","handleOpenCountry","bind","initialBrushSignal","brushDomain","vegaView","tinyCountryPlot","_plots","layout","fixedLayoutData","setPlaceholderInfo","signal","nextProps","updateState","refs","document","querySelector","offsetWidth","dotGroups","distortionScale","distance","hypot","ordinal","legendOrdinal","d3Legend","shape","shapeRadius","shapePadding","xFisheye","yFisheye","mouse","article_step","is","toStatic","fromTsne","toTsne","fromTernary","toTernary","updateControls","destroyCartesian","destroyLegendContinents","countries","labelTextScale","countryLabel","toLowerCase","createTinyCountry","destroyTinyCountry","destroyFishEye","createCartesian","createLegendContinents","brushCountries","createFishEye","setTimeout","countriesHighlighted","container","reactRefs","countryRefs","refsData","concat","getStaticPositions","reactThis","cleanHover","boxShadow","zIndex","addEventListener","offsetX","offsetY","staticCountryIndex","getCountryHoverListener","parseFloat","clist","allSDGs","control","globalSDGValues","mySDGs","missingSDG","sdg","order","economy","society","biosphere","reducer","sdgsLabels","setAverageBySDGPillars","reset","ceil","countryInfo","handleOpenModalCountry","stripPlotBrushListener","position","slice","index","defaultValue","placeholder","onChange","options","classNamePrefix","isSearchable","onClick","circles","fill","stripPlotSVG","url","Component","areaChart","areaChartAll","sdgKeywordTrend","streamgraph","keywordsIncrements","AreaCharts","areaChartValues","excludedIndicators","clonedValues","sdgClass","t","Stickyfill","Introduction","vegaViews","loading","fundingAreaChartValues","projectsAreaChartValues","scrolly","figure","figureHeight","scroller","scrollama","handleResize","innerHeight","resize","handleStepEnter","response","showGraphs","sdgs","add","setup","offset","debug","progress","onStepEnter","allProjects","Object","entries","singular","projectsData","entry","areaChartHeight","hoverListener","that","data-step","Header","src","maxHeight","opacity","paddingRight","href","rel","sirisWhite","alt","fontSize","lineHeight","maxWidth","align","canvasId","getHeaderContent","getFooterContent","getMarginTopFromVegaSVG","svgD3Selection","svgMargins","parseInt","substring","lastIndexOf","setImmediate","msSetImmediate","webkitSetImmediate","mozSetImmediate","oSetImmediate","postMessage","evt","substr","stopImmediatePropagation","clearImmediate","callback","toString","fn","msClearImmediate","webkitClearImmediate","mozClearImmediate","oClearImmediate","timer","clearTimeout","global","isSupported","canvas","createElement","getContext","ctx","getImageData","fillText","prototype","some","minFontSize","hanWidth","mWidth","font","measureText","shuffleArray","WordCloud","elements","isArray","el","getElementById","Error","tagName","appendChild","settings","list","fontWeight","minSize","weightFactor","scaleOpacity","clearCanvas","backgroundColor","gridSize","drawOutOfBound","shrinkToFit","origin","drawMask","maskColor","maskGapWidth","wait","abortThreshold","abort","minRotation","maxRotation","rotationSteps","shuffle","rotateRatio","ellipticity","classes","hover","click","meta","marginTop","factor","pt","thetaPrime","grid","ngx","ngy","center","maxRadius","escapeTime","getTextColor","getTextFontWeight","maskRectWidth","rotationRange","random_hsl_color","hovered","interactive","infoGrid","getInfoGridFromMouseTouchEvent","clientX","clientY","currentTarget","rect","touches","eventX","eventY","wordcloudhover","item","dimension","wordcloudclick","preventDefault","pointsAtRadius","getPointsAtRadius","T","points","rx","exceedTime","Date","getTime","fillGridAt","fillRect","putWord","word","weight","attributes","rotateDeg","fcanvas","fctx","willReadFrequently","fw","fh","boxWidth","boxHeight","fgw","fgh","fillTextOffsetX","fillTextOffsetY","cgh","cgw","setAttribute","translate","rotate","fillStyle","textBaseline","imageData","gy","occupied","gx","bounds","singleGridLoop","gw","gh","fillTextWidth","fillTextHeight","getTextInfo","tryToPutWordAtPoint","gxy","px","py","canFitText","offsetLeft","offsetTop","transformRule","vLine","paper","Path","Point","topIntersect","bottomIntersect","curves","getIntersections","streamRiverSVG","year","selected","myOpacity","myFontSize","myMaxFontSize","getFactor","input","point","curve","interpolate","error","exportSVG","getAttribute","drawText","save","restore","updateGrid","sendEvent","type","cancelable","details","event","CustomEvent","detail","dispatchEvent","loopingFunction","stoppingFunction","clearRect","textContent","bctx","bgPixel","webkitTapHighlightColor","stopInteraction","removeEventListener","anotherWordCloudStart","loop","drawn","canceled","warning","start","toFixed","Canvas","path","offsetWidthFactor","wordCloudCompletionListener","foregroundColor","context","strokeStyle","Path2D","maxWeight","minWeight","maxFontSize","fontsize","fitTextOnWidth","clientWidth","scaleFontSize","Annotation","WordleGenerator","numWordCloudCompleted","textPaths","showAnnotation","hoveredText","filter","nodes","getComputedStyle","getPropertyValue","clearInterval","interval","intersections","initialIndex","finalIndex","mySegments","segment","len","leftPoints","rightPoints","topPoints","reduce","acumulator","currentValue","bottomPoints","segments","findIndex","getDistance","Segment","handleIn","handleOut","result2","removeSegments","result3","reverse","percentage","innerHTML","classList","curveText","handleOpenModalKeyword","quadTree","extent","addAll","buffer","createSVGPoint","pageCoords","clientCoords","setInterval","requestAnimationFrame","x0","y0","x3","y3","matrixTransform","getScreenCTM","inverse","visit","y2","next","istart","istop","ostart","canvasLayout","scaleX","keywords","wordClouds","canvasData","o2","pathSDG","square","Rectangle","pathSDGYear","intersect","children","vector","vector1","vector2","findUpperPath","warn","keyword","count","amountWordClouds","generateCanvasLayout","InfoSDG","StreamRiver","saveCanvasLayoutData","streamRiverData","streamRiverKeywords","years","datalib","SDGLabel","scrollLeft","postQuery","query","fetch","mode","headers","body","ok","json","err","xsd","xboolean","xint","xinteger","xlong","decimal","xfloat","xdouble","xstring","date","dateTime","DatatypeLabel","DatatypeLabelInteger","str","val","DatatypeLabelString","DatatypeLabelFloat","DatatypeLabelDate","DatatypeLabelBoolean","defaultRdfDatatypes","createTypedLiteralFromString","typeUri","dtype","parse","parseNodeValue","nodeValue","JSON","stringify","datatype","trim","bindingsToJsMap","varNames","head","vars","results","bindings","binding","varName","binding2Obj","SPARQL","Treemap","createChart","checkSizeForVega","onCompareCountry","comparisonData","countryCompared","queryKeywordsBySDGAndCountry","filterCountry","background","textureLegend","root","tile","round","leaf","leaves","ancestors","valueSecondary","valuePrimary","split","bb","getBBox","widthTransform","heightTransform","scaleFactor","comparisonCountry","comparisonMode","queryResults","bySDG","grouped","numProjs","sdgName","option","safeData","getSDGData","sdg2","keyword2","class","CORDISKeywords","sdgLabel","fontSizeScale","keywordCORDIS","KeywordData","columWidth","dynamicSpecs","sdgLabels","transform","specs","colWidth","_extends","assign","_objectWithoutProperties","excluded","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref2","_ref3","cx","cy","_ref4","_ref5","_ref6","_ref7","_ref8","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref16","_ref","svgRef","viewBox","enableBackground","xmlSpace","pointerEvents","ForwardRef","forwardRef","variableGroup","funding","ghost","projects","Home","stepStream","activeComponent","activeVariable","showModal","activeMenu","showModalKeyword","myCountryPlots","React","createRef","toggleClass","scrollToTop","handleCloseModalKeyword","handleCloseModalCountry","modalKeywordClassName","modalSDGLabels","clickedKeyword","countryData","showModalCountry","modalTitle","modalData","modalIndicators","modalHeaderData","totalProjectsCountrySDG","numProjectsInSomeSDG","totalFundingCountrySDG","classifiedFundingInSomeSDG","modalId","modalCountryVariable","modalGhostVariable","modalSortingVariable","main","scrollerStream","handleStepEnterStream","currentState","scroll","activeClass","spy","smooth","Modal","onHide","dialogClassName","animation","Body","toUpperCase","borderTop","paddingTop","SDGTreemap","keywordsIncrementsData","keywordsBreakpoint","formatHex","me","parentNode","openModal","handleOpenModal","closeModal","handleCloseModal","isOpen","data-scrollama-index","current","closeButton","Title","direction","marginBottom","withSizes","RouteApp","exact","process","component","App","Boolean","location","hostname","match","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.f918de7b.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/p_numProjectsSDG.aac3f55c.csv\";","module.exports = \"data:image/png;base64,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\"","import {createBrowserHistory} from \"history\"\nimport * as _ from 'lodash';\n\nexport const history = createBrowserHistory();\n\nexport const IS_STATIC = true;\nexport var EMPTY_OBJECT = {\n    SDG: undefined,\n    numProjectsSDG: 0,\n    p_fundingSDG: 0,\n    p_numProjectsSDG: 0,\n    SI_numProjects: 0,\n    SI_funding: 0,\n    p_totalNumCORDIS: 0,\n    p_totalFundingCORDIS: 0,\n    sorting: undefined,\n    totalFundingCountry: 0,\n    totalProjectsCountry: 0,\n    shortTitle: ''\n};\n\n/**\n * Given and object with this structure:\n *  Finland: Array(16)\n        {SDG: \"SDG 8\", numProjectsSDG: 297, totalProjectsCountry: 3313, p_numProjectsSDG: 0.08964684575913069, fundingSDG: 146950231.12, …}\n        {SDG: \"SDG 9\", numProjectsSDG: 798, totalProjectsCountry: 3313, p_numProjectsSDG: 0.24086930274675522, fundingSDG: 415058013.64000005, …}\n        {SDG: \"SDG 10\", numProjectsSDG: 100, totalProjectsCountry: 3313, p_numProjectsSDG: 0.03018412315122246, fundingSDG: 37271034.12, …}\n        {SDG: \"SDG 12\", numProjectsSDG: 242, totalProjectsCountry: 3313, p_numProjectsSDG: 0.07304557802595835, fundingSDG: 140090716.81999996, …}\n        {SDG: \"SDG 1\", numProjectsSDG: 36, totalProjectsCountry: 3313, p_numProjectsSDG: 0.010866284334440085, fundingSDG: 14957015.209999999, …}\n        ...,\n    France: Array(16)\n        {SDG: \"SDG 8\", numProjectsSDG: 797, totalProjectsCountry: 12840, p_numProjectsSDG: 0.062071651090342676, fundingSDG: 509370337.61000013, …}\n        {SDG: \"SDG 9\", numProjectsSDG: 2401, totalProjectsCountry: 12840, p_numProjectsSDG: 0.186993769470405, fundingSDG: 2105978119.34, …}\n\n    Adds in every array properties with the sum of percentage based on prefefined groups of SDGs\n    (economy, society, biosphere)\n * @param {Object} data \n */\nexport function setAverageBySDGPillars(data) {\n    const economy = ['SDG 8', 'SDG 9', 'SDG 10', 'SDG 12'],\n          society = ['SDG 1', 'SDG 2', 'SDG 3', 'SDG 4', 'SDG 5', 'SDG 7', 'SDG 11', 'SDG 16'],\n          biosphere = ['SDG 6','SDG 13', 'SDG 14', 'SDG 1'];\n\n    // function to sum the % for sdg belonging to the group\n    const reducer = function(sdgsLabels, country) {\n        return _.reduce(\n            sdgsLabels,\n            (result, value) => {\n                return result + \n                    _.find(\n                        data[country], \n                        sdg => sdg.SDG === value\n                    ).p_numProjectsSDG\n            },\n            0\n        );\n    };\n\n    _.keys(data).forEach(country => {        \n        data[country].economy   = reducer(economy, country);\n        data[country].society   = reducer(society, country);\n        data[country].biosphere = reducer(biosphere, country);\n    });\n};\n\n\n\nexport const SDG_INFO = {\n    'SDG 1': { \n        'color': \"#E5243B\", \n        'shortTitle': 'No poverty',\n        'title': 'End poverty in all its forms everywhere', \n        'order': 5, \n        'group': 'society' \n    },\n    'SDG 2': { \n        'color': \"#DDA63A\",\n        'shortTitle': 'No hunger', \n        'title': 'End hunger, achieve food security and improved nutrition and promote sustainable agriculture', \n        'order': 6, \n        'group': 'society' \n    },\n    'SDG 3': { \n        'color': \"#4C9F38\", \n        'shortTitle': 'Good Health and Well-being',\n        'title': 'Ensure healthy lives and promote well-being for all at all ages', \n        'order': 7, \n        'group': 'society' \n    },\n    'SDG 4': { \n        'color': \"#C5192D\", \n        'shortTitle': 'Quality Education',\n        'title': 'Ensure inclusive and equitable quality education and promote lifelong learning opportunities for all', \n        'order': 8, \n        'group': 'society' \n    },\n    'SDG 5': { \n        'color': \"#FF3A21\", \n        'shortTitle': 'Gender Equality',\n        'title': 'Achieve gender equality and empower all women and girls', \n        'order': 9, \n        'group': 'society' \n    },\n    'SDG 6': { \n        'color': \"#26BDE2\", \n        'shortTitle': 'Clean Water and Sanitation',\n        'title': 'Ensure availability and sustainable management of water and sanitation for all', \n        'order': 13, \n        'group': 'biosphere' \n    },\n    'SDG 7': { \n        'color': \"#FCC30B\", \n        'shortTitle': 'Affordable and Clean Energy',\n        'title': 'Ensure access to affordable, reliable, sustainable and modern energy for all', \n        'order': 10, \n        'group': 'society' \n    },\n    'SDG 8': { \n        'color': \"#A21942\", \n        'shortTitle': 'Decent Work and Economic Growth',\n        'title': 'Promote sustained, inclusive and sustainable economic growth, full and productive employment and decent work for all', \n        'order': 1, \n        'group': 'economy' \n    },\n    'SDG 9': { \n        'color': \"#FD6925\", \n        'shortTitle': 'Industry, Innovation and Infrastructure',\n        'title': 'Build resilient infrastructure, promote inclusive and sustainable industrialization and foster innovation', \n        'order': 2, \n        'group': 'economy' \n    },\n    'SDG 10': { \n        'color': \"#DD1367\", \n        'shortTitle': 'Reduced Inequality',\n        'title': 'Reduce inequality within and among countries', \n        'order': 3, \n        'group': 'economy' \n    },\n    'SDG 11': { \n        'color': \"#FD9D24\", \n        'shortTitle': 'Sustainable Cities and Communities',\n        'title': 'Make cities and human settlements inclusive, safe, resilient and sustainable', \n        'order': 11, \n        'group': 'society' \n    },\n    'SDG 12': {\n        'color': \"#BF8B2E\", \n        'shortTitle': 'Responsible Consumption and Production',\n        'title': 'Ensure sustainable consumption and production patterns', \n        'order': 4, \n        'group': 'economy' \n    },\n    'SDG 13': { \n        'color': \"#3F7E44\", \n        'shortTitle': 'Climate Action',\n        'title': 'Take urgent action to combat climate change and its impacts*', \n        'order': 14, \n        'group': 'biosphere' \n    },\n    'SDG 14': { \n        'color': \"#0A97D9\", \n        'shortTitle': 'Life Below Water',\n        'title': 'Conserve and sustainably use the oceans, seas and marine resources for sustainable development', \n        'order': 15, \n        'group': 'biosphere' \n    },\n    'SDG 15': { \n        'color': \"#56C02B\", \n        'shortTitle': 'Life on Land',\n        'title': 'Protect, restore and promote sustainable use of terrestrial ecosystems, sustainably manage forests, combat desertification, and halt and reverse land degradation and halt biodiversity loss', \n        'order': 16, \n        'group': 'biosphere' \n    },\n    'SDG 16': { \n        'color': \"#00689D\", \n        'shortTitle': 'Peace and Justice Strong Institutions',\n        'title': 'Promote peaceful and inclusive societies for sustainable development, provide access to justice for all and build effective, accountable and inclusive institutions at all levels', \n        'order': 12, \n        'group': 'society' \n    }\n}\n\nexport const SDG_ARR = [\"SDG 1\", \"SDG 2\", \"SDG 3\", \"SDG 4\", \"SDG 5\", \"SDG 6\", \"SDG 7\", \"SDG 8\", \"SDG 9\", \"SDG 10\", \"SDG 11\", \"SDG 12\", \"SDG 13\", \"SDG 14\", \"SDG 15\", \"SDG 16\"];\nexport const SDG_COLOR_ARR = [\"#E5243B\", \"#DDA63A\", \"#4C9F38\", \"#C5192D\", \"#FF3A21\", \"#26BDE2\", \"#FCC30B\", \"#A21942\", \"#FD6925\", \"#DD1367\", \"#FD9D24\", \"#BF8B2E\", \"#3F7E44\", \"#0A97D9\", \"#56C02B\", \"#00689D\"];\n\nexport const SDG_GROUPING = [\n    {name: 'ECONOMY', includes: ['SDG 8', 'SDG 9', 'SDG 10', 'SDG 12'], color: '#CCC'},\n    {name: 'SOCIETY', includes: ['SDG 1', 'SDG 2', 'SDG 3', 'SDG 4', 'SDG 5', 'SDG 7', 'SDG 11', 'SDG 16'], color: '#AAA'},\n    {name: 'BIOSPHERE', includes: ['SDG 6', 'SDG 13', 'SDG 14', 'SDG 15'], color: '#777'}\n]\n\nexport const SELECTED_COUNTRIES = [\n    {countryName: 'Germany'},\n    {countryName: 'France'},\n    {countryName: 'Italy'},\n    {countryName: 'Spain'},\n    {countryName: 'Barbados'}\n]\nexport const REFS = {\n    PRIMARY_COUNTRY     : 'primary-country',\n    SECONDARY_COUNTRY_0 : 'secondary-country-0',\n    SECONDARY_COUNTRY_1 : 'secondary-country-1',\n    SECONDARY_COUNTRY_2 : 'secondary-country-2',\n    SECONDARY_COUNTRY_3 : 'secondary-country-3',\n    SECONDARY_HEADER    : 'secondary-header'\n};\n\nexport const SPARQL_ENDPOINT = 'http://ec2-52-51-177-228.eu-west-1.compute.amazonaws.com/unics/sparql/query'\n\nexport const queries = {\n    sdgKeys: `PREFIX : <http://unics.cloud/ontology#>\n    SELECT\n    ?sdgName ?keyword (COUNT(DISTINCT ?projId) AS ?numProjs)\n    WHERE {\n    ?proj a :EC-Project .\n    ?proj :unicsId ?projId .\n    \n    ?proj :sdgReified ?sdgr .\n    ?sdgr :sdg ?sdg .\n    ?sdg :shortName ?sdgName .\n    ?sdgr :keyword ?kw .\n    ?kw :textualValue ?keyword .\n    \n    ?proj :ecParticipant ?part .\n    ?part :country ?cou .\n    ?cou :extendedName ?country .\n    FILTER (?country = \"Spain\")\n    }\n    GROUP BY ?sdgName ?keyword\n    ORDER BY ?sdgName DESC(?numProjs)`\n}\n\nexport const CONTINENT_COLORS = {\n    'Africa': '#01963e',\n    'Asia': '#ffcc00',\n    'Europe': '#026bb6',\n    'North America': '#e42e13',\n    'Oceania': '#8f644a', //'#f07d00',\n    'South America': '#b82f7e'\n};","import * as d3 from 'd3';\n\nconst myTooltip = function(){\n\n    function show (title, subtitle, datablocks, vizspecs, footer) {\n\n      //positionate tooltip\n      var tooltip = d3.select('#node-tooltip')\n        .style('display', 'block')\n        .style('left', (d3.event? d3.event.pageX:0) + 'px');\n        //.style('top', (d3.event.pageY - 50) + 'px');\n      \n      // assume that with no data we are just\n      //tooltiping static text so make the tooltip smaller\n      let noData = (datablocks === undefined || datablocks.length === 0);\n      //tooltip.style('max-width',  noData? '125px':null)\n      tooltip.style('max-height', noData? '135px':null)\n      tooltip.style('overflow',   noData? 'hidden':null)\n\n      //remove previous content\n      tooltip.select('.node-tooltip-data-container').selectAll('.node-tooltip-data-block').remove();\n      tooltip.select('.node-tooltip-data-container').selectAll('.node-tooltip-data-separator').remove();\n      tooltip.select('.node-tooltip-viz-container').selectAll('*').remove();\n      tooltip.select('.node-tooltip-data-footer').html('');\n\n      //update title\n      tooltip.select('.node-tooltip-title').html(title);\n\n      //update subtitle\n      tooltip.select('.node-tooltip-subtitle').html(subtitle);\n\n      datablocks.forEach(function(datablock) {\n        //add data\n        var datablockDiv = tooltip.select('.node-tooltip-data-container').append('div').attr('class','node-tooltip-data-block')\n        datablockDiv.append('div').attr('class', 'node-tooltip-data-name').html(datablock.key);\n        datablockDiv.append('div').attr('class', 'node-tooltip-data-value').html(datablock.value);\n        tooltip.select('.node-tooltip-data-container').append('div').attr('class','node-tooltip-data-separator')\n      });\n\n      // delete last separator\n      tooltip.select('.node-tooltip-data-separator:last-of-type').remove();\n\n      // add footer\n      if(footer && footer !== ''){\n        tooltip.select('.node-tooltip-footer').html(footer);\n      } else {\n        tooltip.select('.node-tooltip-footer').html('');\n      }\n        \n/*\n      //embed viz if any\n      if(vizspecs)\n        vg.embed('.node-tooltip-viz-container', vizspecs, function(error, result) {});\n*/\n      // and move up the content according to its size\n      // so it does not overlapd with the mouse. Take\n      // into account the presence of the viz: don't\n      // wait until the viz is rendered to get the height\n      // but get it from the viz specs\n      var offsetHeight = tooltip.node().offsetHeight\n        + ((vizspecs)? vizspecs.spec.height+60 : 20);\n      tooltip.style('top', ((d3.event? d3.event.pageY:0) - offsetHeight) + 'px');\n\n      // if tooltip is placed out of the boundaries of the screen,\n      // automatically placed it inside\n      var tooltipWidth = tooltip.node().getBoundingClientRect().width,\n          tooltipX = tooltip.node().getBoundingClientRect().left,\n          windowWidth = window.innerWidth;\n      if ((tooltipX + tooltipWidth) > windowWidth){\n        tooltip.style('left', (tooltipX - tooltipWidth - 5) + 'px');\n      }\n    }\n\n    function hide() {\n      d3.select('#node-tooltip').style('display', 'none');\n    };\n\n    function move(coords) {\n      d3.select('#node-tooltip')\n        .style('display', 'block')\n        .style('left', coords[0] + 'px')\n        .style('top', coords[1] + 'px');\n    }\n    \n\n    return {\n        show: show,\n        hide: hide,\n        move: move\n    };\n}\nconst Tooltip = myTooltip();\nexport default Tooltip;","import * as d3 from 'd3';\nimport * as _ from 'lodash';\nimport { \n    SDG_INFO, \n    SDG_GROUPING,\n    CONTINENT_COLORS } from '../common'\nimport Tooltip from './tooltip';\nimport textures from 'textures';\n\n\n\nexport default class CountryPlotGenerator {\n\n\n    constructor(elementSelector, label, id, placeholderInfo, data, countryVariable, ghostVariable, sortingVariable, callbacks) {\n\n        // set of states for the plot\n        this.HIDDEN = 'none';\n        this.VISIBLE = 'inline';\n        this.FOLDED = 2;\n        this.UNFOLDED = 3;\n        this.dotRadius = data.dotRadius || 1;\n        this.dotLabelSize = data.dotLabelSize || 8;\n\n        this.elementSelector = elementSelector;\n        this.placeholderInfo = placeholderInfo || { width: 300, height: 300, x: 0, y: 0, isFake:true };\n        this.label = label;\n        this.id = id;\n        this.radius = this.setRadius();\n        this.data = data;\n        this.countryVariable = countryVariable;\n        this.ghostVariable = ghostVariable;\n        this.sortingVariable = sortingVariable;\n        this.callbacks = callbacks;\n\n        this.config = {\n            svg: d3.select(this.elementSelector),\n            width: this.placeholderInfo.width,\n            height: this.placeholderInfo.height,\n            radius: this.radius,\n            innerRadius: this.setInnerRadius(),\n            pie: d3.pie()\n                .sort(null)\n                .value(function (d) { return d.width; }),\n            texture: textures.lines().size(4).strokeWidth(1).stroke('#000')\n        };\n\n        // set initial state as hidden\n        // and create all the elements\n        this.display = this.HIDDEN;\n        this.createPlaceholder();\n        this.drawMultidimensionalPlot();\n        this.drawDotPlot();\n    }\n\n    /** helpers  */\n    updateTitle(selection, self) {\n        selection.classed('primary', self.placeholderInfo.isPrimary)\n            .attr(\n                \"transform\", \n                \"translate(0,\" + (self.placeholderInfo.isPrimary? -self.config.height * 0.47:-self.config.height * 0.37) + \")\"\n            )\n    };\n\n    updateValue(selection, self) {\n        selection.classed('primary', self.placeholderInfo.isPrimary)\n    };\n\n    setRadius() { \n        // radius is half the minimum width or height, multiplied\n        // by a factor to reduce it a bit, in order to allocate\n        // the texts related to the SDG groups \n        return Math.min(this.placeholderInfo.width/2, this.placeholderInfo.height/2) * 0.65;\n    };\n    setInnerRadius() { return this.radius * 0.35 };\n\n\n\n\n    /************************************************************\n     * Methods to change state of the plot\n     */\n\n\n\n    /**\n     * Object with properties width, height, center x, center y of\n     * a target placeholder (this results in centering and sizing the\n     * plot according the placeholder).\n     * @param {Object} placeholderInfo \n     */\n    setPlaceholderInfo(placeholderInfo) {\n        this.placeholderInfo = placeholderInfo;\n        this.radius = this.setRadius();\n        this.config.width = this.placeholderInfo.width;\n        this.config.height = this.placeholderInfo.height;\n        this.config.radius = this.radius;\n        this.config.innerRadius = this.setInnerRadius();\n        \n        // redraw the plot with the new sizing\n        this.updateMultidimensionalPlot(this.data, this.label, 'full');\n        this.placeholderInfo.isPrimary && this.calculateGroupsScore(SDG_GROUPING)\n    }\n\n\n\n    /**\n     * Change the visibility of the plot \n     */\n    show(value = true) {\n\n        if (!this.placeholderInfo.isPrimary) {\n            this.config.svgGroup.selectAll(\".groupArc\").attr(\"opacity\", 0);\n            this.config.svgGroup.selectAll(\".donutText\").attr(\"opacity\", 0);\n        }\n\n        this.state = value ? this.VISIBLE : this.HIDDEN;\n        this.config.gPlaceholder.attr('display', this.state);\n    };\n\n\n\n    /**\n     * Changes the opacity of the main dot group placeholder.\n     * Selection is done when brushing, so only should affect\n     * to the dot group\n     */\n    select(value = true) {\n        this.config.dotGroup.attr('opacity', value ? 1 : 0.25);\n        this.config.dotGroup.classed('brushed', value);\n        this.config.dotGroup.select('circle').classed('brushed', value);\n        this.config.dotGroup.select('text').classed('brushed', value);\n    }\n\n    reset() {\n        this.config.dotGroup.attr('opacity', 1);\n        this.config.dotGroup.classed('brushed', false);\n        this.config.dotGroup.select('circle').classed('brushed', false);\n        this.config.dotGroup.select('text').classed('brushed', false);\n    }\n\n\n    /**\n     * Moves the main <g> element to indicate position\n     * @param {int} x \n     * @param {int} y \n     */\n    moveTo(x, y) {\n        this.config.gPlaceholder\n            .attr('x', x)\n            .attr('y', y);\n        return this;\n    }\n\n\n    fromTsne(isStatic = false, info) {\n        this.config.gPlaceholder.selectAll('*').interrupt();\n\n        if (isStatic) {\n\n            this.config.dotGroup.select('text').attr('opacity', 0);\n            this.config.gPlaceholder\n                .transition('fromTsne')\n                .duration(1000)\n                .ease(d3.easeQuadIn)\n                .attr('x', info.x)\n                .attr('y', info.y)\n                .on('end', () => {\n                    this.fold(false);\n                    this.updateMultidimensionalPlot(this.data, this.label, 'full')\n                });\n\n            this.config.dotGroup.select('circle')\n                .attr('r', this.dotRadius)\n                .transition('fromTsne')\n                .delay(1000)\n                .duration(200)\n                .attr('r', 0);\n        }\n        else {\n            this.config.dotGroup.select('text').attr('opacity', 0);\n            this.config.dotGroup.select('circle')\n                .attr('r', this.dotRadius)\n                .transition('fromTsne')\n                .duration(200)\n                .attr('r', 0)\n        }\n    }\n\n    /**\n     * Transition to tsne state\n     */\n    toTsne(isStatic = false, i) {\n        // interrupt ongoing transitions\n        this.config.gPlaceholder.selectAll('*').interrupt();\n\n        if (isStatic) {            \n            this.updateMultidimensionalPlot(this.data, this.label, 'fold')\n\n            this.show();\n            this.config.dotGroup\n                .select('circle')\n                .attr('r', 0)\n                .transition('toTsne')\n                .ease(d3.easeQuadOut)\n                .attr('r', this.dotRadius)\n                .delay(600 + (i * 20))\n                .duration(200);\n\n            this.config.gPlaceholder\n                .transition('toTsne')\n                .ease(d3.easeQuadOut)\n                .delay(1200)\n                .duration(400)\n                .attr('x', this.data.svgCoords[0])\n                .attr('y', this.data.svgCoords[1])\n                .on('end', () => this.config.dotGroup.select('text').attr('opacity', 1));\n        }\n        else {\n            this.fold(true)\n            this.moveTo(this.data.svgCoords[0], this.data.svgCoords[1]);\n            this.show();\n            this.config.dotGroup.select('text').attr('opacity', 0);\n            this.config.dotGroup\n                .select('circle')\n                .attr('r', 0)\n                .transition('toTsne')\n                .ease(d3.easeQuadOut)\n                .attr('r', this.dotRadius)\n                .delay(1400 + (i * 5))\n                .duration(100)\n                .on('end', () => this.config.dotGroup.select('text').attr('opacity', 1));\n        }\n        this.config.dotGroup\n            .select('circle')\n            .on('click', () => {\n                //this.callbacks[2]({ label: this.label, data: this.data });\n                this.callbacks[2]({\n                    label: this.label, \n                    id: this.id, \n                    data: this.data, \n                    countryVariable: this.countryVariable, \n                    ghostVariable: this.ghostVariable, \n                    sortingVariable: this.sortingVariable\n                });\n            })\n            .on('mouseover', () => {\n                this.config.dotGroup.attr('opacity', 1).select('text').attr('opacity', 1);\n                this.callbacks[0](this.label, this.id, this.data, this.countryVariable, this.ghostVariable, this.sortingVariable);\n            })\n            .on('mouseout', () => {\n                this.config.dotGroup.classed('brushed') ? this.config.dotGroup.attr('opacity', 1) : this.config.dotGroup.attr('opacity', 0.25).select('text').attr('opacity', 1)\n                this.callbacks[1]();\n            });\n    };\n\n\n\n    /**\n     * \n     */\n    toTernary(i) {\n        this.config.gPlaceholder\n            .transition('toTernary')\n            .ease(d3.easeQuadOut)\n            .delay(i * 5)\n            .duration(200)\n            .attr('x', this.data.ternaryCoords[0])\n            .attr('y', this.data.ternaryCoords[1]);\n\n        this.config.dotGroup\n            .on('mouseover', () => this.config.dotGroup.select('text').attr('opacity', 1))\n            .on('mouseout', () => this.config.dotGroup.select('text').attr('opacity', 0))\n            .transition('toTernary')\n            .ease(d3.easeQuadOut)\n            .delay(i * 5)\n            .duration(200)\n            .on('end', () => this.config.dotGroup.select('text').attr('opacity', 0))\n\n\n    }\n\n\n    /**\n     * \n     */\n    fromTernary(i) {\n        this.config.gPlaceholder\n            .transition('fromTernary')\n            .ease(d3.easeQuadOut)\n            .delay(i * 5)\n            .duration(200)\n            .attr('x', this.data.svgCoords[0])\n            .attr('y', this.data.svgCoords[1]);\n\n        this.config.dotGroup\n            .on('mouseover', () => this.config.dotGroup.attr('opacity', 1).select('text').attr('opacity', 1))\n            .on('mouseout', () => {\n                this.config.dotGroup.classed('brushed') ? this.config.dotGroup.attr('opacity', 1) : this.config.dotGroup.attr('opacity', 0.25).select('text').attr('opacity', 1)\n            })\n            .transition('fromTernary')\n            .ease(d3.easeQuadOut)\n            .delay(i * 5)\n            .duration(200)\n            .on('end', () => this.config.dotGroup.select('text').attr('opacity', 1));\n    }\n\n\n    /**\n     * Decides whether to show the fold/unfold state\n     * @param {*} state \n     */\n    fold(state = true) {\n        this.config.svgGroup.attr('display', state ? this.HIDDEN : this.VISIBLE);\n        this.config.dotGroup.attr('display', state ? this.VISIBLE : this.HIDDEN);\n    }\n\n    /************************************************************\n     * Methods to create stuff of the plot\n     */\n\n    /**\n     * Creates the <g> element that will contain\n     * all the visual stuff, all the <g>'s for\n     * each state\n     */\n    createPlaceholder() {\n        this.config.gPlaceholder = this.config.svg\n            .append('svg')\n            // this overflow visile is a life-saver...\n            .style('overflow', 'visible')\n            //.datum(this.label)            \n            .attr('id', this.id)\n            .attr('class', 'country-placeholder')\n            .attr('display', this.display)\n            .attr('x', this.placeholderInfo.x)\n            .attr('y', this.placeholderInfo.y)\n            .datum({\n                datid: _.random(1, true),\n                svgCoords: { x: this.data.svgCoords[0], y: this.data.svgCoords[1] },\n                ternaryCoords: { x: this.data.ternaryCoords[0], y: this.data.ternaryCoords[1] }\n            })\n            .call(this.config.texture);\n\n    };\n\n\n\n    /**\n     * Draw all the elements for the dot state (when the \n     * plot is just a point and the label)\n     */\n    drawDotPlot() {\n\n        this.config.dotGroup = this.config.gPlaceholder\n            .append('g')\n            .attr('class', 'dotGroup');\n        this.config.dotGroup.append('circle')\n            .attr('cx', 0)\n            .attr('cy', 0)\n            .attr('r', this.dotRadius)\n            .attr('fill', CONTINENT_COLORS[\n                    _.find(this.data, d => !_.isUndefined(d.continent)).continent\n                ]\n            )\n            .attr('fill', CONTINENT_COLORS[\n                _.find(this.data, d => !_.isUndefined(d.continent)).continent\n            ])\n            .attr('stroke', CONTINENT_COLORS[\n                _.find(this.data, d => !_.isUndefined(d.continent)).continent\n            ]);\n\n        this.config.dotGroup.append(\"text\")\n            .attr('pointer-events', 'none')\n            .attr(\"text-anchor\", \"top\")\n            .attr(\"transform\", \"translate(5, -5)\")\n            .attr(\"font-size\", this.dotLabelSize)\n            .attr(\"fill\", d3.color(CONTINENT_COLORS[\n                _.find(this.data, d => !_.isUndefined(d.continent)).continent\n            ]).darker())\n            .text(this.label);\n    };\n\n\n    /**\n     * Draws all the elements for the multidimensional plot\n     */\n    drawMultidimensionalPlot() {\n        this.config.svgGroup = this.config.gPlaceholder\n            .append('g')\n            .attr('class', 'svgGroup')\n\n        this.config.countryText = this.config.svgGroup.append('text')\n            .attr(\"text-anchor\", \"middle\")\n            .attr('class', 'country-plot-title')\n            .call(this.updateTitle, this);\n        this.calculateScore(this.data, this.label);\n    }\n\n\n\n    /**\n     * \n     * @param {*} data \n     * @param {*} country \n     * @param {*} fold \n     */\n    calculateScore(data, country, fold = 'full') {\n\n        data.forEach(SDG => {\n            if (!SDG.ghostProjectsValue) {\n                SDG.ghostScore = SDG[this.ghostVariable];\n            } else {\n                SDG.ghostScore = SDG.ghostProjectsValue[this.ghostVariable];\n            }\n            SDG.color = SDG_INFO[SDG.SDG]['color'];\n            SDG.countryScore = SDG[this.countryVariable];\n            SDG.width = 1;\n            SDG.label = SDG_INFO[SDG.SDG]['title'];\n        });\n\n        this.updateMultidimensionalPlot(data, country, fold)\n    }\n\n\n\n    /**\n     * \n     * @param {*} data \n     * @param {*} fold \n     */\n    calculateGroupsScore(data, fold = 'full') {\n        data.forEach(function (group) {\n            group.score = .7;\n            group.width = group.includes.length;\n            group.label = group.name;\n        });\n\n        this.paintGroups(data, fold);\n    }\n\n\n\n    /**\n     * \n     * @param {*} data \n     * @param {*} fold \n     */\n    paintGroups(data, fold) {\n        // expand a bit the outer radius\n        // to allocate the arcs of the \n        // SDG groups\n        var r = this.radius * 1.15;\n        const groupArc = d3.arc()\n            .padAngle(0.02)\n            .innerRadius(r)\n            .outerRadius(r + 1);\n\n        // Groups flower\n\n        const insideConfig = this.config\n\n        this.config.svgGroup.selectAll(\".groupArc\")\n            .data(this.config.pie(data))\n            .join(\n                enter => enter.insert(\"path\")\n                    .attr(\"id\", function (d, i) {\n                        return d.data.name + '-' + i\n                    })\n                    .attr(\"class\", \"groupArc\")\n                    .attr(\"fill\", function (d) {\n                        return d.data.color\n                    })\n                    .attr(\"d\", groupArc)\n                    .each(function (d, i) {\n                        //(denoted by ^) and the first capital letter L\n                        var firstArcSection = /(^.+?)L/;\n\n                        //The [1] gives back the expression between the () (thus not the L as well)\n                        //which is exactly the arc statement\n                        var newArc = firstArcSection.exec(d3.select(this).attr(\"d\"))[1];\n                        //Replace all the comma's so that IE can handle it -_-\n                        //The g after the / is a modifier that \"find all matches rather than\n                        //stopping after the first match\"\n                        newArc = newArc.replace(/,/g, \" \");\n\n                        //Create a new invisible arc that the text can flow along\n                        insideConfig.svgGroup.append(\"path\")\n                            .attr(\"class\", \"hiddenDonutArcs\")\n                            .attr(\"id\", \"donutArc\" + i)\n                            .attr(\"d\", newArc)\n                            .style(\"fill\", \"none\");\n                    }),\n                update => update.transition().duration(300).attr(\"opacity\", fold === 'full' ? 1 : 0)\n            )\n\n        this.config.svgGroup.selectAll(\".groupText\")\n            .data(this.config.pie(data))\n            .join(\n                enter => enter.append(\"text\")\n                    .attr(\"class\", \"donutText\")\n                    //Move the labels below the arcs for slices with an end angle > than 90 degrees\n                    // .attr(\"dy\", function(d,i) {\n                    //     return (d.endAngle > 90 * Math.PI/180 ? 18 : -11);\n                    // })\n                    .attr(\"dy\", -13)\n                    .append(\"textPath\")\n                    .attr(\"startOffset\", \"50%\")\n                    // .attr(\"dx\", 20)\n                    .style(\"text-anchor\", \"middle\")\n                    .attr(\"fill\", function (d) {\n                        return d.data.color\n                    })\n                    .attr(\"opacity\", .5)\n                    .attr(\"xlink:href\", function (d, i) {\n                        // return \"#\" + d.data.name + \"-\" + i;\n                        return \"#donutArc\" + i;\n                    })\n                    .text(function (d) { return d.data.name; }),\n                update => update.transition().duration(300).attr(\"fill\", function (d) { return fold === 'full' ? d.data.color : 'transparent' })\n            )\n    }\n\n    updateMultidimensionalPlot(data, country, fold) {\n        if(this.placeholderInfo.isFake)\n            return;\n\n        // the length of the 'petal' is based on the percentage of each SDG.\n        // to avoid having short petals because of low percentages, we look\n        // for the max percentage from all the SDGs. This percentage will\n        // be the outerRadius for our country\n        let pieData = this.config.pie(data),\n            maxPercentage = _.max(_.map(pieData, 'data.countryScore')),\n            // define an scale to accomodate all the SDG percentages through\n            // the inner and outer radius. ScaleSqrt in order to make the\n            // small petals (lower percentages) bigger than with a linear scale\n            radiusScale = d3.scaleSqrt()\n                            .domain([0, maxPercentage])\n                            .range([this.config.innerRadius, this.config.radius]);\n\n        // sort data by countryScore, so SDG with\n        // less score (they will be smaller) are\n        // painted at the end (so they are not\n        // overlapped by bigger SDGs)\n        pieData = _.reverse(_.sortBy(pieData, o => o.data.countryScore));\n        // ... but those with countryScore 0, we\n        // want them to be at the bottom! so:\n        pieData = _.concat(\n            _.reject(pieData, o => o.data.countryScore !== 0), \n            _.filter(pieData, o => o.data.countryScore !== 0)\n        );\n\n        // func to calculate coords for lines\n        let lineCoord = (d) => {\n            var r = d.data.countryScore === 0? \n                this.config.radius / 2 : \n                radiusScale(d.data.countryScore);\n            \n            let angle = (d.startAngle + d.endAngle) / 2 - Math.PI / 2;\n            return [Math.cos(angle) * r, Math.sin(angle) * r];\n        }\n        // define a stroke width for the SDG's proportional\n        // to the space available\n        const strokeWidthSDG = this.config.radius * 0.12;\n        this.config.svgGroup.selectAll('.line-sdg-' + _.replace(country, ' ', ''))\n            .data(pieData)\n            .join(                                        \n                // lines with a very wide stroke, like:\n                // https://truth-and-beauty.net/projects/oecd-regional-wellbeing\n                enter => enter.insert('line')\n                    .attr('class', 'line-sdg-' + _.replace(country, ' ', ''))\n                    .attr('stroke-linecap', 'round')\n                    .attr('x1', d => {\n                        return Math.cos(\n                            (d.startAngle + d.endAngle) / 2 - Math.PI / 2\n                        ) * radiusScale(0);\n                    })\n                    .attr('y1', d => {\n                        return Math.sin(\n                            (d.startAngle + d.endAngle) / 2 - Math.PI / 2\n                        ) * radiusScale(0);\n                    })\n                    .attr('x2', d => _.first(lineCoord(d)))\n                    .attr('y2', d => _.last(lineCoord(d)))\n                    .attr('stroke-width', strokeWidthSDG)\n                    .attr(\"fill\",   d => d.data.countryScore === 0? '#f4f4f4' : d.data.color)\n                    .attr(\"stroke\", d => d.data.countryScore === 0? '#f4f4f4' : d.data.color)\n                    .on('mouseover', (d) => {\n                        Tooltip.show(\n                            d.data.shortTitle, \n                            d.data.SDG + (d.data.countryScore === 0? ' (without classified projects)':''), \n                            d.data.countryScore === 0 ? []:\n                            [   { key: \"% of projects classified\", value: d3.format('.0%')(d.data.p_numProjectsSDG) },\n                                { key: \"Total project of the country\", value: d.data.totalProjectsCountry },\n                                { key: 'Specialization Index', value: d3.format(\".1f\")(d.data.SI_numProjects) }\n                            ]);\n                    })\n                    .on('mouseout', Tooltip.hide),\n                update => update\n                    .transition()\n                    .delay((d, i) => i*50)\n                    .duration(300)\n                    .attr('x1', d => {\n                        return fold === 'full'? Math.cos(\n                            (d.startAngle + d.endAngle) / 2 - Math.PI / 2\n                        ) * radiusScale(0) : 0;\n                    })\n                    .attr('y1', d => {\n                        return fold === 'full'? Math.sin(\n                            (d.startAngle + d.endAngle) / 2 - Math.PI / 2\n                        ) * radiusScale(0) : 0;\n                    })\n                    .attr('x2', d => fold === 'full'? _.first(lineCoord(d)) : 0)\n                    .attr('y2', d => fold === 'full'? _.last(lineCoord(d)) : 0)\n                    .attr('stroke-width', strokeWidthSDG)\n                    .on('end', (d, i) => {\n                        // ugly hack to wait for\n                        // all the transition ends (16 SDGs)\n                        if(i === 15) {\n                            if (fold !== 'full') this.fold();\n                        }\n                    }),\n                // exit\n                exit => exit.remove()\n            );\n\n        // draw the lines for the Specialization Index\n\n        // util function to get the [x2, y2]\n        // of the line indicating the SI\n        let coordsSI = (d, fixedSIValue) => {\n            var r = radiusScale(d.data.countryScore);\n            r = (r <= this.config.innerRadius) ? this.config.innerRadius : r;\n\n            const scaleSI = d3.scaleLog()\n                .base(2)\n                .domain([0.125, 8])\n                .range([this.config.innerRadius, r]);\n            \n            // clamp SI values when they are greater than the\n            // domain of the S.I., so we don't get lines out\n            // of the outer radius\n            let pos = scaleSI(\n                    _.clamp(\n                        fixedSIValue || d.data.SI_numProjects, \n                        _.first(scaleSI.domain()), \n                        _.last(scaleSI.domain())\n                    )\n                ),\n                angle = (d.startAngle + d.endAngle) / 2 - Math.PI / 2;\n\n            return [ Math.cos(angle) * pos, Math.sin(angle) * pos];\n        };\n  \n        // to represent the SI for an SDG, we \n        // will use an log scale with base 2.\n        // our SI scale will have this values:\n        // [ 0.125 (8 times less specialized),\n        //   0.250 (4 times less specialized),\n        //   0,5 (2 times less specialized),\n        //   1 (equal specialization than average) ,\n        //   2 (2x times more specialized),\n        //   4 (4x times more specialized),\n        //   8 (8x times more specialized)                      \n        // ]\n        const SI_values = [8, 4, 2, 1, .5, .25, .125];\n            \n        this.config.svgGroup.selectAll('.line_si_' + country).remove();\n        (fold === 'full') && this.config.svgGroup\n            .selectAll('.line_si_' + country)\n            .data(pieData)\n            .join(\n                enter => enter.insert(\"line\")\n                    .attr('x1', d => {\n                        return Math.cos(\n                            (d.startAngle + d.endAngle) / 2 - Math.PI / 2\n                        ) * radiusScale(0);\n                    })\n                    .attr('y1', d => {\n                        return Math.sin(\n                            (d.startAngle + d.endAngle) / 2 - Math.PI / 2\n                        ) * radiusScale(0);\n                    })                    \n                    .style('pointer-events', 'none')\n                    .attr('class', 'line_si_' + country)\n                    .attr(\"stroke-width\", strokeWidthSDG / 4)\n                    .attr('stroke-linecap', 'round')\n                    .attr(\"stroke\", 'white')\n                    .attr('x2', d => coordsSI(d)[0])\n                    .attr('y2', d => coordsSI(d)[1])\n                    .attr('opacity', 0.95)\n            );\n\n        // draw line perpendicular to the SDG line\n        // to show the SI=1 threshold\n        this.config.svgGroup.selectAll('.line_si1_' + country).remove();\n        (fold === 'full') && this.config.svgGroup\n            .selectAll('.line_si1_' + country)\n            .data(pieData)\n            .join('line')\n            .each( d => {\n                if(d.data.countryScore === 0)\n                    return;\n                var startX = coordsSI(d, _.last(SI_values))[0],\n                    startY = coordsSI(d, _.last(SI_values))[1],\n                    endX = coordsSI(d, 1)[0],\n                    endY = coordsSI(d, 1)[1],\n                    angle = Math.atan2(endY - startY, endX - startX),\n                    dist = strokeWidthSDG/3;\n                \n                this.config.svgGroup.append('line')\n                    .attr('class', 'line_si1_' + country)\n                    .attr('x1',  Math.sin(angle) * dist + endX)\n                    .attr('y1', -Math.cos(angle) * dist + endY)\n                    .attr('x2', -Math.sin(angle) * dist + endX)\n                    .attr('y2',  Math.cos(angle) * dist + endY)\n                    .attr('stroke', 'white')\n                    .attr('stroke-linecap', 'butt')\n                    .attr('stroke-width', strokeWidthSDG/8)\n                    .style('pointer-events', 'none')\n                    .attr('opacity', 0)\n                    .transition()\n                    .delay(300)\n                    .attr('opacity', 0.9)\n            });\n\n        this.config.svgGroup.selectAll('.dots_si' + country).remove();\n        (fold === 'full') && SI_values.forEach((p, i) => {            \n            this.config.svgGroup.selectAll('.dots_si' + country + ' ' + 'dot' + i)\n                .data(pieData)\n                .join(\n                    enter => enter.insert('circle')\n                        .style('pointer-events', 'none')\n                        .attr('class', 'dots_si' + country + ' ' + 'dot' + i)\n                        .attr('cx', d => coordsSI(d, p)[0])\n                        .attr('cy', d => coordsSI(d, p)[1])\n                        .attr('r', 1)\n                        .attr(\"fill\", d => {\n                            let SI_value_dot = p;\n                            // decide color whether the si_bar overlaps the point or not\n                            let color = SI_value_dot > d.data.SI_numProjects? 'white': d.data.color;                            \n                            // but for the dot less than 0.250, just white, not visible\n                            return color; //SI_value_dot <= .250 ? 'white':color;\n                        })\n                        .attr('opacity', 0)\n                        .call( enter => enter.transition().delay(1000).attr('opacity', 0.4))\n                );\n        });\n\n        // update text according whether isPrimary and\n        // the current size of the placeholder\n        this.config.countryText\n            .text(_.truncate(country, {'length': 11}))\n            .call(this.updateTitle, this);\n    }\n}","/* eslint-disable */\n\n// create main global object\nconst tsnejs =  { REVISION: 'ALPHA' };\n\n(function(tsnejs) {\n  \"use strict\";\n\n  // utility function\n  var assert = function(condition, message) {\n    if (!condition) { throw message || \"Assertion failed\"; }\n  }\n\n  // syntax sugar\n  var getopt = function(opt, field, defaultval) {\n    if(opt.hasOwnProperty(field)) {\n      return opt[field];\n    } else {\n      return defaultval;\n    }\n  }\n\n  // return 0 mean unit standard deviation random number\n  var return_v = false;\n  var v_val = 0.0;\n  var gaussRandom = function() {\n    if(return_v) { \n      return_v = false;\n      return v_val; \n    }\n    var u = 2*Math.random()-1;\n    var v = 2*Math.random()-1;\n    var r = u*u + v*v;\n    if(r == 0 || r > 1) return gaussRandom();\n    var c = Math.sqrt(-2*Math.log(r)/r);\n    v_val = v*c; // cache this for next function call for efficiency\n    return_v = true;\n    return u*c;\n  }\n\n  // return random normal number\n  var randn = function(mu, std){ return mu+gaussRandom()*std; }\n\n  // utilitity that creates contiguous vector of zeros of size n\n  var zeros = function(n) {\n    if(typeof(n)==='undefined' || isNaN(n)) { return []; }\n    if(typeof ArrayBuffer === 'undefined') {\n      // lacking browser support\n      var arr = new Array(n);\n      for(var i=0;i<n;i++) { arr[i]= 0; }\n      return arr;\n    } else {\n      return new Float64Array(n); // typed arrays are faster\n    }\n  }\n\n  // utility that returns 2d array filled with random numbers\n  // or with value s, if provided\n  var randn2d = function(n,d,s) {\n    var uses = typeof s !== 'undefined';\n    var x = [];\n    for(var i=0;i<n;i++) {\n      var xhere = [];\n      for(var j=0;j<d;j++) { \n        if(uses) {\n          xhere.push(s); \n        } else {\n          xhere.push(randn(0.0, 1e-4)); \n        }\n      }\n      x.push(xhere);\n    }\n    return x;\n  }\n\n  // compute L2 distance between two vectors\n  var L2 = function(x1, x2) {\n    var D = x1.length;\n    var d = 0;\n    for(var i=0;i<D;i++) { \n      var x1i = x1[i];\n      var x2i = x2[i];\n      d += (x1i-x2i)*(x1i-x2i);\n    }\n    return d;\n  }\n\n  // compute pairwise distance in all vectors in X\n  var xtod = function(X) {\n    var N = X.length;\n    var dist = zeros(N * N); // allocate contiguous array\n    for(var i=0;i<N;i++) {\n      for(var j=i+1;j<N;j++) {\n        var d = L2(X[i], X[j]);\n        dist[i*N+j] = d;\n        dist[j*N+i] = d;\n      }\n    }\n    return dist;\n  }\n\n  // compute (p_{i|j} + p_{j|i})/(2n)\n  var d2p = function(D, perplexity, tol) {\n    var Nf = Math.sqrt(D.length); // this better be an integer\n    var N = Math.floor(Nf);\n    assert(N === Nf, \"D should have square number of elements.\");\n    var Htarget = Math.log(perplexity); // target entropy of distribution\n    var P = zeros(N * N); // temporary probability matrix\n\n    var prow = zeros(N); // a temporary storage compartment\n    for(var i=0;i<N;i++) {\n      var betamin = -Infinity;\n      var betamax = Infinity;\n      var beta = 1; // initial value of precision\n      var done = false;\n      var maxtries = 50;\n\n      // perform binary search to find a suitable precision beta\n      // so that the entropy of the distribution is appropriate\n      var num = 0;\n      while(!done) {\n        //debugger;\n\n        // compute entropy and kernel row with beta precision\n        var psum = 0.0;\n        for(var j=0;j<N;j++) {\n          var pj = Math.exp(- D[i*N+j] * beta);\n          if(i===j) { pj = 0; } // we dont care about diagonals\n          prow[j] = pj;\n          psum += pj;\n        }\n        // normalize p and compute entropy\n        var Hhere = 0.0;\n        for(var j=0;j<N;j++) {\n          if(psum == 0) {\n             var pj = 0;\n          } else {\n             var pj = prow[j] / psum;\n          }\n          prow[j] = pj;\n          if(pj > 1e-7) Hhere -= pj * Math.log(pj);\n        }\n\n        // adjust beta based on result\n        if(Hhere > Htarget) {\n          // entropy was too high (distribution too diffuse)\n          // so we need to increase the precision for more peaky distribution\n          betamin = beta; // move up the bounds\n          if(betamax === Infinity) { beta = beta * 2; }\n          else { beta = (beta + betamax) / 2; }\n\n        } else {\n          // converse case. make distrubtion less peaky\n          betamax = beta;\n          if(betamin === -Infinity) { beta = beta / 2; }\n          else { beta = (beta + betamin) / 2; }\n        }\n\n        // stopping conditions: too many tries or got a good precision\n        num++;\n        if(Math.abs(Hhere - Htarget) < tol) { done = true; }\n        if(num >= maxtries) { done = true; }\n      }\n\n      // console.log('data point ' + i + ' gets precision ' + beta + ' after ' + num + ' binary search steps.');\n      // copy over the final prow to P at row i\n      for(var j=0;j<N;j++) { P[i*N+j] = prow[j]; }\n\n    } // end loop over examples i\n\n    // symmetrize P and normalize it to sum to 1 over all ij\n    var Pout = zeros(N * N);\n    var N2 = N*2;\n    for(var i=0;i<N;i++) {\n      for(var j=0;j<N;j++) {\n        Pout[i*N+j] = Math.max((P[i*N+j] + P[j*N+i])/N2, 1e-100);\n      }\n    }\n\n    return Pout;\n  }\n\n  // helper function\n  function sign(x) { return x > 0 ? 1 : x < 0 ? -1 : 0; }\n\n  var tSNE = function(opt) {\n    var opt = opt || {};\n    this.perplexity = getopt(opt, \"perplexity\", 30); // effective number of nearest neighbors\n    this.dim = getopt(opt, \"dim\", 2); // by default 2-D tSNE\n    this.epsilon = getopt(opt, \"epsilon\", 10); // learning rate\n\n    this.iter = 0;\n\n    this.initDataRaw = function(X) {\n        var N = X.length;\n        var D = X[0].length;\n        assert(N > 0, \" X is empty? You must have some data!\");\n        assert(D > 0, \" X[0] is empty? Where is the data?\");\n        var dists = xtod(X); // convert X to distances using gaussian kernel\n        this.P = d2p(dists, this.perplexity, 1e-4); // attach to object\n        this.N = N; // back up the size of the dataset\n        this.initSolution(); // refresh this\n      };\n  \n    // this function takes a given distance matrix and creates\n    // matrix P from them.\n    // D is assumed to be provided as a list of lists, and should be symmetric\n    this.initDataDist = function(D) {\n    var N = D.length;\n    assert(N > 0, \" X is empty? You must have some data!\");\n    // convert D to a (fast) typed array version\n    var dists = zeros(N * N); // allocate contiguous array\n    for(var i=0;i<N;i++) {\n        for(var j=i+1;j<N;j++) {\n        var d = D[i][j];\n        dists[i*N+j] = d;\n        dists[j*N+i] = d;\n        }\n    }\n    this.P = d2p(dists, this.perplexity, 1e-4);\n    this.N = N;\n    this.initSolution(); // refresh this\n    };\n\n    // (re)initializes the solution to random\n    this.initSolution= function() {\n    // generate random solution to t-SNE\n    this.Y = randn2d(this.N, this.dim); // the solution\n    this.gains = randn2d(this.N, this.dim, 1.0); // step gains to accelerate progress in unchanging directions\n    this.ystep = randn2d(this.N, this.dim, 0.0); // momentum accumulator\n    this.iter = 0;\n    };\n\n    // return pointer to current solution\n    this.getSolution = function() {\n    return this.Y;\n    };\n\n    // perform a single step of optimization to improve the embedding\n    this.step = function() {\n    this.iter += 1;\n    var N = this.N;\n\n    var cg = this.costGrad(this.Y); // evaluate gradient\n    var cost = cg.cost;\n    var grad = cg.grad;\n\n    // perform gradient step\n    var ymean = zeros(this.dim);\n    for(var i=0;i<N;i++) {\n        for(var d=0;d<this.dim;d++) {\n        var gid = grad[i][d];\n        var sid = this.ystep[i][d];\n        var gainid = this.gains[i][d];\n\n        // compute gain update\n        var newgain = sign(gid) === sign(sid) ? gainid * 0.8 : gainid + 0.2;\n        if(newgain < 0.01) newgain = 0.01; // clamp\n        this.gains[i][d] = newgain; // store for next turn\n\n        // compute momentum step direction\n        var momval = this.iter < 250 ? 0.5 : 0.8;\n        var newsid = momval * sid - this.epsilon * newgain * grad[i][d];\n        this.ystep[i][d] = newsid; // remember the step we took\n\n        // step!\n        this.Y[i][d] += newsid; \n\n        ymean[d] += this.Y[i][d]; // accumulate mean so that we can center later\n        }\n    }\n\n    // reproject Y to be zero mean\n    for(var i=0;i<N;i++) {\n        for(var d=0;d<this.dim;d++) {\n        this.Y[i][d] -= ymean[d]/N;\n        }\n    }\n\n    //if(this.iter%100===0) console.log('iter ' + this.iter + ', cost: ' + cost);\n    return cost; // return current cost\n    };\n\n    // for debugging: gradient check\n    this.debugGrad = function() {\n    var N = this.N;\n\n    var cg = this.costGrad(this.Y); // evaluate gradient\n    var cost = cg.cost;\n    var grad = cg.grad;\n\n    var e = 1e-5;\n    for(var i=0;i<N;i++) {\n        for(var d=0;d<this.dim;d++) {\n        var yold = this.Y[i][d];\n\n        this.Y[i][d] = yold + e;\n        var cg0 = this.costGrad(this.Y);\n\n        this.Y[i][d] = yold - e;\n        var cg1 = this.costGrad(this.Y);\n        \n        var analytic = grad[i][d];\n        var numerical = (cg0.cost - cg1.cost) / ( 2 * e );\n        console.log(i + ',' + d + ': gradcheck analytic: ' + analytic + ' vs. numerical: ' + numerical);\n\n        this.Y[i][d] = yold;\n        }\n    }\n    };\n\n    // return cost and gradient, given an arrangement\n    this.costGrad = function(Y) {\n    var N = this.N;\n    var dim = this.dim; // dim of output space\n    var P = this.P;\n\n    var pmul = this.iter < 100 ? 4 : 1; // trick that helps with local optima\n\n    // compute current Q distribution, unnormalized first\n    var Qu = zeros(N * N);\n    var qsum = 0.0;\n    for(var i=0;i<N;i++) {\n        for(var j=i+1;j<N;j++) {\n        var dsum = 0.0;\n        for(var d=0;d<dim;d++) {\n            var dhere = Y[i][d] - Y[j][d];\n            dsum += dhere * dhere;\n        }\n        var qu = 1.0 / (1.0 + dsum); // Student t-distribution\n        Qu[i*N+j] = qu;\n        Qu[j*N+i] = qu;\n        qsum += 2 * qu;\n        }\n    }\n    // normalize Q distribution to sum to 1\n    var NN = N*N;\n    var Q = zeros(NN);\n    for(var q=0;q<NN;q++) { Q[q] = Math.max(Qu[q] / qsum, 1e-100); }\n\n    var cost = 0.0;\n    var grad = [];\n    for(var i=0;i<N;i++) {\n        var gsum = new Array(dim); // init grad for point i\n        for(var d=0;d<dim;d++) { gsum[d] = 0.0; }\n        for(var j=0;j<N;j++) {\n        cost += - P[i*N+j] * Math.log(Q[i*N+j]); // accumulate cost (the non-constant portion at least...)\n        var premult = 4 * (pmul * P[i*N+j] - Q[i*N+j]) * Qu[i*N+j];\n        for(var d=0;d<dim;d++) {\n            gsum[d] += premult * (Y[i][d] - Y[j][d]);\n        }\n        }\n        grad.push(gsum);\n    }\n\n    return {cost: cost, grad: grad};\n    };\n    return this;\n  }\n\n  tsnejs.tSNE = tSNE;\n  return tsnejs;\n})(tsnejs);\n\nexport default tsnejs;","/* eslint-disable */\n\nimport * as d3 from 'd3';\nimport * as _ from 'lodash';\nimport tsnejs from './tsne';\nimport p_numProjectsSDG from '../../data/tsne/p_numProjectsSDG.csv'\n\nlet tsneSolver = function() {\n\n    var data, dataRaw;\n\n    // svg info\n    var elementSelector, // selector for svg\n        svg,             // d3 svg selection\n        width,           // svg width   \n        height;          // svg height\n\n    // t-sne settings\n    var opt         = {}\n    opt.epsilon     = 20; // epsilon is learning rate (10 = default)\n    opt.perplexity  = 30; // roughly how many neighbors each point influences (30 = default)\n    opt.dim         = 2; // dimensionality of the embedding (2 = default)\n    \n    // create a tSNE instance\n    var tsne        = tsnejs.tSNE(opt); \n\n    // loads data files containing a specific measure, for all\n    // countries and for all SDGs. Generated from R data analysis tasks:\n    /*\n    |countryName |SDG 1                |SDG 10               |SDG 11              |SDG 12              |SDG 13              |SDG 14               |SDG 15               |SDG 16               |SDG 2                |SDG 3                |SDG 4                |SDG 5                |SDG 6                |SDG 7               |SDG 8                |SDG 9              |\n    |:-----------|:--------------------|:--------------------|:-------------------|:-------------------|:-------------------|:--------------------|:--------------------|:--------------------|:--------------------|:--------------------|:--------------------|:--------------------|:--------------------|:-------------------|:--------------------|:------------------|\n    |Afghanistan |0                    |0.3333333333333333   |0                   |0                   |0                   |0                    |0                    |0                    |0                    |0                    |0                    |0                    |0                    |0                   |0                    |0                  |\n    |Albania     |0.057692307692307696 |0                    |0.09615384615384616 |0                   |0.11538461538461539 |0.019230769230769232 |0.057692307692307696 |0.09615384615384616  |0.057692307692307696 |0.057692307692307696 |0                    |0.038461538461538464 |0.038461538461538464 |0.09615384615384616 |0.057692307692307696 |0.3076923076923077 |\n    |Algeria     |0                    |0.044444444444444446 |0.1111111111111111  |0.1111111111111111  |0.13333333333333333 |0.08888888888888889  |0.1111111111111111   |0.044444444444444446 |0.13333333333333333  |0.044444444444444446 |0                    |0.044444444444444446 |0.044444444444444446 |0.08888888888888889 |0.1111111111111111   |0.4                |\n    |Angola      |0                    |0                    |0                   |0                   |0.5                 |0.5                  |0                    |0                    |0                    |0.25                 |0                    |0                    |0                    |0                   |0                    |0                  |\n    |Anguilla    |0                    |0                    |0                   |0                   |0.25                |0                    |0                    |0                    |0                    |0                    |0                    |0                    |0                    |0.5                 |0.25                 |0                  |\n    |Argentina   |0.019230769230769232 |0.0673076923076923   |0.10576923076923077 |0.11057692307692307 |0.14903846153846154 |0.04326923076923077  |0.08173076923076923  |0.09134615384615384  |0.08173076923076923  |0.08173076923076923  |0.019230769230769232 |0.014423076923076924 |0.09134615384615384  |0.08173076923076923 |0.11057692307692307  |0.2692307692307692 |\n    */\n    function loadData() {\n        return new Promise( function(resolve, reject) {\n            d3.csv( \n                p_numProjectsSDG, \n                function(d) {\n                    // cast to int all columns containing SDGs values\n                    return _.mapValues(\n                        d,\n                        (v, k) => k.indexOf('SDG') !== -1? +v:v\n                    );\n                })\n                .then(d => {\n                    // transform the data so we have an array of arrays (high-dimensional \n                    // points that need to be embedded). Each array (country)\n                    //contains an array with the SDG values for that country\n                    data = d;\n                    dataRaw = _.map(\n                        d,\n                        o => _.transform(o, (result, v, k) => {\n                            if(k.indexOf('SDG') !== -1) result.push(v);\n                        }, [])\n                    );\n\n                    tsne.initDataRaw(dataRaw);\n\n                    // get final positions for each country\n                    let coords = getSolution();\n\n                    // join coords with the original country data,\n                    // so we can access coords by country\n                    data.forEach( (country, i) => {\n                        country.tsneCoords = coords[i];\n                    });\n\n                    resolve(data);\n                });\n        });\n    };\n    \n\n    function tsneCoordsToSVGCoords(elementSelector) {\n\n        // consider some margin so we do not have\n        // points on the edges of the SVG\n        const margin = 50;\n\n        let width   = +d3.select(elementSelector).attr('width') - margin,\n            height  = +d3.select(elementSelector).attr('height') - margin;\n\n        // scales to place the country according the\n        // tsne coord using d3 scales\n        // create scales \n        const x = d3.scaleLinear()\n            .domain(d3.extent(data, function(d) { return d.tsneCoords[0];}))\n            .range([0 + margin, width]);\n\n        const y = d3.scaleLinear()\n            .domain(d3.extent(data, function(d) { return d.tsneCoords[1];}))\n            .range([height, 0 + margin]);\n        \n        data.forEach( (d, i) => {\n            d.svgCoords = [\n                x(d.tsneCoords[0]), \n                y(d.tsneCoords[1])\n            ];\n        });\n    }\n\n    function getData() {\n        return data;\n    }\n\n\n    function draw(_elementSelector) {\n        elementSelector = _elementSelector;\n        svg = d3.select(elementSelector);\n        width = svg.attr('width');\n        height = svg.attr('height');\n\n        let g = svg.selectAll('g.node')\n                .data(data, d => d? d.countryName : undefined)\n                .enter()\n                .append('g')\n                .attr('class', 'node');\n        \n        g.append('circle')\n            .attr('cx', 100)\n            .attr('cy', 100)\n            .attr('r', 10)\n            .attr('stroke-width', 1)\n            .attr('stroke', 'black')\n            .attr('fill', 'rgb(100,100,255)');\n\n        g.append(\"text\")\n            .attr(\"text-anchor\", \"top\")\n            .attr(\"transform\", \"translate(5, -5)\")\n            .attr(\"font-size\", 12)\n            .attr(\"fill\", \"#333\")\n            .text(function(d,i) { return d.countryName; });\n    }\n\n\n    function getSolution() {\n        // run a few steps\n        for(var k = 0; k < 500; k++)\n            // every time you call this, solution gets better\n            tsne.step(); \n\n        // return array of 2-D points that you can plot\n        return tsne.getSolution(); \n    }\n\n    return {\n        loadData: loadData,\n        getSolution: getSolution,\n        getData: getData,\n        draw: draw,\n        tsneCoordsToSVGCoords: tsneCoordsToSVGCoords\n    }\n};\n\nconst tsnePlot = tsneSolver();\nexport default tsnePlot;","import * as _ from 'lodash';\nimport * as d3 from 'd3';\n\n/**\n * Show/hide those elements acting as placholders of static plots\n */\nexport function showStaticPlaceholders(visibility = true) {\n    var toggle = selection =>\n        selection\n            .transition()\n            .duration(300)\n            .style('opacity', visibility ? 1 : 0);\n\n    d3.select('.chart-container.primary').call(toggle);\n    d3.selectAll('.chart-container.secondary').call(toggle);\n    d3.select('.header-similar-countries').call(toggle);\n};\n\n\n\n/**\n * When the countries are shown in static positions within\n * the SVG, these positions are visually centered acording\n * other placholders (other divs outside the SVG), so\n * given these DOM elements, calculate its size (the country\n * plot is sized according this sized) and its position (it\n * will be the center of the placeholder)\n * @param {DOM node} reactRefs \n */\nexport function getStaticPositions(reactRefs) {\n\n    // get only those react refs nodes that\n    // contain country plots AND the header\n    const countryRefs = _.filter(\n        _.keys(reactRefs),\n        ref => ref.indexOf('country') !== -1\n    );\n\n    let refsData = {};\n\n    countryRefs\n        .concat(['secondary-header'])\n        .forEach(ref => {\n        switch (ref) {\n            case 'secondary-header':\n                refsData[ref] = {\n                    width: reactRefs['secondary-header'].offsetWidth,\n                    height: reactRefs['secondary-header'].offsetHeight\n                }; break;\n\n            case 'primary-country':\n                refsData[ref] = {\n                    x: reactRefs['primary-country'].offsetWidth / 2,\n                    y: (reactRefs['primary-country'].offsetHeight / 2) * 1.2,\n                    width: reactRefs['primary-country'].offsetWidth,\n                    height: reactRefs['primary-country'].offsetHeight,\n                    isPrimary: true\n                }; break;\n\n            case 'secondary-country-0':\n                \n                refsData[ref] = {\n                    x: reactRefs['primary-country'].offsetWidth +\n                        reactRefs['secondary-country-0'].offsetWidth / 2,\n                    y: reactRefs['secondary-header'].offsetHeight + (reactRefs['secondary-country-0'].offsetHeight / 2),\n                    width: reactRefs['secondary-country-0'].offsetWidth,\n                    height: reactRefs['secondary-country-0'].offsetHeight,\n                    isPrimary: false\n                }; break;\n\n            case 'secondary-country-1':\n                refsData[ref] = {\n                    x: reactRefs['primary-country'].offsetWidth +\n                        reactRefs['secondary-country-0'].offsetWidth +\n                        reactRefs['secondary-country-1'].offsetWidth / 2,\n                    y: reactRefs['secondary-header'].offsetHeight + (reactRefs['secondary-country-1'].offsetHeight / 2),\n                    width: reactRefs['secondary-country-1'].offsetWidth,\n                    height: reactRefs['secondary-country-1'].offsetHeight,\n                    isPrimary: false\n                }; break;\n\n            case 'secondary-country-2':\n                refsData[ref] = {\n                    x: reactRefs['primary-country'].offsetWidth +\n                        reactRefs['secondary-country-2'].offsetWidth / 2,\n                    y: reactRefs['secondary-header'].offsetHeight + \n                        reactRefs['secondary-country-0'].offsetHeight +\n                        (reactRefs['secondary-country-2'].offsetHeight / 2),\n                    width: reactRefs['secondary-country-2'].offsetWidth,\n                    height: reactRefs['secondary-country-2'].offsetHeight,\n                    isPrimary: false\n                }; break;\n\n            case 'secondary-country-3':\n                refsData[ref] = {\n                    x: reactRefs['primary-country'].offsetWidth +\n                        reactRefs['secondary-country-2'].offsetWidth +\n                        reactRefs['secondary-country-3'].offsetWidth / 2,\n                    y: reactRefs['secondary-header'].offsetHeight + \n                        reactRefs['secondary-country-0'].offsetHeight +\n                        (reactRefs['secondary-country-3'].offsetHeight / 2),\n                    width: reactRefs['secondary-country-3'].offsetWidth,\n                    height: reactRefs['secondary-country-3'].offsetHeight,\n                    isPrimary: false\n                }; break;\n            default: break;\n        }\n    });\n\n    return refsData;\n}\n\n\n/**\n * Fromt the list of country plots, picks the one\n * with the countryLabel + 4 random\n * @param {Collection} plots \n * @param {String} countryLabel \n */\nexport function pickPlotsForStaticLayout(plots, country, isMobile) {\n    let staticPlots = [];\n\n    staticPlots.push(\n        _.find(plots, plot => plot.label === country.label)\n    );\n    !isMobile && country.related.forEach(countryName => {\n        staticPlots.push(\n            _.find(plots, plot => plot.label === countryName.label)\n        );\n    })\n\n    return staticPlots;\n}\n\nvar contains = function (x1, y1, w, h, x, y) {\n    return x1 <= x && x <= x1 + w && y1 <= y && y <= y1 + h;\n}\n\n\nexport function getCountryHoverListener(reactThis, fixedLayoutData, REFS) {\n    const iconSize = 63;\n    const cleanHover = () => {\n        reactThis.refs['primary-country'].style.boxShadow =\n            reactThis.refs['secondary-country-0'].style.boxShadow =\n            reactThis.refs['secondary-country-1'].style.boxShadow =\n            reactThis.refs['secondary-country-2'].style.boxShadow =\n            reactThis.refs['secondary-country-3'].style.boxShadow = null;\n        reactThis.refs['primary-country'].style.zIndex =\n            reactThis.refs['secondary-country-0'].style.zIndex =\n            reactThis.refs['secondary-country-1'].style.zIndex =\n            reactThis.refs['secondary-country-2'].style.zIndex =\n            reactThis.refs['secondary-country-3'].style.zIndex = 0\n    };\n\n        reactThis.refs['show-modal-btn'].style.left = \n                        - iconSize + 10 + \n                        fixedLayoutData[REFS.PRIMARY_COUNTRY].width + 'px';\n        reactThis.refs['show-modal-btn'].style.top = \n                        - iconSize + fixedLayoutData[REFS.PRIMARY_COUNTRY].height + 'px';\n        \n    \n\n    d3.select('.svg-placeholder-countries').node()\n        .addEventListener('mousemove', e => {\n            // when not in the static step, do not show button\n            if(reactThis.state.phase !== 'static')\n                return;\n            cleanHover();\n            if (contains(\n                0, 0,\n                fixedLayoutData[REFS.PRIMARY_COUNTRY].width,\n                fixedLayoutData[REFS.PRIMARY_COUNTRY].height,\n                e.offsetX, e.offsetY\n            )) {\n                reactThis.staticCountryIndex = 0;\n                reactThis.refs['primary-country'].style.boxShadow = '0 0 25px rgba(0,0,0,.15)';\n                reactThis.refs['primary-country'].style.zIndex = 100;\n                reactThis.refs['show-modal-btn'].style.display='block';\n                reactThis.refs['show-modal-btn'].style.left = \n                    - iconSize + 10 + \n                    fixedLayoutData[REFS.PRIMARY_COUNTRY].width + 'px';\n                reactThis.refs['show-modal-btn'].style.top = \n                    - iconSize + fixedLayoutData[REFS.PRIMARY_COUNTRY].height + 'px';\n            }\n            else if (contains(\n                fixedLayoutData[REFS.PRIMARY_COUNTRY].width,\n                fixedLayoutData[REFS.SECONDARY_HEADER].height,\n                fixedLayoutData[REFS.SECONDARY_COUNTRY_0].width,\n                fixedLayoutData[REFS.SECONDARY_COUNTRY_0].height,\n                e.offsetX, e.offsetY\n            )) {\n                reactThis.staticCountryIndex = 1;\n                reactThis.refs['secondary-country-0'].style.boxShadow = '0 0 25px rgba(0,0,0,.15)';\n                reactThis.refs['secondary-country-0'].style.zIndex = 100;\n                reactThis.refs['show-modal-btn'].style.display='block';\n                reactThis.refs['show-modal-btn'].style.left = \n                    - iconSize + 10 +\n                    fixedLayoutData[REFS.PRIMARY_COUNTRY].width + \n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_0].width + 'px';                \n                reactThis.refs['show-modal-btn'].style.top = \n                    - iconSize + \n                    fixedLayoutData[REFS.SECONDARY_HEADER].height + \n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_0].height  + 'px';\n            }\n            else if (contains(\n                fixedLayoutData[REFS.PRIMARY_COUNTRY].width + fixedLayoutData[REFS.SECONDARY_COUNTRY_0].width,\n                fixedLayoutData[REFS.SECONDARY_HEADER].height,\n                fixedLayoutData[REFS.SECONDARY_COUNTRY_1].width,\n                fixedLayoutData[REFS.SECONDARY_COUNTRY_1].height,\n                e.offsetX, e.offsetY\n            )) {\n                reactThis.staticCountryIndex = 2;\n                reactThis.refs['secondary-country-1'].style.boxShadow = '0 0 25px rgba(0,0,0,.15)';\n                reactThis.refs['secondary-country-1'].style.zIndex = 100;\n                reactThis.refs['show-modal-btn'].style.display='block';\n                reactThis.refs['show-modal-btn'].style.left = \n                    - iconSize + 10 +\n                    fixedLayoutData[REFS.PRIMARY_COUNTRY].width +\n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_0].width +\n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_1].width + 'px';\n                reactThis.refs['show-modal-btn'].style.top = \n                    - iconSize +\n                    fixedLayoutData[REFS.SECONDARY_HEADER].height + \n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_1].height  + 'px';\n            }\n            else if (contains(\n                fixedLayoutData[REFS.PRIMARY_COUNTRY].width,\n                fixedLayoutData[REFS.SECONDARY_HEADER].height + fixedLayoutData[REFS.SECONDARY_COUNTRY_0].height,\n                fixedLayoutData[REFS.SECONDARY_COUNTRY_2].width,\n                fixedLayoutData[REFS.SECONDARY_COUNTRY_2].height,\n                e.offsetX, e.offsetY\n            )) {\n                reactThis.staticCountryIndex = 3;\n                reactThis.refs['secondary-country-2'].style.boxShadow = '0 0 25px rgba(0,0,0,.15)';\n                reactThis.refs['secondary-country-2'].style.zIndex = 100;\n                reactThis.refs['show-modal-btn'].style.display='block';\n                reactThis.refs['show-modal-btn'].style.left = \n                    - iconSize + 10 +\n                    fixedLayoutData[REFS.PRIMARY_COUNTRY].width + \n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_2].width + 'px';\n                reactThis.refs['show-modal-btn'].style.top = \n                    - iconSize + \n                    fixedLayoutData[REFS.SECONDARY_HEADER].height + \n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_0].height +\n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_2].height + 'px';\n            }\n            else if (contains(\n                fixedLayoutData[REFS.PRIMARY_COUNTRY].width + fixedLayoutData[REFS.SECONDARY_COUNTRY_0].width,\n                fixedLayoutData[REFS.SECONDARY_HEADER].height + fixedLayoutData[REFS.SECONDARY_COUNTRY_0].height,\n                fixedLayoutData[REFS.SECONDARY_COUNTRY_3].width,\n                fixedLayoutData[REFS.SECONDARY_COUNTRY_3].height,\n                e.offsetX, e.offsetY\n            )) {\n                reactThis.staticCountryIndex = 4;\n                reactThis.refs['secondary-country-3'].style.boxShadow = '0 0 25px rgba(0,0,0,.15)';\n                reactThis.refs['secondary-country-3'].style.zIndex = 100;\n                reactThis.refs['show-modal-btn'].style.display='block';\n                reactThis.refs['show-modal-btn'].style.left = \n                    - iconSize + 10 + \n                    fixedLayoutData[REFS.PRIMARY_COUNTRY].width +\n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_0].width +\n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_3].width + 'px';\n                reactThis.refs['show-modal-btn'].style.top = \n                    - iconSize + \n                    fixedLayoutData[REFS.SECONDARY_HEADER].height + \n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_1].height +\n                    fixedLayoutData[REFS.SECONDARY_COUNTRY_2].height  + 'px';\n            }\n        });\n    d3.select('.svg-placeholder-countries').node()\n        .addEventListener('mouseleave', () => {\n            cleanHover();\n            //reactThis.refs['show-modal-btn'].style.display='none';\n        });\n\n}","import StateMachine from 'javascript-state-machine';\nimport * as _ from 'lodash';\n\nexport const UNSET   = 'unset';\nexport const STATIC  = 'static';\nexport const TSNE    = 'tsne';\nexport const TERNARY = 'ternary';\n\nvar fsm = new StateMachine({\n    init: 'unset',\n    transitions: [\n      { name: 'toStatic',    from: UNSET,  to: STATIC },\n      { name: 'toTsne',      from: STATIC, to: TSNE },\n      { name: 'toTernary',   from: TSNE,   to: TERNARY},\n      { name: 'fromTernary', from: TERNARY,to: TSNE},\n      { name: 'fromTsne',    from: TSNE,   to: STATIC }\n    ],\n    methods: {\n      onToStatic:    function() { console.log('reached static')    },\n      onToTsne:      function() { console.log('reached tsne')    },\n      onToTernary:   function() { console.log('reached ternary')     },\n      onFromTernary: function() { console.log('back to tsne') },\n      onFromTsne:    function() { console.log('back to static') }\n    }\n  });\n\n\n// decide which phase of the storytelling go to, dependin\n// on which step of the article we are. Steps of the\n// articles are on the markdown\nvar decidePhase = function(article_step) {\n    if( _.inRange(article_step, 0, 2+1) ) {\n        if(fsm.is(UNSET))\n            fsm.toStatic();\n        if(fsm.is(TSNE))\n            fsm.fromTsne();\n    }\n    if( _.inRange(article_step, 3, 7+1) ) {\n        if(fsm.is(STATIC))\n            fsm.toTsne();\n        else if(fsm.is(TERNARY))\n            fsm.fromTernary();\n    }\n    if( _.inRange(article_step, 8, 9+1) ) {\n        if(fsm.is(TSNE))\n            fsm.toTernary();\n    }\n    return fsm.state;\n};\nexport {fsm, decidePhase}\n","import * as d3 from 'd3';\n\n// configuration settings\nconst margin = {\n        top: 25,\n        left: 0,\n        bottom: 0,\n        right: 0\n    },\n    axis_ticks = [0,100], //[0,20,40,60,80,100],\n    //tickLabelMargin = 10,\n    axisLabelMargin = 20,\n    // positions of the axis:\n    // economy: bottom left\n    // society: bottom right\n    // biosphere: top\n    axis_labels = ['economy', 'society', 'biosphere'],\n    minor_axis_ticks = d3.range(0, 101, 5);\n\n    \n\n\n\nlet ternaryGraph = function() {\n    var elementSelector,\n        side,\n        svg,\n        axes,\n        w,h,\n        corners,\n        translateX,\n        translateY;\n\n    // data coming from outside\n    function getCoord(datum) {\n        let pos = coord([\n            datum[axis_labels[0]],\n            datum[axis_labels[1]],\n            datum[axis_labels[2]]\n        ]);\n        return [\n            pos[0] + translateX, \n            pos[1] + translateY\n        ];\n    };\n\n    function coord(arr){\n        var a = arr[0], \n            b = arr[1], \n            c = arr[2]; \n    \n        var sum, \n            pos = [0,0];\n        sum = a + b + c;\n        if(sum !== 0) {\n            a /= sum;\n            b /= sum;\n            c /= sum;\n            pos[0] =  corners[0][0]  * a + corners[1][0]  * b + corners[2][0]  * c;\n            pos[1] =  corners[0][1]  * a + corners[1][1]  * b + corners[2][1]  * c;\n        }\n        // add the translate of the main <g> placeholder\n        return pos;\n    }\n\n    function show() { svg.attr('display', 'inline'); }\n    function hide() { svg.attr('display', 'none'); }\n\n\n\n    function init(_elementSelector) {\n        elementSelector = _elementSelector;\n        \n        // decide size for the ternary plot\n        side = Math.min(\n            +d3.select(elementSelector).attr('width'),\n            +d3.select(elementSelector).attr('height')\n        ) * 0.9;    \n        // add degs\n        let _svg = d3.select(elementSelector);\n        let gradient = _svg.append('defs')\n                .append('linearGradient')\n                .attr('id', 'ternary-gradient');\n        gradient.append('stop').attr('offset', '0%').attr('stop-color', '#333');\n        gradient.append('stop').attr('offset', '50%').attr('stop-color', '#fff');\n        gradient.append('stop').attr('offset', '100%').attr('stop-color', '#333');\n\n        svg = d3.select(elementSelector)\n            .append('g')\n            .attr('class', 'ternary');\n        \n        // hide the plot until someone will show it\n        hide();\n\n        axes = svg.append('g').attr('class', 'axes')\n        w = side;\n        h = Math.sqrt( side*side - (side/2)*(side/2));\n\n        // center the ternary\n        translateX = +d3.select(elementSelector).attr('width')/2 - side/2;\n        translateY = 50;\n        svg.attr('transform', 'translate(' + translateX + ', ' + translateY + ')');\n        corners = [\n            [margin.left, h + margin.top],      // a\n            [ w + margin.left, h + margin.top], // b \n            [(w/2) + margin.left, margin.top]   // c\n        ];\n    }    \n\n    function draw() {\n        var line = d3.line()\n            .x(d => d[0])\n            .y(d => d[1]);\n\n        //axis names\n        axes.selectAll('.axis-title')\n            .data(axis_labels)\n            .enter()\n                .append('g')\n                    .attr('class', 'axis-title')\n                    .attr('transform',function(d,i){\n                        return 'translate('+corners[i][0]+','+corners[i][1]+')';\n                    })\n                    .append('text')\n                    .text(function(d){ return d; })\n                    .attr('text-anchor', function(d,i){\n                        if(i===0) return 'end';\n                        if(i===2) return 'middle';\n                        return 'start';\n                        \n                    })\n                    .attr('transform', function(d,i){\n                        var theta = 0;\n                        if(i===0) theta = 120;\n                        if(i===1) theta = 60;\n                        if(i===2) theta = -90;\n\n                        var x = axisLabelMargin * Math.cos(theta * 0.0174532925),\n                            y = axisLabelMargin * Math.sin(theta * 0.0174532925);\n                        return 'translate('+x+','+y+')'\n                    });\n\n        // ticks\n        //var n = axis_ticks.length;\n        if(minor_axis_ticks){\n            minor_axis_ticks.forEach(function(v) {\t\n                var coord1 = coord( [v, 0, 100-v] );\n                var coord2 = coord( [v, 100-v, 0] );\n                var coord3 = coord( [0, 100-v, v] );\n                var coord4 = coord( [100-v, 0, v] );\n\n                axes.append(\"path\")\n                    .attr('d', line([coord1, coord2]) )\n                    .classed('a-axis minor-tick', true);\t\n\n                axes.append(\"path\")\n                    .attr('d', line([coord2, coord3]) )\n                    .classed('b-axis minor-tick', true);\t\n\n                axes.append(\"path\")\n                    .attr('d', line([coord3, coord4]) )\n                    .classed('c-axis minor-tick', true);\n            });\n        }\n\n        // annotations\n        var coordAnnotation,\n            offsetAnnotation = 10;\n        // first and third axis (economy-biosphere)\n        coordAnnotation = coord( [50, 0, 100-50] );\n        axes.append('g')\n            .attr('transform',d => 'translate(' + coordAnnotation[0] + ',' + coordAnnotation[1] + ')')\n            .append(\"text\")\n                .attr('transform','rotate(-60)')\n                .attr('text-anchor','start')\n                .attr('x',offsetAnnotation).attr('y',-offsetAnnotation)\n                .text('Biosphere-oriented →' )\n                .classed('annotation-text', true );\n        axes.append('g')\n            .attr('transform',d => 'translate(' + coordAnnotation[0] + ',' + coordAnnotation[1] + ')')\n            .append(\"text\")\n                .attr('transform','rotate(-60)')\n                .attr('text-anchor','end')\n                .attr('x',-offsetAnnotation).attr('y',-offsetAnnotation)\n                .text('← Economy-oriented' )\n                .classed('annotation-text', true );\n        \n        // first and second axis (economy-society)\n        coordAnnotation = coord( [50, 100-50, 0] );\n        axes.append('g')\n            .attr('transform',d => 'translate(' + coordAnnotation[0] + ',' + coordAnnotation[1] + ')')\n            .append(\"text\")\n                .attr('x', offsetAnnotation)\n                .attr('y', offsetAnnotation*2)\n                .text(\"Society-oriented →\")\n                .classed('annotation-text', true);\n        axes.append('g')\n            .attr('transform',d => 'translate(' + coordAnnotation[0] + ',' + coordAnnotation[1] + ')')\n            .append(\"text\")\n                .attr('x', -offsetAnnotation)\n                .attr('y', offsetAnnotation*2)\n                .attr('text-anchor','end')\n                .text(\"← Economy-oriented\")\n                .classed('annotation-text', true);                    \n\n        // second and third axis (society-biosphere)\n        coordAnnotation = coord( [0, 100-50, 50] );\n        axes.append('g')\n            .attr('transform', d => 'translate(' + coordAnnotation[0] + ',' + coordAnnotation[1] + ')')\n            .append(\"text\")\n                .text( \"Society-oriented →\")\n                .attr('transform','rotate(60)')\n                .attr('x', offsetAnnotation)\n                .attr('y', -offsetAnnotation)\n                .classed('annotation-text', true);\n        axes.append('g')\n            .attr('transform', d => 'translate(' + coordAnnotation[0] + ',' + coordAnnotation[1] + ')')\n            .append(\"text\")\n                .text( \"← Biosphere-oriented\")\n                .attr('text-anchor','end')\n                .attr('transform','rotate(60)')\n                .attr('x', -offsetAnnotation)\n                .attr('y', -offsetAnnotation)\n                .classed('annotation-text', true);                    \n\n        axis_ticks.forEach(function(v) {\t\n            var coord1 = coord( [v, 0, 100-v] );\n            var coord2 = coord( [v, 100-v, 0] );\n            var coord3 = coord( [0, 100-v, v] );\n            var coord4 = coord( [100-v, 0, v] );\n\n            axes.append(\"path\")\n                .attr('d', line([coord1, coord2]) )\n                .classed('a-axis tick', true);\t\n\n            axes.append(\"path\")\n                .attr('d', line([coord2, coord3]) )\n                .classed('b-axis tick', true);\t\n    \n            axes.append(\"path\")\n                // hacky way to make the stroke gradient color style\n                // visible when the draw is vertical/horizontal. In\n                // this cases the gradient is not shown (not diagonals\n                // lines have no dim w or h (my guess...) ), so\n                // for the bottom axis, make it just a bit diagonal\n                // by moving one of the y positions a bit\n                .attr('d', line([coord3, [coord4[0], coord4[1]-1]]) )\n                .classed('c-axis tick', true);\n\n            //tick labels\n/*            \n            axes.append('g')\n                .attr('transform',function(d){\n                    return 'translate(' + coord1[0] + ',' + coord1[1] + ')'\n                })\n                .append(\"text\")\n                    .attr('transform','rotate(60)')\n                    .attr('text-anchor','end')\n                    .attr('x',-tickLabelMargin)\n                    .text( function (d) { return v; } )\n                    .classed('a-axis tick-text', true );\n\n            axes.append('g')\n                .attr('transform',function(d){\n                    return 'translate(' + coord2[0] + ',' + coord2[1] + ')'\n                })\n                .append(\"text\")\n                    .attr('transform','rotate(-60)')\n                    .attr('text-anchor','end')\n                    .attr('x',-tickLabelMargin)\n                    .text( function (d) { return (100- v); } )\n                    .classed('b-axis tick-text', true);\n    \n            axes.append('g')\n                .attr('transform',function(d){\n                    return 'translate(' + coord3[0] + ',' + coord3[1] + ')'\n                })\n                .append(\"text\")\n                    .text( function (d) { return v; } )\n                    .attr('x',tickLabelMargin)\n                    .classed('c-axis tick-text', true);\n */\n        })\n    }\n    \n    return {\n        init: init,\n        draw: draw,\n        getCoord: getCoord,\n        show: show,\n        hide: hide\n    }\n}\n\nconst ternaryPlot = ternaryGraph();\nexport default ternaryPlot;","\n// common config for the vega vizs\nexport const VEGA_CONFIG = {\n    title: {\n        fontFamily: 'Zilla Slab'\n    }\n};\n\nexport const DEPLOY_URL = '';\nexport const DEPLOY_FOLDER = '';","import React, { PureComponent } from 'react';\nimport * as vega from 'vega';\nimport * as _ from 'lodash';\nimport { VEGA_CONFIG } from '../constants';\nvar vegaTooltip = require('vega-tooltip/build/vega-tooltip');\n\n\n\nclass VegaChart extends PureComponent {\n\n    componentDidMount() {\n        this.renderVega();\n    }\n\n    componentDidUpdate() {\n        //this.renderVega();\n    }\n\n    renderVega() {\n        const {\n            spec,\n            data,\n            autoSize,\n            width,\n            height,\n            padding,\n            dataDefs,\n            signals,\n            signalListeners,\n            runAfterCallback,\n            onVegaViewCreated } = this.props;\n\n        // inject some dynamic settings to\n        // the vega specification\n        data && (spec.data[0].values = data);\n\n        // concat data definitions safely, by checking\n        // first if they already exist.\n        // If the data definition is not in the spec,\n        // just insert it. Otherwise if the data def\n        // already exists just override the values, so\n        // we mantain possible other attributes \n        // (transforms, etc...)\n        if(!_.isNil(dataDefs))\n            dataDefs.forEach( dataDef => {\n                \n                let dd = _.find(spec.data, d => d.name === dataDef.name);\n\n                if( _.isUndefined(dd) )\n                    spec.data.push(dataDef);\n                else\n                    dd.values = dataDef.values;\n            });\n\n        //spec.title && (spec.title.text = this.props.title);\n\n        // merging props and spec signals\n        if(signals) \n            spec.signals.map(s => s.value = (signals.find(x => x.name === s.name) || s).value)        \n\n        // vega specs have its 'autosize' property to 'fit' (automatically adjust\n        // the layout in an attempt to force the total visualization size to fit\n        // within the given width, height and padding values).\n        // When we have a restricted with, this is the property more suitable\n        spec.padding = padding || {\n            top: 20,\n            left: 15,\n            right: 15,\n            bottom: 20\n        };\n        spec.width      = width || this.node.getBoundingClientRect().width - spec.padding.left - spec.padding.right;\n        spec.autosize   = autoSize || 'fit';\n        spec.height     = height || 450;\n                    \n        /*console.log(\"Vega spec: \");\n        console.log(\n            JSON.stringify(spec)\n        );*/\n\n        // create the Vega view\n        let view = new vega.View(vega.parse(spec, VEGA_CONFIG || {}))\n            .renderer('svg')\n             .tooltip(\n                (new vegaTooltip.Handler({theme: 'dark'})).call\n            )\n            .initialize(this.node);\n\n        // Search for SPARQL data transform on any of the datasets.\n        // If found, then add a DataListener\n        /*spec.data.forEach( dataDef => {\n            dataDef.transform.forEach( dataTransform => {\n                if(dataTransform.type === 'sparql') {\n                    view.addDataListener(\n                        dataDef.name,\n                        (name, value) => {\n                            console.log(\"* * * * * \", value.length);\n                        }\n                    )\n                }\n            });\n        });*/\n        view.runAsync()\n            .then( () => {\n                // This code need to be run AFTER the view has rendered:\n                // signal listeners will be invoked when the signal value\n                // changes during pulse propagation (e.g., after runAsync\n                // is called, but before its returned Promise resolves).\n                // https://vega.github.io/vega/docs/api/view/#view_runAsync\n                signalListeners && signalListeners.forEach(listener => {\n                    view.addSignalListener(\n                        listener.name,\n                        (name, value) => { \n                            listener.handler(name, value, view)\n                        }\n                        );\n                });\n                // check if there is any callback to be invoked after\n                // the current dataflow evaluation completes\n                runAfterCallback && runAfterCallback(view);\n            });\n\n        // pass the created view\n        onVegaViewCreated && onVegaViewCreated(view);\n    }\n\n    refCallback = node => {\n        this.node = node;\n    }\n\n    render() {\n        return (\n            <div ref={this.refCallback} className={this.props.chartClass}></div>\n        )\n    }\n}\n\nexport default VegaChart;\n","export default class VegaSignalListener {\n    constructor(name, handler) {\n        this.name = name;\n        this.handler = handler;\n    }\n}","export var VegaSpecStripPlot = {\n  \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",  \n  \"padding\": {\"top\":0, \"right\":0, \"bottom\":0, \"left\": 0},\n  \"width\": 600,\n  \"height\": 25,\n  \"data\": [\n    {\n      \"name\": \"source_0\",\n      \"values\": [\n          {\"country\": \"Afghanistan\", \"total\": 3},\n          {\"country\": \"Algeria\", \"total\": 45},\n          {\"country\": \"Argentina\", \"total\": 208},\n          {\"country\": \"Armenia\", \"total\": 69},\n          {\"country\": \"Australia\", \"total\": 368},\n          {\"country\": \"Austria\", \"total\": 4646},\n          {\"country\": \"Azerbaijan\", \"total\": 40},\n          {\"country\": \"Bangladesh\", \"total\": 19},\n          {\"country\": \"Barbados\", \"total\": 2},\n          {\"country\": \"Belarus\", \"total\": 89},\n          {\"country\": \"Belgium\", \"total\": 7346},\n          {\"country\": \"Bolivia\", \"total\": 16},\n          {\"country\": \"Bosnia and Herzegovina\", \"total\": 77},\n          {\"country\": \"Botswana\", \"total\": 12},\n          {\"country\": \"Brazil\", \"total\": 286},\n          {\"country\": \"Bulgaria\", \"total\": 964},\n          {\"country\": \"Burkina Faso\", \"total\": 40},\n          {\"country\": \"Cameroon\", \"total\": 35},\n          {\"country\": \"Canada\", \"total\": 398},\n          {\"country\": \"Cape Verde\", \"total\": 19},\n          {\"country\": \"Chile\", \"total\": 131},\n          {\"country\": \"China\", \"total\": 459},\n          {\"country\": \"Colombia\", \"total\": 92},\n          {\"country\": \"Costa Rica\", \"total\": 37},\n          {\"country\": \"Croatia\", \"total\": 693},\n          {\"country\": \"Cyprus\", \"total\": 851},\n          {\"country\": \"Czech Republic\", \"total\": 2047},\n          {\"country\": \"DR Congo\", \"total\": 5},\n          {\"country\": \"Denmark\", \"total\": 4035},\n          {\"country\": \"Dominican Republic\", \"total\": 4},\n          {\"country\": \"Ecuador\", \"total\": 29},\n          {\"country\": \"Egypt\", \"total\": 138},\n          {\"country\": \"Estonia\", \"total\": 916},\n          {\"country\": \"Ethiopia\", \"total\": 48},\n          {\"country\": \"Fiji\", \"total\": 3},\n          {\"country\": \"Finland\", \"total\": 3313},\n          {\"country\": \"France\", \"total\": 12840},\n          {\"country\": \"Georgia\", \"total\": 92},\n          {\"country\": \"Germany\", \"total\": 15773},\n          {\"country\": \"Ghana\", \"total\": 65},\n          {\"country\": \"Greece\", \"total\": 2651},\n          {\"country\": \"Hong Kong\", \"total\": 35},\n          {\"country\": \"Hungary\", \"total\": 2000},\n          {\"country\": \"Iceland\", \"total\": 463},\n          {\"country\": \"India\", \"total\": 239},\n          {\"country\": \"Indonesia\", \"total\": 45},\n          {\"country\": \"Iran\", \"total\": 17},\n          {\"country\": \"Iraq\", \"total\": 4},\n          {\"country\": \"Ireland\", \"total\": 2945},\n          {\"country\": \"Israel\", \"total\": 2805},\n          {\"country\": \"Italy\", \"total\": 11730},\n          {\"country\": \"Japan\", \"total\": 215},\n          {\"country\": \"Jordan\", \"total\": 52},\n          {\"country\": \"Kazakhstan\", \"total\": 36},\n          {\"country\": \"Kenya\", \"total\": 117},\n          {\"country\": \"Kosovo\", \"total\": 14},\n          {\"country\": \"Kyrgyzstan\", \"total\": 17},\n          {\"country\": \"Latvia\", \"total\": 545},\n          {\"country\": \"Lebanon\", \"total\": 51},\n          {\"country\": \"Lesotho\", \"total\": 5},\n          {\"country\": \"Libya\", \"total\": 4},\n          {\"country\": \"Liechtenstein\", \"total\": 17},\n          {\"country\": \"Lithuania\", \"total\": 667},\n          {\"country\": \"Luxembourg\", \"total\": 578},\n          {\"country\": \"Macedonia\", \"total\": 145},\n          {\"country\": \"Madagascar\", \"total\": 11},\n          {\"country\": \"Mali\", \"total\": 19},\n          {\"country\": \"Malta\", \"total\": 291},\n          {\"country\": \"Mexico\", \"total\": 136},\n          {\"country\": \"Moldova\", \"total\": 91},\n          {\"country\": \"Montenegro\", \"total\": 53},\n          {\"country\": \"Morocco\", \"total\": 151},\n          {\"country\": \"Mozambique\", \"total\": 28},\n          {\"country\": \"Namibia\", \"total\": 19},\n          {\"country\": \"Nepal\", \"total\": 8},\n          {\"country\": \"Netherlands\", \"total\": 9325},\n          {\"country\": \"New Caledonia\", \"total\": 11},\n          {\"country\": \"New Zealand\", \"total\": 89},\n          {\"country\": \"Nigeria\", \"total\": 41},\n          {\"country\": \"Norway\", \"total\": 2816},\n          {\"country\": \"Pakistan\", \"total\": 16},\n          {\"country\": \"Palestine\", \"total\": 29},\n          {\"country\": \"Panama\", \"total\": 8},\n          {\"country\": \"Papua New Guinea\", \"total\": 4},\n          {\"country\": \"Peru\", \"total\": 45},\n          {\"country\": \"Philippines\", \"total\": 31},\n          {\"country\": \"Poland\", \"total\": 3008},\n          {\"country\": \"Portugal\", \"total\": 3328},\n          {\"country\": \"Romania\", \"total\": 1553},\n          {\"country\": \"Russia\", \"total\": 498},\n          {\"country\": \"Rwanda\", \"total\": 13},\n          {\"country\": \"Senegal\", \"total\": 69},\n          {\"country\": \"Serbia\", \"total\": 505},\n          {\"country\": \"Singapore\", \"total\": 45},\n          {\"country\": \"Slovakia\", \"total\": 752},\n          {\"country\": \"Slovenia\", \"total\": 1418},\n          {\"country\": \"Somalia\", \"total\": 2},\n          {\"country\": \"South Africa\", \"total\": 333},\n          {\"country\": \"South Korea\", \"total\": 112},\n          {\"country\": \"Spain\", \"total\": 12537},\n          {\"country\": \"Sri Lanka\", \"total\": 13},\n          {\"country\": \"Sudan\", \"total\": 8},\n          {\"country\": \"Sweden\", \"total\": 5479},\n          {\"country\": \"Switzerland\", \"total\": 5888},\n          {\"country\": \"Syria\", \"total\": 9},\n          {\"country\": \"Taiwan\", \"total\": 74},\n          {\"country\": \"Tajikistan\", \"total\": 9},\n          {\"country\": \"Tanzania\", \"total\": 61},\n          {\"country\": \"Thailand\", \"total\": 66},\n          {\"country\": \"Tunisia\", \"total\": 136},\n          {\"country\": \"Turkey\", \"total\": 1548},\n          {\"country\": \"Uganda\", \"total\": 66},\n          {\"country\": \"Ukraine\", \"total\": 312},\n          {\"country\": \"United Kingdom\", \"total\": 10752},\n          {\"country\": \"United States\", \"total\": 1447},\n          {\"country\": \"Uruguay\", \"total\": 50},\n          {\"country\": \"Venezuela\", \"total\": 11},\n          {\"country\": \"Vietnam\", \"total\": 64},\n          {\"country\": \"Zambia\", \"total\": 15},\n          {\"country\": \"Albania\", \"total\": 52},\n          {\"country\": \"Guatemala\", \"total\": 8},\n          {\"country\": \"Guinea\", \"total\": 1},\n          {\"country\": \"Ivory Coast\", \"total\": 9},\n          {\"country\": \"Laos\", \"total\": 8},\n          {\"country\": \"Malawi\", \"total\": 23},\n          {\"country\": \"Malaysia\", \"total\": 54},\n          {\"country\": \"Nicaragua\", \"total\": 5},\n          {\"country\": \"Niger\", \"total\": 11},\n          {\"country\": \"Swaziland\", \"total\": 5},\n          {\"country\": \"Uzbekistan\", \"total\": 18},\n          {\"country\": \"Benin\", \"total\": 16},\n          {\"country\": \"Cambodia\", \"total\": 11},\n          {\"country\": \"Faroe Islands\", \"total\": 36},\n          {\"country\": \"French Polynesia\", \"total\": 5},\n          {\"country\": \"Greenland\", \"total\": 17},\n          {\"country\": \"Guyana\", \"total\": 3},\n          {\"country\": \"Liberia\", \"total\": 1},\n          {\"country\": \"Marshall Islands\", \"total\": 1},\n          {\"country\": \"Mauritius\", \"total\": 8},\n          {\"country\": \"Monaco\", \"total\": 6},\n          {\"country\": \"Mongolia\", \"total\": 3},\n          {\"country\": \"Samoa\", \"total\": 1},\n          {\"country\": \"Saudi Arabia\", \"total\": 11},\n          {\"country\": \"São Tomé and Príncipe\", \"total\": 1},\n          {\"country\": \"Togo\", \"total\": 4},\n          {\"country\": \"United Arab Emirates\", \"total\": 8},\n          {\"country\": \"Vanuatu\", \"total\": 1},\n          {\"country\": \"Angola\", \"total\": 4},\n          {\"country\": \"Anguilla\", \"total\": 4},\n          {\"country\": \"Central African Republic\", \"total\": 2},\n          {\"country\": \"Cuba\", \"total\": 20},\n          {\"country\": \"Curaçao\", \"total\": 2},\n          {\"country\": \"Gabon\", \"total\": 7},\n          {\"country\": \"Honduras\", \"total\": 4},\n          {\"country\": \"Jamaica\", \"total\": 12},\n          {\"country\": \"Maldives\", \"total\": 2},\n          {\"country\": \"Mauritania\", \"total\": 2},\n          {\"country\": \"Republic of the Congo\", \"total\": 3},\n          {\"country\": \"Trinidad and Tobago\", \"total\": 2},\n          {\"country\": \"Seychelles\", \"total\": 3},\n          {\"country\": \"Macau\", \"total\": 2},\n          {\"country\": \"Qatar\", \"total\": 5},\n          {\"country\": \"Turkmenistan\", \"total\": 5},\n          {\"country\": \"El Salvador\", \"total\": 1},\n          {\"country\": \"Gambia\", \"total\": 1},\n          {\"country\": \"Guinea-Bissau\", \"total\": 1},\n          {\"country\": \"Paraguay\", \"total\": 4},\n          {\"country\": \"Sierra Leone\", \"total\": 2},\n          {\"country\": \"United States Minor Outlying Islands\", \"total\": 2},\n          {\"country\": \"Oman\", \"total\": 3},\n          {\"country\": \"BES islands\", \"total\": 1},\n          {\"country\": \"Gibraltar\", \"total\": 7},\n          {\"country\": \"Jersey\", \"total\": 1},\n          {\"country\": \"San Marino\", \"total\": 1},\n          {\"country\": \"Burundi\", \"total\": 5}\n      ],\n      \"transform\": [\n        {\n          \"type\": \"extent\",\n          \"field\": \"total\",\n          \"signal\": \"extent\"\n        }\n      ]\n    }\n  ],\n  \"signals\": [\n    {\"name\": \"tickValues\", \"value\": [1, 50, 100, 500, 1000, 5000, 10000, 15000, 20000]},\n    {\"name\": \"height\", \"update\": \"height\"},\n    {\n      \"name\": \"initialBrush\",\n      \"value\": null,\n      \"update\": \"!isValid(initialBrush)? initialBrush : inrange(initialBrush, [tickValues[0], tickValues[2]])? [tickValues[0], tickValues[2]] : inrange(initialBrush, [tickValues[2], tickValues[4]])? [tickValues[2], tickValues[4]] : [tickValues[4], tickValues[8]-2000]\"\n    },\n    {\n          \"name\": \"brush\", \n          \"value\": 0,\n          \"update\": \"!isValid(initialBrush)? 0 : [scale('x',initialBrush[0]), scale('x', initialBrush[1])]\",\n          \"on\": [\n            {\n              \"events\": \"@distBrush:mousedown\",\n              \"update\": \"[x(), x()]\"\n            },\n            {\n              \"events\": \"[@distBrush:mousedown, window:mouseup] > window:mousemove!\",\n              \"update\": \"[brush[0], clamp(x(), 0, width)]\"\n            },\n            {\n              \"description\": \"to drag the current brush\",\n              \"events\": {\"signal\": \"delta\"},\n              \"update\": \"clampRange([anchor[0] + delta, anchor[1] + delta], 0, width)\"\n            }\n          ]\n        },\n        {\n          \"name\": \"anchor\", \"value\": null,\n          \"on\": [{\"events\": \"@brush:mousedown\", \"update\": \"slice(brush)\"}]\n        },\n        {\n          \"name\": \"xdown\", \"value\": 0,\n          \"on\": [{\"events\": \"@brush:mousedown\", \"update\": \"x()\"}]\n        },\n        {\n          \"name\": \"delta\", \"value\": 0,\n          \"on\": [\n            {\n              \"events\": \"[@brush:mousedown, window:mouseup] > window:mousemove!\",\n              \"update\": \"x() - xdown\"\n            }\n          ]\n        },\n        {\n          \"name\": \"detailDomain\",\n          \"update\": \"span(brush) ? invert('x', brush) : null\",\n          \"on\": [\n            {\n              \"events\": {\"signal\": \"brush\"},\n              \"update\": \"span(brush) ? invert('x', brush) : null\"\n            }\n          ]\n        }\n  ],\n  \"scales\": [\n    {\n      \"name\": \"x\",\n      \"type\": \"pow\",\n      \"exponent\": 0.05 ,      \n      \"domain\": [1, {\"signal\": \"extent[1]\"}],\n      \"range\": \"width\",\n      \"nice\": false,\n      \"zero\": false\n    }\n  ],\n  \"axes\": [\n    {\n      \"scale\": \"x\",\n      \"domain\": false,\n      \"ticks\": true,\n      \"orient\": \"bottom\",\n      \"grid\": false,\n      \"title\": \"Country distribution by number of R&I projects\",\n      \"titlePadding\": 10,\n      \"labelFlush\": true,\n      \"labelOverlap\": true,\n      \"values\": {\"signal\": \"tickValues\"},\n      \"zindex\": 0\n    }\n  ],\n  \"marks\": [\n    {\n      \"type\": \"rect\",\n      \"name\": \"texture\",\n      \"interactive\": false,\n      \"encode\": {\n        \"enter\": {\n          \"y\": {\"value\": 0},\n          \"height\": {\"signal\": \"height\"},\n          \"fill\": {\"value\": \"#333\"},\n          \"fillOpacity\": {\"value\": 0.7}\n        },\n        \"update\": {\n          \"x\": {\"signal\": \"brush[0]\"},\n          \"x2\": {\"signal\": \"brush[1]\"}\n        }\n      }\n    },\n    {\n      \"type\": \"rect\",\n      \"name\": \"distBrush\",\n      \"encode\": {\n        \"enter\": {\n          \"y\": {\"value\": 0},\n          \"height\": {\"signal\": \"height\"},\n          \"width\": {\"signal\": \"width\"},\n          \"fill\": {\"value\": \"#19486A\"},\n          \"fillOpacity\": {\"value\": 0.03}\n        }\n      }\n    },\n    {\n      \"name\": \"marks\",\n      \"interactive\": false,\n      \"type\": \"rect\",\n      \"from\": {\"data\": \"source_0\"},\n      \"encode\": {\n        \"enter\": {\n          \"tooltip\": {\"signal\": \"datum\"},          \n          \"xc\": {\"scale\": \"x\", \"field\": \"total\"},\n          \"y\": { \"value\": 0 },\n          \"height\": {\"signal\": \"height\"}        \n        },\n        \"update\": {\n          \"width\": {\n            \"signal\": \"!isValid(detailDomain)? 1 : (inrange(datum.total, detailDomain)? 2 : 1)\"\n          },\n          \"fill\": {\n            \"signal\": \"!isValid(detailDomain)? '#19486A' : (inrange(datum.total, detailDomain)? '#fa8072' : '#19486A')\"\n          },\n          \"opacity\": {\n            \"signal\": \"!isValid(detailDomain)? 0.35 : (inrange(datum.total, detailDomain)? 0.75 : 0.35)\"\n          }\n        }\n      }\n    },\n    {\n      \"type\": \"rect\",\n      \"name\": \"brush\",\n      \"encode\": {\n        \"enter\": {\n          \"y\": {\"value\": 0},\n          \"height\": {\"signal\": \"height\"},\n          \"fill\": {\"value\": \"#333\"},\n          \"fillOpacity\": {\"value\": 0}\n        },\n        \"update\": {\n          \"x\": {\"signal\": \"brush[0]\"},\n          \"x2\": {\"signal\": \"brush[1]\"}\n        }\n      }\n    },\n    {\n      \"type\": \"rect\",\n      \"interactive\": false,\n      \"encode\": {\n        \"enter\": {\n          \"y\": {\"value\": -4},\n          \"height\": {\"signal\": \"height + 8\"},\n          \"width\": {\"value\": 4},\n          \"fill\": {\"value\": \"#19486A\"},\n        },\n        \"update\": {\n          \"x\": {\"signal\": \"brush[0]\"},\n          \"fillOpacity\": { \"signal\": \"isValid(detailDomain)? 0.8:0\"}\n        }\n      }\n    },\n    {\n      \"type\": \"rect\",\n      \"interactive\": false,\n      \"encode\": {\n        \"enter\": {\n          \"y\": {\"value\": -4},\n          \"height\": {\"signal\": \"height + 8\"},\n          \"width\": {\"value\": 4},\n          \"fill\": {\"value\": \"#19486A\"}\n        },\n        \"update\": {\n          \"x\": {\"signal\": \"brush[1]\"},\n          \"fillOpacity\": { \"signal\": \"isValid(detailDomain)? 0.8:0\"}\n        }\n      }\n    }\n  ]  \n};","import * as d3 from 'd3';\nexport const fisheye = (function(){\n    const fisheye = {\n        scale: function(scaleType) {\n          return d3_fisheye_scale(scaleType(), 0.5, 0);\n        },\n        circular: function() {\n          var radius = 200,\n              distortion = 2,\n              k0,\n              k1,\n              focus = [0, 0];\n    \n          function fisheye(d) {\n            var dx = d.x - focus[0],\n                dy = d.y - focus[1],\n                dd = Math.sqrt(dx * dx + dy * dy);\n            if (!dd || dd >= radius) return {x: d.x, y: d.y, z: dd >= radius ? 1 : 10};\n            var k = k0 * (1 - Math.exp(-dd * k1)) / dd * .75 + .25;\n            return {x: focus[0] + dx * k, y: focus[1] + dy * k, z: Math.min(k, 10)};\n          }\n    \n          function rescale() {\n            k0 = Math.exp(distortion);\n            k0 = k0 / (k0 - 1) * radius;\n            k1 = distortion / radius;\n            return fisheye;\n          }\n    \n          fisheye.radius = function(_) {\n            if (!arguments.length) return radius;\n            radius = +_;\n            return rescale();\n          };\n    \n          fisheye.distortion = function(_) {\n            if (!arguments.length) return distortion;\n            distortion = +_;\n            return rescale();\n          };\n    \n          fisheye.focus = function(_) {\n            if (!arguments.length) return focus;\n            focus = _;\n            return fisheye;\n          };\n    \n          return rescale();\n        }\n      };\n    \n      function rebind(target, source) {\n        var d3_rebind = (target, source, method) => {\n            return function() {\n              var value = method.apply(source, arguments);\n              return value === source ? target : value;\n            };\n          }\n\n        var i = 1, n = arguments.length, method;\n        while (++i < n) target[method = arguments[i]] = d3_rebind(target, source, source[method]);\n        return target;\n      };\n\n      function d3_fisheye_scale(scale, d, a) {\n    \n        function fisheye(_) {\n          var x = scale(_),\n              left = x < a,\n              range = d3.extent(scale.range()),\n              min = range[0],\n              max = range[1],\n              m = left ? a - min : max - a;\n          if (m === 0) m = max - min;\n          return (left ? -1 : 1) * m * (d + 1) / (d + (m / Math.abs(x - a))) + a;\n        }\n    \n        fisheye.distortion = function(_) {\n          if (!arguments.length) return d;\n          d = +_;\n          return fisheye;\n        };\n    \n        fisheye.focus = function(_) {\n          if (!arguments.length) return a;\n          a = +_;\n          return fisheye;\n        };\n    \n        fisheye.copy = function() {\n          return d3_fisheye_scale(scale.copy(), d, a);\n        };\n    \n        // fisheye.nice = scale.nice;\n        // fisheye.ticks = scale.ticks;\n        // fisheye.tickFormat = scale.tickFormat;\n        return rebind(fisheye, scale, \"domain\", \"range\");\n      }\n      \n      return fisheye      \n})();","import React, { Component } from 'react';\nimport * as d3 from \"d3\";\nimport * as _ from 'lodash';\nimport Select from 'react-select';\nimport { IoIosAddCircle } from \"react-icons/io\";\nimport {\n    SDG_INFO,\n    SELECTED_COUNTRIES,\n    REFS,\n    EMPTY_OBJECT,\n    IS_STATIC,\n    setAverageBySDGPillars,\n    CONTINENT_COLORS\n} from '../../common';\n\nimport related_countries_data from '../../data/flower/country_similarity.json'\nimport sdg_by_country_data from '../../data/flower/3-SDGs_by_country.json'\nimport CountryPlotGenerator from '../../components/CountryPlotGenerator'\n\nimport tsnePlot from '../../components/tsne/tsnePlot';\nimport {\n    getStaticPositions,\n    pickPlotsForStaticLayout,\n    getCountryHoverListener,\n    showStaticPlaceholders\n} from './countriesLayoutUtils';\nimport { decidePhase, STATIC, TSNE, TERNARY } from './statemachine';\nimport ternaryPlot from '../../components/ternayPlot/TernaryPlot';\nimport VegaChart from '../../common/vega/VegaChart';\nimport VegaSignalListener from '../../common/vega/VegaSignalListener';\nimport { VegaSpecStripPlot } from '../../common/vega/specifications/VegaSpecStripPlot';\nimport textures from 'textures';\nimport { fisheye } from '../../common/fisheye';\nimport * as d3Legend from 'd3-svg-legend';\n\nconst initialCountry = 'Spain';\nconst countrySelectOptions = _(sdg_by_country_data)\n    .uniqBy('countryName')\n    .sortBy('countryName')\n    .map(o => { return {label: o.countryName};})\n    .value()\n\n\nclass CountryPlots extends Component {\n\n    constructor() {\n        super();\n        this.state = {\n            mockData: [],\n            // all the country plots\n            plots: [],\n            // country plots being show in the STATIC phase\n            staticPlots: [],\n            phase: 'unset',\n            ternaryPlot: ternaryPlot\n\n        };\n        this.handleOpenCountry = this.handleOpenCountry.bind(this);\n\n        // state not trackable\n        this.initialBrushSignal = undefined;\n        this.selectedOption = null;\n        this.brushDomain = null;\n        this.vegaView = undefined;\n        this.tinyCountryPlot = undefined;\n    }\n\n\n    /**\n     * Show and place the indicated plots in the\n     * static positions of the layout. By convention\n     * the first plot goes to the position of the \n     * selected plot and the rest in the positions\n     * of 'similar' plots\n     * @param {*} plots \n     */\n    showStaticPlots(_plots) {\n        // if no plots, take the ones in the state\n        const plots = _plots || this.state.staticPlots,\n            layout = this.state.fixedLayoutData;\n\n        // move first plot to primary position\n        _.first(plots)\n            .moveTo(\n                layout[REFS.PRIMARY_COUNTRY].x,\n                layout[REFS.PRIMARY_COUNTRY].y\n            )\n            .setPlaceholderInfo(layout[REFS.PRIMARY_COUNTRY]);\n        // move the rest of plots to secondary positions\n        _.tail(plots)\n            .forEach((plot, i) => {\n                plot.moveTo(\n                    layout[REFS['SECONDARY_COUNTRY_' + i]].x,\n                    layout[REFS['SECONDARY_COUNTRY_' + i]].y\n                )\n                .setPlaceholderInfo(layout[REFS['SECONDARY_COUNTRY_' + i]]);\n            });\n\n        // change its state to unfold and visible\n        plots.forEach(plot => {\n            plot.fold(false);\n            plot.show();\n        });\n\n        // update the signal of the initial brush on the vega view,\n        // so we preselect a range of projects around the \n        // totalCountryProjects of the selected country\n        this.initialBrushSignal = _.find(\n            VegaSpecStripPlot.signals,\n            signal => signal.name === 'initialBrush'\n        );\n\n        if (!_.isUndefined(this.initialBrushSignal)) {\n            this.vegaView.signal(\n                this.initialBrushSignal.name,\n                _.first(plots).data[0].totalProjectsCountry\n            );\n            this.vegaView.runAsync();\n        }\n    }\n\n    // optimize when to re-render (basically never!)\n    shouldComponentUpdate(nextProps) {\n        // just update the state machine and do stuff, \n        // but DO NOT render again\n        if (this.props.step !== nextProps.step)\n            this.updateState(nextProps.step)\n        return false;\n    };\n\n    updateControls(phase) {\n        if (phase === STATIC) {\n            this.refs['strip-plot'].style.display = 'none'\n            this.refs['country-selector'].style.display = 'block';\n            if (!this.props.isMobile) {\n                this.refs['show-modal-btn'].style.display = 'block'\n            }\n        } else {\n            this.refs['strip-plot'].style.display = 'block'\n            this.refs['country-selector'].style.display = 'none';\n            if (!this.props.isMobile) {\n                this.refs['show-modal-btn'].style.display = 'none';\n            }\n        }\n    }\n\n    createTinyCountry(label, id, data, countryVariable, ghostVariable, sortingVariable) {\n        d3.select('.svg-placeholder-countries').append(\"foreignObject\").classed(\"chart-box\", true)\n            .attr(\"x\", document.querySelector('.static-plots-container').offsetWidth - 200)\n            .attr(\"y\", 0)\n            .attr(\"width\", 200)\n            .attr(\"height\", 250)\n            .append(\"xhtml:div\")\n            .classed(\"chart-box_decorated\", true)\n\n        this.tinyCountryPlot = new CountryPlotGenerator(\n            '.svg-placeholder-countries',\n            label,\n            id + '-hovered',\n            {\n                width: 300,\n                height: 300,\n                x: document.querySelector('.static-plots-container').offsetWidth - 100,\n                y: 150\n            },\n            data,\n            countryVariable,\n            ghostVariable,\n            sortingVariable\n        );\n        this.tinyCountryPlot.fold(false);\n        this.tinyCountryPlot.show();\n    };\n\n    destroyTinyCountry() {\n        d3.select('.svg-placeholder-countries')\n            .select('#' + this.tinyCountryPlot.id)\n            .remove();\n        d3.selectAll('.chart-box').remove()\n    }\n\n    createFishEye(phase) {\n        var self = this;\n\n        this.fisheye = fisheye.circular()\n            .radius(100)\n            \n        var svg = d3.select('.svg-placeholder-countries');\n\n        const width = svg.attr(\"width\"),\n            height = svg.attr(\"height\");\n\n        var dotGroups = svg.selectAll('.country-placeholder');\n\n        var distortionScale = d3.scaleQuantize()\n                .domain([0, 90, 1000])\n                .range([3, 2, 1])                    \n\n        svg.on(\"mousemove\", function () {\n            \n            let distance = Math.hypot(d3.mouse(this)[0]-width*0.5, d3.mouse(this)[1]-height*0.75)\n            self.fisheye.focus(d3.mouse(this));\n            self.fisheye.distortion(distortionScale(distance))\n\n\n            dotGroups.each(function (d) {\n                d.fisheye = self.fisheye(d.ternaryCoords);\n                d3.select(this)\n                    .select('.dotGroup')\n                    .attr('transform', 'scale(1)');\n            })\n                .attr(\"x\", function (d) { return d.fisheye.x; })\n                .attr(\"y\", function (d) { return d.fisheye.y; });\n        })\n            .on('mouseleave', function () {\n                dotGroups\n                    .attr(\"x\", function (d) { return d.ternaryCoords.x; })\n                    .attr(\"y\", function (d) { return d.ternaryCoords.y; });\n            });\n    }\n\n\n\n    createLegendContinents() {\n        var svg = d3.select('.svg-placeholder-countries');\n        var ordinal = d3.scaleOrdinal()\n            .domain(_.keys(CONTINENT_COLORS))\n            .range(_.values(CONTINENT_COLORS));\n        svg.append(\"g\")\n            .attr(\"class\", \"legendOrdinal\")\n            .attr(\"transform\", \"translate(5, 15)\");\n        var legendOrdinal = d3Legend.legendColor()\n            .shape(\"circle\")\n            .shapeRadius(4)\n            .shapePadding(3)            \n            .scale(ordinal);\n          \n          svg.select(\".legendOrdinal\")\n            .call(legendOrdinal);\n    }\n\n\n\n    destroyLegendContinents() {\n        d3.select('.svg-placeholder-countries')\n            .select('g.legendOrdinal').remove();\n    }\n\n\n\n    createCartesian(phase) {\n\n        var svg = d3.select('.svg-placeholder-countries')\n\n        const width = svg.attr(\"width\"),\n            height = svg.attr(\"height\");\n\n        const xFisheye = fisheye.scale(d3.scaleIdentity).domain([0, width]).focus(0),\n            yFisheye = fisheye.scale(d3.scaleIdentity).domain([0, height]).focus(0);\n\n        var dotGroups = svg.selectAll('.country-placeholder');\n\n        svg.on(\"mousemove\", function () {\n            const mouse = d3.mouse(this);\n            xFisheye.focus(mouse[0]);\n            yFisheye.focus(mouse[1]);\n            dotGroups.each(function (d) {\n                d.xFisheye = xFisheye(d.svgCoords.x);\n                d.yFisheye = yFisheye(d.svgCoords.y);\n            })\n                .attr(\"x\", function (d) { return d.xFisheye; })\n                .attr(\"y\", function (d) { return d.yFisheye; });\n        })\n            .on('mouseleave', function () {\n                dotGroups\n                    .attr(\"x\", function (d) { return d.svgCoords.x; })\n                    .attr(\"y\", function (d) { return d.svgCoords.y; });\n            });\n    }\n\n    destroyFishEye() {\n        this.fisheye = undefined;\n        d3.select('.svg-placeholder-countries').on('mousemove', null);\n    }\n\n    destroyCartesian() {\n        this.fisheye = undefined;\n        d3.select('.svg-placeholder-countries').on('mousemove', null);\n        d3.select('.svg-placeholder-countries').on('mouseleave', null);\n    }\n\n\n    /**\n     * \n     */\n    updateState(step) {\n        const { countryVariable, ghostVariable, sortingVariable, isMobile } = this.props;\n        const self = this;\n        // check active step of the article to define the\n        // phase of the storytelling we head to, so we\n        // decide whether we go forward or backward\n        const phase = decidePhase(step)\n\n        // check whether we have to update the phase,\n        // so we have to do something with the stuff\n        if (phase !== this.state.phase) {\n\n            // decide what we have to do base\n            // on the new phase\n            this.updateControls(phase);\n            switch (phase) {\n                default: break;\n                case STATIC:\n                    // this.destroyFishEye();\n                    this.destroyCartesian();\n                    this.destroyLegendContinents();\n\n                    // where I'm coming from?\n                    if (this.state.phase === TSNE) {\n                        // show the DOM placeholders for static plots\n                        \n                        showStaticPlaceholders();\n\n                        //const layout = this.state.fixedLayoutData;\n\n                        // clear static plots from brushing\n                        _.each(this.state.plots, p => p.select(true))\n                        this.showStaticPlots();\n                        /*\n                        // move first plot to primary position\n                        _.first(this.state.staticPlots)\n                            .fromTsne(IS_STATIC, layout[REFS.PRIMARY_COUNTRY]);\n\n                        // move the rest of plots to secondary positions\n                        _.tail(this.state.staticPlots)\n                            .forEach((plot, i) => {\n                                plot.fromTsne(IS_STATIC, layout[REFS['SECONDARY_COUNTRY_' + i]]);\n                            });*/\n\n                        _.differenceBy(\n                            this.state.plots,\n                            this.state.staticPlots,\n                            'label'\n                        ).forEach(plot => {\n                            plot.fromTsne(!IS_STATIC);\n                        })\n\n                    }\n                    else {\n                        let plots = [];\n                        // load the file with the data\n                        // to be used for the t-sne\n                        tsnePlot.loadData()\n                            .then(function (data) {\n\n                                // once the t-sne has calculated the positions,\n                                // compute these positions according our svg space\n                                tsnePlot.tsneCoordsToSVGCoords('.svg-placeholder-countries');\n\n                                // tsnePlot.loadData returns data\n                                // of the country with the coords\n                                // of the t-sne. Link this data\n                                // with our general dataset\n                                let countries = self.state.mockData;\n                                data.forEach(d => {\n                                    countries[d.countryName].tsneCoords = d.tsneCoords\n                                    countries[d.countryName].svgCoords = d.svgCoords\n                                });\n\n                                // add data in the country about total number\n                                // of projects classified in SDGs                                \n                                _.each(_.keys(countries), k => {\n                                    countries[k].numProjectsSDG = _.sumBy(countries[k], 'numProjectsSDG')\n                                });\n\n                                // create a scale for the radius and label of the dots\n                                // map arbitrary subsets of the domain to discrete values in the range\n                                var radiusScale = d3.scaleLinear()\n                                    .domain([1, 50, 100, 500, 1000, 5000, 10000])\n                                    .range([3, 4, 5, 6, 7, 8, 11]);\n                                var labelTextScale = d3.scaleLinear()\n                                    .domain([1, 50, 100, 500, 1000, 5000, 10000])\n                                    .range([7, 8, 10, 10, 12, 12, 14]);\n\n                                // inject the radius for each country\n                                _.each(_.keys(countries), k => {\n                                    countries[k].dotRadius    = radiusScale(countries[k].numProjectsSDG);\n                                    countries[k].dotLabelSize = labelTextScale(countries[k].numProjectsSDG);\n                                });\n\n                                // create all the countries\n                                _.keys(countries).forEach(countryLabel => {\n                                    plots.push(\n                                        new CountryPlotGenerator(\n                                            '.svg-placeholder-countries',\n                                            countryLabel,\n                                            countryLabel.toLowerCase().replace(/\\s/g, ''),\n                                            undefined,\n                                            countries[countryLabel],\n                                            countryVariable,\n                                            ghostVariable,\n                                            sortingVariable,\n                                            // add callbacks\n                                            [self.createTinyCountry, self.destroyTinyCountry, self.handleOpenCountry]\n                                        )\n                                    );\n                                });\n\n                                let staticPlots = pickPlotsForStaticLayout(plots, self.selectedOption, isMobile);\n                                self.showStaticPlots(staticPlots);\n                                // save country plots\n                                self.setState({\n                                    plots: plots,\n                                    staticPlots: staticPlots\n                                });\n                            });\n                    }\n                    break;\n\n                case TSNE:\n                    // just hide the ternary plot\n                    this.state.ternaryPlot.hide();\n                    this.destroyFishEye();\n                    this.createCartesian(phase);\n                    this.createLegendContinents();\n\n                    // where I'm coming from?\n                    if (this.state.phase === STATIC) {\n                        // hide the DOM placeholders for static plots\n                        showStaticPlaceholders(false);\n\n                        // current static plots: to dot\n                        // and move to your tsne position\n                        _.each(this.state.staticPlots, (plot, i) => plot.toTsne(IS_STATIC, i));\n\n                        // rest of plots: show dot at its position already\n                        _.differenceBy(\n                            this.state.plots,\n                            this.state.staticPlots,\n                            'label'\n                        ).forEach((plot, i) => {\n                            plot.moveTo(\n                                plot.data.svgCoords[0],\n                                plot.data.svgCoords[1]\n                            );\n                            plot.toTsne(!IS_STATIC, i);\n                        })\n\n                        // update brushed countries\n                        this.brushCountries();\n\n                    }\n                    else if (this.state.phase === TERNARY)\n                        _.each(this.state.plots, (plot, i) => plot.fromTernary(i));\n                    break;\n\n                case TERNARY:\n                    this.destroyCartesian();\n                    this.createFishEye(phase);\n\n                    // show the ternary plot\n                    this.state.ternaryPlot.show();\n                    // here we always come from tsne\n                    _.each(this.state.plots, (plot, i) => plot.toTernary(i));\n                    break;\n            }\n\n            // update the phase on the react state\n            this.setState({\n                phase: phase\n            });\n        }\n        else {\n            // consider also some changes\n            // in the step within the same\n            // phase\n            if (step === 5) {\n                // reseting the brush is not working...\n                this.vegaView.signal(this.initialBrushSignal.name, null);\n                this.vegaView.runAsync();\n                // vega view signal listener will\n                // get the update and clear the \n                // dots, so wait a bit to select ours\n                setTimeout(() => {\n                    let countriesHighlighted = ['Germany', 'France', 'United Kingdom', 'Italy', 'Netherlands', 'Spain']\n                    _.each(\n                        this.state.plots,\n                        p => {\n                            p.select(_.indexOf(countriesHighlighted, p.label) !== -1)\n                        }\n                    );\n                }, 200);\n            }\n            else if (step === 6) {\n                this.vegaView.signal(\n                    this.initialBrushSignal.name,\n                    500\n                );\n                this.vegaView.runAsync();\n            }\n            else if (step === 7) {\n                this.vegaView.signal(\n                    this.initialBrushSignal.name,\n                    50\n                );\n                this.vegaView.runAsync();\n            }\n        }\n    }\n\n    componentDidMount() {\n        // size the svg according our main container\n        d3.select('.svg-placeholder-countries')\n            .attr('width', this.refs.container.offsetWidth)\n            .attr('height', this.refs.container.offsetHeight);\n\n        //init the ternary plot\n        this.state.ternaryPlot.init('.svg-placeholder-countries');\n        this.state.ternaryPlot.draw();\n\n        // we have node references of our countries, as follows:\n        // primary-country, secondary-country-0, secondary-country-1\n        // secondary-country-2 and secondary-country-3.\n        // get the dimensions in order to calculate the final position\n        // of the countries in the svg. Layout is:\n        //  |  Primary  |   1   |   2   |\n        //  |           |       |       |\n        //  |  Country  |   3   |   4   |\n        // and over this layout there is the <svg> with the same\n        // dimensions as the div containing this layout\n        const fixedLayoutData = getStaticPositions(this.refs);\n\n        // add a listener to know which placeholder to highlight\n        // Not possible via css or mouse events as we are overlapping\n        // the placholders and the <svg>s     \n        !this.props.isMobile && getCountryHoverListener(this, fixedLayoutData, REFS);\n\n        // Sorting data by size value to help on dots mouseover\n        sdg_by_country_data.sort((a, b) => parseFloat(b.totalProjectsCountry) - parseFloat(a.totalProjectsCountry));\n\n        const countries = _.mapValues(\n            _.groupBy(sdg_by_country_data, 'countryName'),\n            clist => clist.map(country => _.omit(country, 'countryName'))\n        )\n\n        const allSDGs = _.keys(SDG_INFO);\n        let control = 0;\n        let globalSDGValues = [];\n        _.keys(countries).forEach(k => {\n            let country = countries[k];\n\n            if (control === 0 && country.length === 16) {\n                control = 1;\n                country.forEach(SDG => {\n                    globalSDGValues.push(\n                        {\n                            name: SDG.SDG,\n                            p_totalNumCORDIS: SDG.p_totalNumCORDIS,\n                            p_totalFundingCORDIS: SDG.p_totalFundingCORDIS\n                        }\n                    )\n                });\n            }\n\n            // the countries may not have data about\n            // all SDGs. Inject empty SDG data obj\n            // for each SDG not present\n            let mySDGs = _.map(country, 'SDG');\n            _.difference(allSDGs, mySDGs)\n                .forEach(missingSDG => {\n                    // for each sdg not found in the country\n                    // add an empty data SDG object\n                    country.push(\n                        _.merge(_.clone(EMPTY_OBJECT), { SDG: missingSDG })\n                    );\n                });\n\n            // now country has all SDGs. Add some more properties\n            // regards the SDGs (short titles, ordering, etc...)\n            _.each(country, sdg => {\n                sdg.sorting = SDG_INFO[sdg.SDG].order;\n                sdg.shortTitle = SDG_INFO[sdg.SDG].shortTitle;\n                sdg.ghostProjectsValue = _.find(globalSDGValues, function (o) { return o.name === sdg.SDG; });\n            });\n            // and sort SDGs\n            country.sort((a, b) => (a.sorting > b.sorting) ? 1 : ((b.sorting > a.sorting) ? -1 : 0));\n        });\n\n        // get averages by SDG groups (economy, society, biosphere)\n        setAverageBySDGPillars(countries);\n\n        // get coordinates of each country\n        // in the ternary plot\n        _.keys(countries).forEach(\n            k => countries[k].ternaryCoords = ternaryPlot.getCoord(countries[k])\n        );\n\n        // define initial state\n        this.selectedOption = {\n            label: initialCountry,\n            related: this.getRelatedCountries({ label: initialCountry })\n        };\n\n        this.setState({\n            mockData: countries,\n            fixedLayoutData: fixedLayoutData\n        });\n\n        // set initial state in the state machine\n        this.updateState(this.props.step)\n    }\n\n    /**\n     * Get 4 most similar countries of the selectedOption\n     *\n     */\n    getRelatedCountries = (selectedOption) => {\n        return _.take(related_countries_data[selectedOption.label], 4)\n            .map(o => { return { label: o }; });\n    }\n\n    handleChange = selectedOption => {\n        const { plots, staticPlots } = this.state;\n        const newOption = {\n            label: selectedOption.label,\n            related: this.props.isMobile ? [] : this.getRelatedCountries(selectedOption)\n        };\n\n        // hide current static plots\n        staticPlots.forEach(plot => plot.show(false));\n\n        const newStaticPlots = pickPlotsForStaticLayout(plots, newOption);\n        this.showStaticPlots(newStaticPlots);\n\n        this.selectedOption = newOption;\n        this.setState({\n            staticPlots: newStaticPlots\n        });\n    };\n\n    /**\n     * \n     */\n    brushCountries() {\n        if (_.isNull(this.brushDomain))\n            _.each(this.state.plots, p => {\n                // no brush selected, show all\n                p.reset();\n                p.show();\n            });\n        else {\n            let isPlotBrushed = plot => _.inRange(\n                plot.data[0].totalProjectsCountry,\n                Math.floor(this.brushDomain[0]),\n                Math.ceil(this.brushDomain[1]) + 1\n            );\n            _.each(\n                this.state.plots,\n                p => p.select(isPlotBrushed(p))\n            );\n        }\n    };\n\n    handleOpenCountry(countryInfo) {\n        if(_.isUndefined(countryInfo))\n            this.props.handleOpenModalCountry(\n                this.state.staticPlots[this.staticCountryIndex].label,\n                this.state.staticPlots[this.staticCountryIndex].data,\n                this.state.staticPlots[this.staticCountryIndex].id,\n                this.state.staticPlots[this.staticCountryIndex].countryVariable, \n                this.state.staticPlots[this.staticCountryIndex].ghostVariable, \n                this.state.staticPlots[this.staticCountryIndex].sortingVariable\n            );\n        else\n            this.props.handleOpenModalCountry(\n                countryInfo.label,\n                countryInfo.data,\n                countryInfo.id,\n                countryInfo.countryVariable, \n                countryInfo.ghostVariable, \n                countryInfo.sortingVariable\n            );\n    }\n\n    \n\n    render() {\n        const self = this;\n        // define a vega signal listener for the brush in the stripPlot.\n        // when no brush applied, show all countries otherwise show\n        // countries with num of projects within the values of the brush\n        let stripPlotBrushListener = new VegaSignalListener('detailDomain', (name, value, view) => {\n            self.brushDomain = value;\n            self.brushCountries();\n        });\n\n        return <div className=\"container static-plots-container\" ref='container' style={{ position: 'relative' }}>\n\n            <div className=\"row plots-grid position-relative d-flex align-items-start\">\n                <div ref='primary-country' className=\"col-12 col-sm-6 p-0 chart-container primary justify-content-md-center d-flex align-items-end\">\n                </div>\n                <div className=\"col-12 col-sm-6 d-none d-sm-block\">\n                    <div ref='secondary-header' className=\"header-similar-countries row\">\n                        <div className=\"col-12\">SIMILAR COUNTRIES</div>\n                    </div>\n                    <div className=\"row align-content-start\">\n                        {\n                            SELECTED_COUNTRIES.slice(1).map((country, index) => {\n                                return <div ref={\"secondary-country-\" + index} className=\"col-6 p-0 chart-container secondary\" key={index} />\n                            })\n                        }\n                    </div>\n                </div>\n                <div className='country-selector' ref='country-selector' style={{ display: 'none' }}>\n                    <Select\n                        value={this.selectedOption}\n                        defaultValue={this.selectedOption}\n                        placeholder={\"\"}\n                        onChange={this.handleChange}\n                        options={countrySelectOptions}\n                        className={\"country-select-container\"}\n                        classNamePrefix={\"country-select\"}\n                        isSearchable={false} />\n                </div>\n                { /* svg to contain all the multidimensional items */}\n                <svg ref=\"svg-placeholder\" style={{ position: 'absolute', top: 0, left: 0 }} className=\"svg-placeholder-countries\" />\n\n                {!this.props.isMobile && <button\n                    ref=\"show-modal-btn\"\n                    onClick={() => this.handleOpenCountry()}\n                    className=\"button-icon btn-open-modal\">\n                    <IoIosAddCircle color=\"#97aabb\" />\n                </button>}\n            </div>\n            <div className=\"row footer strip-plot mx-0\" ref=\"strip-plot\">\n                <div className=\"col-12\">\n                    <p className=\"d-none d-sm-block\">&darr; Apply a selection to highlight countries</p>\n                    <VegaChart\n                        chartClass=\"strip-plot\"\n                        spec={VegaSpecStripPlot}\n                        height={75}\n                        signalListeners={[stripPlotBrushListener]}\n                        autosize={'pad' /* force to all content to be visible */}\n                        runAfterCallback={vegaView => {\n                            // save the view so we can update signals on it\n                            self.vegaView = vegaView;\n\n                            const texture = textures.circles()\n                                .size(5)\n                                .radius(1)\n                                .fill(\"#fa8072\");\n                            // to add textures to the brush rectangle\n                            const stripPlotSVG = d3.select('.strip-plot').select('svg');\n                            stripPlotSVG.call(texture);\n                            stripPlotSVG\n                                .select('.mark-rect.role-mark.texture path')\n                                .style('fill', texture.url());\n                        }}\n                    />\n                </div>\n            </div>\n\n\n        </div>\n    }\n}\n\nexport default CountryPlots;","export const areaChart = {\n  \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",\n  \"padding\": 0,\n  \"signals\": [\n    {\n      \"name\": \"symbolMouseover\",\n      \"description\": \"This signal has a listener on the Vega view runtime\",\n      \"value\": null,\n      \"on\": [\n        {\n          \"events\": \"rect:mouseover\",\n          \"update\": \"datum.startingYear\"\n        },\n        {\n          \"events\": \"rect:mouseout\",\n          \"update\": \"null\"\n        }\n      ]\n    },\n    {\n      \"name\": \"symbolHighlight\",\n      \"value\": null,\n      \"description\": \"This signal is updated from the view runtime, and receives the datum of the signal 'symbolMouseover', so we can highlight the hovered point in another view different from this one\"\n    },\n    {\n      \"name\": \"hover\",\n      \"on\": [\n        { \"events\": \"*:mouseover\", \"encode\": \"hover\" },\n        { \"events\": \"*:mouseout\", \"encode\": \"leave\" }\n      ]\n    },\n    {\n       \"name\": \"bgColor\",\n       \"value\": \"#19486A\"\n    }\n  ],\n  \"data\": [\n    {\n      \"name\": \"table\",\n      \"values\": null,\n      \"transform\": [\n        {\n          \"type\": \"filter\",\n          \"expr\": \"datum.startingYear !== 2007 && datum.startingYear !== 2020\"\n        },\n        {\n          \"type\": \"stack\",\n          \"groupby\": [\"startingYear\"],\n          \"sort\": { \"field\": \"SDG\" },\n          \"offset\": \"zero\",\n          \"field\": \"p_numProjectsSDG\"\n        }\n      ]\n    }\n  ],\n  \"scales\": [\n    {\n      \"name\": \"x\",\n      \"type\": \"point\",\n      \"range\": \"width\",\n      \"domain\": { \"data\": \"table\", \"field\": \"startingYear\" }\n    },\n    {\n      \"name\": \"y\",\n      \"type\": \"linear\",\n      \"range\": \"height\",\n      \"zero\": true,\n      \"domain\": { \"data\": \"table\", \"field\": \"p_numProjectsSDG\" }\n    },\n    {\n      \"name\": \"color\",\n      \"type\": \"ordinal\",\n      \"range\": \"category\",\n      \"domain\": { \"data\": \"table\", \"field\": \"SDG\" }\n    },\n    {\n      \"name\": \"xscale\",\n      \"type\": \"band\",\n      \"domain\": { \"data\": \"table\", \"field\": \"startingYear\" },\n      \"range\": \"width\",\n      \"round\": true\n    },\n    {\n      \"name\": \"yscale\",\n      \"type\": \"linear\",\n      \"domain\": [0, 1],\n      \"range\": \"height\"\n    }\n  ],\n  \"axes\": [\n    {\n      \"orient\": \"bottom\", \n      \"scale\": \"x\", \n      \"zindex\": 1, \n      \"labelOverlap\": true, \n      \"labelFlush\": true, \n      \"domain\": false,\n      \"ticks\": false,\n      \"labelPadding\": 6,\n      \"labelColor\": { \"signal\": \"bgColor\" },\n      \"values\": [2008, 2019]\n    },\n    {\n      \"orient\": \"left\",\n      \"scale\": \"y\",\n      \"encode\": {\n        \"labels\": {\n          \"interactive\": true,\n          \"update\": {\"text\": {\"signal\": \"datum.value === 0? '':format(datum.value, '.1%')\"}}\n        }\n      },\n      \"zindex\": 1,\n      \"labelOverlap\": true,\n      \"labelFlush\": true,\n      \"ticks\": false,\n      \"tickCount\": 0,\n      \"labelPadding\": 5,\n      \"domain\": false\n    }\n  ],\n\"marks\": [\n  {\n    \"type\": \"group\",\n    \"from\": { \"facet\": { \"name\": \"series\", \"data\": \"table\", \"groupby\": \"SDG\" } },\n    \"marks\": [\n      {\n        \"type\": \"area\",\n        \"from\": { \"data\": \"series\" },\n        \"encode\": {\n          \"enter\": {\n            \"interpolate\": { \"value\": \"monotone\" },\n            \"x\": { \"scale\": \"x\", \"field\": \"startingYear\" },\n            \"y\": { \"scale\": \"y\", \"field\": \"y0\" },\n            \"y2\": { \"scale\": \"y\", \"field\": \"y1\" },\n            \"fill\": { \"signal\": \"datum.color\" }\n          }\n        }\n      },\n      {\n        \"type\": \"rect\",\n        \"from\": { \"data\": \"series\" },\n        \"encode\": {\n          \"enter\": {\n            \"x\": { \"scale\": \"xscale\", \"field\": \"startingYear\" },\n            \"width\": { \"scale\": \"xscale\", \"band\": 1 },\n            \"y\": { \"scale\": \"yscale\", \"value\": 1 },\n            \"y2\": { \"scale\": \"yscale\", \"value\": 0 }\n          },\n          \"update\": {\n            \"opacity\": { \"value\": 0 },\n            \"fill\": { \"signal\": \"datum.color\" },\n            \"tooltip\": {\n              \"signal\": \"{Year: datum.startingYear, Projects: format(datum.p_numProjectsSDG, '.1%')}\"\n            }\n          }\n        }\n      },\n      {\n        \"type\": \"text\",\n        \"from\": {\"data\": \"series\"},\n        \"encode\": {\n          \"enter\": {\n            \"dy\": {\"value\": -6},\n            \"text\": {\"signal\": \"format(datum.p_numProjectsSDG, '.1%')\"},\n            \"fontSize\": {\"value\": 11},\n            \"baseline\": {\"value\": \"bottom\"},\n            \"interactive\": {\"value\": false},\n            \"fill\": {\"signal\": \"bgColor\"}\n          },\n          \"update\": {\n            \"x\": {\"scale\": \"x\", \"field\": \"startingYear\"},\n            \"y\": {\"scale\": \"y\", \"field\": \"y1\"},\n            \"align\": {\"signal\": \"datum.startingYear === 2008 ? 'right' : 'left'\"},\n            \"opacity\": {\n              \"signal\": \"datum.startingYear === 2008 || datum.startingYear === 2019 ? 1:0\"\n            }\n          }\n        }\n      },\n      {\n        \"type\": \"text\",\n        \"from\": {\n          \"data\": \"series\"\n        },\n        \"encode\": {\n          \"enter\": {\n            \"dy\": {\n              \"value\": -6\n            },\n            \"text\": {\n              \"signal\": \"format(datum.p_numProjectsSDG, '.1%')\"\n            },\n            \"opacity\": {\n              \"value\": 0\n            },\n            \"align\": {\n              \"value\": \"center\"\n            },\n            \"fontSize\": {\n              \"value\": 11\n            },\n            \"baseline\": {\n              \"value\": \"bottom\"\n            },\n            \"interactive\": {\n              \"value\": false\n            },\n            \"fill\": { \"signal\": \"bgColor\" }\n          },\n          \"update\": {\n            \"x\": {\n              \"scale\": \"x\",\n              \"field\": \"startingYear\"\n            },\n            \"y\": {\n              \"scale\": \"y\",\n              \"field\": \"y1\"\n            },\n            \"opacity\": {\n              \"signal\": \"symbolHighlight === datum.startingYear && (datum.startingYear !== 2008 && datum.startingYear !== 2019) ? 1 : 0\"\n            }\n          }\n        }\n      },\n      {\n        \"type\": \"symbol\",\n        \"style\": \"circle\",\n        \"from\": {\n          \"data\": \"series\"\n        },\n        \"encode\": {\n          \"enter\": {\n            \"opacity\": {\n              \"value\": 0\n            },\n            \"stroke\": { \"signal\": \"datum.color\" },\n            \"fill\": { \"signal\": \"datum.color\" },\n            \"strokeWidth\": { \"value\": 1 }\n          },\n          \"update\": {\n            \"x\": {\n              \"scale\": \"x\",\n              \"field\": \"startingYear\"\n            },\n            \"y\": {\n              \"scale\": \"y\",\n              \"field\": \"y1\"\n            },\n            \"opacity\": {\n              \"signal\": \"symbolHighlight === datum.startingYear ? 1 : 0\"\n            }\n          }\n        }\n      }\n    ]\n  }\n]\n}","export const areaChartAll = {\n   \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",\n   \"padding\": 0,\n   \"title\": {\n      \"text\": \"Annual number of EU-funded projects, total and SDG-related\",\n      \"offset\": 10,\n      \"color\": {\"signal\": \"bgColor\"}\n   },\n   \"signals\": [\n      {\n         \"name\": \"symbolMouseover\",\n         \"description\": \"This signal has a listener on the Vega view runtime\",\n         \"value\": null,\n         \"on\": [\n            {\n               \"events\": \"rect:mouseover\",\n               \"update\": \"datum.startingYear\"\n            },\n            {\n               \"events\": \"rect:mouseout\",\n               \"update\": \"null\"\n            }\n         ]\n      },\n      {\n         \"name\": \"symbolHighlight\",\n         \"value\": null,\n         \"description\": \"This signal is updated from the view runtime, and receives the datum of the signal 'symbolMouseover', so we can highlight the hovered point in another view different from this one\"\n      },\n      {\n         \"name\": \"hover\",\n         \"on\": [\n            {\n               \"events\": \"*:mouseover\",\n               \"encode\": \"hover\"\n            },\n            {\n               \"events\": \"*:mouseout\",\n               \"encode\": \"leave\"\n            }\n         ]\n      },\n      {\n         \"name\": \"bgColor\",\n         \"value\": \"#19486A\"\n      }\n   ],\n   \"data\": [\n      {\n         \"name\": \"table\",\n         \"values\": null,\n         \"transform\": [\n            {\n               \"type\": \"filter\",\n               \"expr\": \"datum.SDG == 'ALL'\"\n            },\n            {\n               \"type\": \"filter\",\n               \"expr\": \"datum.startingYear !== 2007 && datum.startingYear !== 2020\"\n            }\n         ]\n      },\n      {\n         \"name\": \"legend\",\n         \"values\": [\n            { \"label\": \"R&I projects\" },\n            { \"label\": \"R&I projects classified as SDG-related \" }\n         ]\n      }\n   ],\n   \"legends\": [\n      {\n         \"type\": \"symbol\",\n         \"symbolType\": \"square\",\n         \"orient\": \"bottom\",\n         \"stroke\": \"legend\",\n         \"padding\": 4,\n         \"labelLimit\": 400,\n         \"labelColor\": { \"signal\": \"bgColor\" },\n         \"encode\": {\n            \"symbols\": {\n               \"enter\": {\n                  \"strokeOpacity\": { \"value\": 0 },\n                  \"fill\": { \"signal\": \"bgColor\" },\n                  \"strokeWidth\": { \"value\": 2 },\n                  \"size\": { \"value\": 120 }\n               }\n            }\n         }\n      }\n   ],\n   \"scales\": [\n      {\n         \"name\": \"legend\",\n         \"type\": \"ordinal\",\n         \"domain\": {\n            \"data\": \"legend\",\n            \"field\": \"label\"\n         },\n         \"range\": [\"bgColor\", \"bgColor\"]\n      },\n      {\n         \"name\": \"x\",\n         \"type\": \"point\",\n         \"range\": \"width\",\n         \"domain\": {\n            \"data\": \"table\",\n            \"field\": \"startingYear\"\n         }\n      },\n      {\n         \"name\": \"yTotal\",\n         \"type\": \"linear\",\n         \"range\": \"height\",\n         \"nice\": true,\n         \"zero\": true,\n         \"domain\": {\n            \"data\": \"table\",\n            \"field\": \"totalNumProjectsCORDIS\"\n         },\n         \"domainMax\": 9000\n      },\n      {\n         \"name\": \"xscale\",\n         \"type\": \"band\",\n         \"domain\": {\n            \"data\": \"table\",\n            \"field\": \"startingYear\"\n         },\n         \"range\": \"width\",\n         \"round\": true\n      },\n      {\n         \"name\": \"yscale\",\n         \"type\": \"linear\",\n         \"domain\": [\n            0,\n            1\n         ],\n         \"range\": \"height\"\n      }\n   ],\n   \"axes\": [\n      {\n         \"orient\": \"bottom\",\n         \"scale\": \"x\",\n         \"labelOverlap\": true,\n         \"labelFlush\": true,\n         \"ticks\": false,\n         \"labelColor\": { \"signal\": \"bgColor\"},\n         \"values\": [2008, 2019],\n         \"labelPadding\": 6,\n         \"domainOpacity\": 0\n      },\n      {\n         \"orient\": \"left\",\n         \"scale\": \"yTotal\",\n         \"ticks\": false,\n         \"labelPadding\": 5,\n         \"labelColor\": { \"signal\": \"bgColor\"},\n         \"domainOpacity\": 0,\n         \"grid\": true,\n         \"gridColor\": { \"signal\": \"bgColor\" },\n         \"gridOpacity\": .25,\n         \"values\": [5000],\n         \"encode\": {\n            \"labels\": {\n               \"interactive\": true,\n               \"update\": {\n                  \"text\": {\n                     \"signal\": \"datum.value ===0? '':format(parseInt(datum.value), '.2s')\"\n                  }\n               }\n            }\n         }\n      }\n   ],\n   \"marks\": [\n      {\n         \"type\": \"group\",\n         \"name\": \"labelling\",\n         \"style\": \"cell\",\n         \"marks\": [\n            {\n               \"type\": \"rule\",\n               \"encode\": {\n                  \"enter\": {\n                     \"x\": {\n                        \"scale\": \"x\",\n                        \"value\": 2014\n                     },\n                     \"x2\": {\n                        \"scale\": \"x\",\n                        \"value\": 2019\n                     },\n                     \"y\": {\n                        \"scale\": \"yscale\",\n                        \"value\": .8\n                     },\n                     \"y2\": {\n                        \"scale\": \"yscale\",\n                        \"value\": .8\n                     },\n                     \"stroke\": {\n                        \"value\": \"#CCC\"\n                     },\n                     \"strokeWidth\": {\n                        \"value\": 1\n                     },\n                     \"strokeDash\": {\n                        \"value\": [2, 2]\n                     }\n                  }\n               }\n            },\n            {\n               \"type\": \"text\",\n               \"encode\": {\n                  \"enter\": {\n                     \"text\": {\n                        \"value\": \"Programme H2020 period\"\n                     },\n                     \"x\": {\n                        \"scale\": \"x\",\n                        \"value\": 2014\n                     },\n                     \"y\": {\n                        \"scale\": \"yscale\",\n                        \"value\": .84\n                     },\n                     \"fill\": {\n                        \"signal\": \"bgColor\"\n                     }\n                  }\n               }\n            },\n            {\n               \"type\": \"rule\",\n               \"encode\": {\n                  \"enter\": {\n                     \"x\": {\n                        \"scale\": \"x\",\n                        \"value\": 2008\n                     },\n                     \"x2\": {\n                        \"scale\": \"x\",\n                        \"value\": 2013\n                     },\n                     \"y\": {\n                        \"scale\": \"yscale\",\n                        \"value\": .8\n                     },\n                     \"y2\": {\n                        \"scale\": \"yscale\",\n                        \"value\": .8\n                     },\n                     \"stroke\": {\n                        \"value\": \"#CCC\"\n                     },\n                     \"strokeWidth\": {\n                        \"value\": 1\n                     },\n                     \"strokeDash\": {\n                        \"value\": [2, 2]\n                     }\n                  }\n               }\n            },\n            {\n               \"type\": \"text\",\n               \"encode\": {\n                  \"enter\": {\n                     \"text\": {\n                        \"value\": \"Programme FP7 period\"\n                     },\n                     \"x\": {\n                        \"scale\": \"x\",\n                        \"value\": 2008\n                     },\n                     \"y\": {\n                        \"scale\": \"yscale\",\n                        \"value\": .84\n                     },\n                     \"fill\": {\n                        \"signal\": \"bgColor\"\n                     }\n                  }\n               }\n            }\n         ]\n      },\n      {\n         \"type\": \"area\",\n         \"name\": \"area-all-sdg\",\n         \"from\": {\n            \"data\": \"table\"\n         },\n         \"encode\": {\n            \"enter\": {\n               \"x\": {\n                  \"scale\": \"x\",\n                  \"field\": \"startingYear\"\n               },\n               \"y\": {\n                  \"scale\": \"yTotal\",\n                  \"field\": \"numProjectsSDG\"\n               },\n               \"y2\": {\n                  \"scale\": \"yTotal\",\n                  \"value\": 0\n               }\n            },\n            \"update\": {\n               \"interpolate\": {\n                  \"value\": \"monotone\"\n               }\n            }\n         }\n      },\n      {\n         \"type\": \"line\",\n         \"from\": {\n            \"data\": \"table\"\n         },\n         \"encode\": {\n            \"enter\": {\n               \"x\": {\n                  \"scale\": \"x\",\n                  \"field\": \"startingYear\"\n               },\n               \"y\": {\n                  \"scale\": \"yTotal\",\n                  \"field\": \"totalNumProjectsCORDIS\"\n               },\n               \"stroke\": {\n                  \"signal\": \"bgColor\"\n               },\n               \"strokeWidth\": {\n                  \"value\": 2\n               }\n            },\n            \"update\": {\n               \"interpolate\": {\n                  \"value\": \"monotone\"\n               },\n               \"fillOpacity\": {\n                  \"value\": 1\n               }\n            }\n         }\n      },\n      {\n         \"type\": \"rect\",\n         \"from\": {\n            \"data\": \"table\"\n         },\n         \"encode\": {\n            \"enter\": {\n               \"x\": {\n                  \"scale\": \"xscale\",\n                  \"field\": \"startingYear\"\n               },\n               \"width\": {\n                  \"scale\": \"xscale\",\n                  \"band\": 1\n               },\n               \"y\": {\n                  \"scale\": \"yscale\",\n                  \"value\": 1\n               },\n               \"y2\": {\n                  \"scale\": \"yscale\",\n                  \"value\": 0\n               },\n               \"tooltip\": {\n                  \"signal\": \"{Year: datum.startingYear, 'SDG-related projects': datum.numProjectsSDG, 'R&I projects': datum.totalNumProjectsCORDIS}\"\n               }\n            },\n            \"update\": {\n               \"opacity\": {\n                  \"value\": 0\n               },\n               \"fill\": {\n                  \"value\": \"#666\"\n               }\n            }\n         }\n      },\n      {\n         \"type\": \"group\",\n         \"style\": \"cell\",\n         \"name\": \"tooltip-values\",\n         \"marks\": [\n            {\n               \"type\": \"text\",\n               \"from\": {\n                  \"data\": \"table\"\n               },\n               \"encode\": {\n                  \"enter\": {\n                     \"dy\": {\n                        \"value\": -10\n                     },\n                     \"text\": {\n                        \"signal\": \"format(parseInt(datum.numProjectsSDG), ',.4r')\"\n                     },\n                     \"opacity\": {\n                        \"value\": 0\n                     },\n                     \"align\": {\n                        \"value\": \"center\"\n                     },\n                     \"fill\": {\n                        \"signal\": \"bgColor\"\n                     },\n                     \"fontSize\": {\n                        \"value\": 10\n                     },\n                     \"interactive\": {\n                        \"value\": false\n                     }\n                  },\n                  \"update\": {\n                     \"x\": {\n                        \"scale\": \"x\",\n                        \"field\": \"startingYear\"\n                     },\n                     \"y\": {\n                        \"scale\": \"yTotal\",\n                        \"field\": \"numProjectsSDG\"\n                     },\n                     \"opacity\": {\n                        \"signal\": \"symbolHighlight === datum.startingYear ? 1 : 0\"\n                     }\n                  }\n               }\n            },\n            {\n               \"type\": \"text\",\n               \"from\": {\n                  \"data\": \"table\"\n               },\n               \"encode\": {\n                  \"enter\": {\n                     \"dy\": {\n                        \"value\": -10\n                     },\n                     \"text\": {\n                        \"signal\": \"format(parseInt(datum.totalNumProjectsCORDIS), ',.4r')\"\n                     },\n                     \"opacity\": {\n                        \"value\": 0\n                     },\n                     \"align\": {\n                        \"value\": \"center\"\n                     },\n                     \"fill\": {\n                        \"signal\": \"bgColor\"\n                     },\n                     \"fontSize\": {\n                        \"value\": 10\n                     },\n                     \"interactive\": {\n                        \"value\": false\n                     }\n                  },\n                  \"update\": {\n                     \"x\": {\n                        \"scale\": \"x\",\n                        \"field\": \"startingYear\"\n                     },\n                     \"y\": {\n                        \"scale\": \"yTotal\",\n                        \"field\": \"totalNumProjectsCORDIS\"\n                     },\n                     \"opacity\": {\n                        \"signal\": \"symbolHighlight === datum.startingYear ? 1 : 0\"\n                     }\n                  }\n               }\n            },\n            {\n               \"type\": \"symbol\",\n               \"style\": \"circle\",\n               \"from\": {\n                 \"data\": \"table\"\n               },\n               \"encode\": {\n                 \"enter\": {\n                   \"opacity\": {\n                     \"value\": 0\n                   },\n                   \"fill\": { \"signal\": \"bgColor\" },\n                   \"stroke\": { \"signal\": \"bgColor\" },\n                   \"strokeWidth\": { \"value\": 1 }\n                 },\n                 \"update\": {\n                   \"x\": {\n                     \"scale\": \"x\",\n                     \"field\": \"startingYear\"\n                   },\n                   \"y\": {\n                     \"scale\": \"yTotal\",\n                     \"field\": \"numProjectsSDG\"\n                   },\n                   \"opacity\": {\n                     \"signal\": \"symbolHighlight === datum.startingYear ? 1 : 0\"\n                   }\n                 }\n               }\n             },\n             {\n               \"type\": \"symbol\",\n               \"style\": \"circle\",\n               \"from\": {\n                 \"data\": \"table\"\n               },\n               \"encode\": {\n                 \"enter\": {\n                   \"opacity\": {\n                     \"value\": 0\n                   },\n                   \"fill\": { \"signal\": \"bgColor\" },\n                   \"stroke\": { \"signal\": \"bgColor\" },\n                   \"strokeWidth\": { \"value\": 1 }\n                 },\n                 \"update\": {\n                   \"x\": {\n                     \"scale\": \"x\",\n                     \"field\": \"startingYear\"\n                   },\n                   \"y\": {\n                     \"scale\": \"yTotal\",\n                     \"field\": \"totalNumProjectsCORDIS\"\n                   },\n                   \"opacity\": {\n                     \"signal\": \"symbolHighlight === datum.startingYear ? 1 : 0\"\n                   }\n                 }\n               }\n             }\n         ]\n      }\n\n   ]\n}","export const sdgKeywordTrend ={\n    \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",\n    \"width\": 400,\n    \"height\": 100,\n    \"data\": [\n      {\n        \"name\": \"sdg_info\",\n        \"values\": [\n          {\n            \"label\": \"SDG 1\",\n            \"color\": \"#E5243B\",\n            \"shortTitle\": \"No poverty\",\n            \"title\": \"End poverty in all its forms everywhere\"\n          },\n          {\n            \"label\": \"SDG 2\",\n            \"color\": \"#DDA63A\",\n            \"shortTitle\": \"No hunger\",\n            \"title\": \"End hunger, achieve food security and improved nutrition and promote sustainable agriculture\"\n          },\n          {\n            \"label\": \"SDG 3\",\n            \"color\": \"#4C9F38\",\n            \"shortTitle\": \"Good Health and Well-being\",\n            \"title\": \"Ensure healthy lives and promote well-being for all at all ages\"\n          },\n          {\n            \"label\": \"SDG 4\",\n            \"color\": \"#C5192D\",\n            \"shortTitle\": \"Quality Education\",\n            \"title\": \"Ensure inclusive and equitable quality education and promote lifelong learning opportunities for all\"\n          },\n          {\n            \"label\": \"SDG 5\",\n            \"color\": \"#FF3A21\",\n            \"shortTitle\": \"Gender Equality\",\n            \"title\": \"Achieve gender equality and empower all women and girls\"\n          },\n          {\n            \"label\": \"SDG 6\",\n            \"color\": \"#26BDE2\",\n            \"shortTitle\": \"Clean Water and Sanitation\",\n            \"title\": \"Ensure availability and sustainable management of water and sanitation for all\"\n          },\n          {\n            \"label\": \"SDG 7\",\n            \"color\": \"#FCC30B\",\n            \"shortTitle\": \"Affordable and Clean Energy\",\n            \"title\": \"Ensure access to affordable, reliable, sustainable and modern energy for all\"\n          },\n          {\n            \"label\": \"SDG 8\",\n            \"color\": \"#A21942\",\n            \"shortTitle\": \"Decent Work and Economic Growth\",\n            \"title\": \"Promote sustained, inclusive and sustainable economic growth, full and productive employment and decent work for all\"\n          },\n          {\n            \"label\": \"SDG 9\",\n            \"color\": \"#FD6925\",\n            \"shortTitle\": \"Industry, Innovation and Infrastructure\",\n            \"title\": \"Build resilient infrastructure, promote inclusive and sustainable industrialization and foster innovation\"\n          },\n          {\n            \"label\": \"SDG 10\",\n            \"color\": \"#DD1367\",\n            \"shortTitle\": \"Reduced Inequality\",\n            \"title\": \"Reduce inequality within and among countries\"\n          },\n          {\n            \"label\": \"SDG 11\",\n            \"color\": \"#FD9D24\",\n            \"shortTitle\": \"Sustainable Cities and Communities\",\n            \"title\": \"Make cities and human settlements inclusive, safe, resilient and sustainable\"\n          },\n          {\n            \"label\": \"SDG 12\",\n            \"color\": \"#BF8B2E\",\n            \"shortTitle\": \"Responsible Consumption and Production\",\n            \"title\": \"Ensure sustainable consumption and production patterns\"\n          },\n          {\n            \"label\": \"SDG 13\",\n            \"color\": \"#3F7E44\",\n            \"shortTitle\": \"Climate Action\",\n            \"title\": \"Take urgent action to combat climate change and its impacts\"\n          },\n          {\n            \"label\": \"SDG 14\",\n            \"color\": \"#0A97D9\",\n            \"shortTitle\": \"Life Below Water\",\n            \"title\": \"Conserve and sustainably use the oceans, seas and marine resources for sustainable development\"\n          },\n          {\n            \"label\": \"SDG 15\",\n            \"color\": \"#56C02B\",\n            \"shortTitle\": \"Life on Land\",\n            \"title\": \"\"\n          },\n          {\n            \"label\": \"SDG 16\",\n            \"color\": \"#00689D\",\n            \"shortTitle\": \"Peace and Justice Strong Institutions\",\n            \"title\": \"Promote peaceful and inclusive societies for sustainable development, provide access to justice for all and build effective, accountable and inclusive institutions at all levels\"\n          }\n        ]\n      },\n      {\n        \"name\": \"table\",\n        \"values\": null,\n        \"transform\": [\n          {\n            \"type\": \"sparql\",\n            \"endpoint\": \"http://ec2-52-51-177-228.eu-west-1.compute.amazonaws.com/unics/sparql/query\",\n            \"query\": null\n          },\n          {\n            \"type\": \"filter\", \n            \"expr\": \"datum.year > 2007 && datum.year < 2020\"\n          },\n          {\n            \"type\": \"impute\",\n            \"groupby\": [\"keyword\", \"sdgName\"],\n            \"key\": \"year\",\n            \"keyvals\": [\n              2008,\n              2009,\n              2010,\n              2011,\n              2012,\n              2013,\n              2014,\n              2015,\n              2016,\n              2017,\n              2018,\n              2019\n            ],\n            \"field\": \"numProjs\",\n            \"method\": \"value\",\n            \"value\": 0\n          },\n          {\n            \"type\": \"lookup\",\n            \"from\": \"sdg_info\",\n            \"key\": \"label\",\n            \"values\": [\"shortTitle\", \"color\"],\n            \"fields\": [\"sdgName\"]\n          },\n          {\n            \"type\": \"collect\",\n            \"sort\": {\"field\": \"year\"}\n          },\n          {\n            \"type\": \"formula\",\n            \"expr\": \"datum.shortTitle + ' - ' + datum.sdgName\",\n            \"as\": \"shortTitle\"\n          },\n          {\"type\": \"extent\", \"field\": \"numProjs\", \"signal\": \"extent\"}\n        ]\n      }\n    ],\n    \"scales\": [\n       {\n        \"name\": \"xscale\",\n        \"type\": \"point\",\n        \"domain\": {\"data\": \"table\", \"field\": \"year\"},\n        \"range\": [0, {\"signal\": \"width\"}],\n        \"padding\": 0.05,\n        \"round\": true\n      },\n      {\n        \"name\": \"yscale\",\n        \"type\": \"linear\",\n        \"domain\": {\"signal\": \"extent\"},\n        \"range\": [{\"signal\": \"height\"}, 0]\n      }\n    ],\n    \"axes\": [\n          {\n            \"orient\": \"left\",\n            \"scale\": \"yscale\",\n            \"ticks\": false,\n            \"domain\": false,\n            \"tickCount\": 2,\n            \"grid\": true,\n            \"gridDash\": [2,2],\n            \"labelPadding\": 5,\n            \"encode\": {\n              \"labels\": {\n                \"update\": {\n                  \"opacity\": {\n                    \"signal\": \"datum.value === 0? 0:1\"\n                  }\n                }\n              }\n            }    \n          },\n          {\n            \"orient\": \"bottom\",\n            \"scale\": \"xscale\",\n            \"domain\": true,\n            \"ticks\": true,\n            \"encode\": {\n              \"ticks\": {\n                \"update\": {\n                  \"opacity\": {\n                    \"signal\": \"datum.value === 2008 || datum.value === 2019 ? 1:0\"\n                  }\n                }\n              },\n              \"labels\": {\n                \"update\": {\n                  \"text\": {\n                    \"signal\": \"datum.value === 2008 || datum.value === 2019 ? datum.value : ''\"\n                  },\n                  \"align\": {\n                    \"signal\": \"datum.value === 2019? 'right':'left'\"\n                  },\n                  \"dx\": {\n                    \"signal\": \"(datum.value === 2018)? -5:(datum.value === 2019)? 5:0\"\n                  }\n                }\n              }\n            }\n          }\n        ],\n      \"marks\": [\n        {\n            \"type\": \"line\",\n            \"from\": {\"data\": \"table\"},\n            \"encode\": {\n              \"enter\": {\n                \"x\": {\"scale\": \"xscale\", \"field\": \"year\"},\n                \"y\": {\"scale\": \"yscale\", \"field\": \"numProjs\"},\n                \"strokeWidth\": {\"value\": 4},\n                \"stroke\": {\"field\": \"color\"}\n              },\n              \"update\": {\n                \"interpolate\": {\n                  \"value\": \"basis\"\n                },\n                \"stroke\": {\n                  \"field\": \"color\"\n                }\n              }\n            }\n          }\n    ]\n  };","export const streamgraph = {\n    \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",\n    \"title\": {},\n    \"signals\": [\n      {\"name\": \"splitYear\", \"value\": 2013}\n    ],\n    \"description\": `some notes:\n      - Order can be done by the field order (to follow alphabetic SDG labels), totalCount (to sort by most overall counted) or by count(to sort by count per year )\n      `,\n    \"data\": [\n        {\n          \"name\": \"table\",\n          \"values\": null,\n          \"transform\": [\n            {\n              \"type\": \"stack\",\n              \"field\": \"count\",\n              \"offset\": \"normalize\", \n              \"groupby\": [\"year\"],\n              \"sort\": {\"field\": [\"order\"], \"order\": [\"descending\"]}\n            }\n          ]\n        },\n        {\n          \"name\": \"series\",\n          \"source\": \"table\",\n          \"transform\": [\n            {\n              \"type\": \"aggregate\",\n              \"groupby\": [\"SDG\"],\n              \"fields\": [\"count\"],\n              \"ops\": [\"sum\"],\n              \"as\": [\"sum\"]\n            }\n          ]\n        },\n        {\n            \"name\": \"sdg-colors\",\n            \"values\": [\n                { sdg: 'SDG 1' , color: '#E5243B'},\n                { sdg: 'SDG 2' , color: '#DDA63A'},\n                { sdg: 'SDG 3' , color: '#4C9F38'},\n                { sdg: 'SDG 4' , color: '#C5192D'},\n                { sdg: 'SDG 5' , color: '#FF3A21'},\n                { sdg: 'SDG 6' , color: '#26BDE2'},\n                { sdg: 'SDG 7' , color: '#FCC30B'},\n                { sdg: 'SDG 8' , color: '#A21942'},\n                { sdg: 'SDG 9' , color: '#FD6925'},\n                { sdg: 'SDG 10' , color: '#DD1367'},\n                { sdg: 'SDG 11' , color: '#FD9D24'},\n                { sdg: 'SDG 12' , color: '#BF8B2E'},\n                { sdg: 'SDG 13' , color: '#3F7E44'},\n                { sdg: 'SDG 14' , color: '#0A97D9'},\n                { sdg: 'SDG 15' , color: '#56C02B'},\n                { sdg: 'SDG 16' , color: '#00689D'},\n                { sdg: 'SDG 17' , color: '#00689D'}\n            ]\n        },\n        {\n          \"name\": \"programs\",\n          \"values\": [\n            { id:\"fp7\", name: \"7th Framework Programme\" },\n            { id: \"h2020\", name: \"Horizon 2020 Programme\" }\n          ]\n        }\n      ],\n    \"axes\": [\n      {\n        \"orient\": \"bottom\",\n        \"scale\": \"x\",\n        \"labelPadding\": 5,\n        \"grid\": true,\n        \"gridColor\": \"whitesmoke\",\n        \"gridDash\": [2, 2],\n        \"gridOpacity\": 1,\n        \"domainDash\": [1, 1],\n        \"domainOpacity\": 0,\n        \"ticks\": false,\n        \"encode\": {\n          \"labels\": {\n            \"name\": \"year-labels\",\n            \"update\": {\n              \"align\": {\"signal\": \"datum.value === 2008 ? 'left' : datum.value === 2019 ? 'right':'center' \"},\n              \"dx\": {\"signal\": \"datum.value === 2008 ?  2 : datum.value === 2019 ? -2:0 \"}\n            }\n          }\n        }\n      },\n      {\n        \"orient\": \"top\",\n        \"scale\": \"x\",\n        \"labelPadding\": 5,\n        \"domainDash\": [1, 1],\n        \"domainOpacity\": 0,\n        \"ticks\": false,\n        \"encode\": {\n          \"labels\": {\n            \"name\": \"year-labels-2\",\n            \"update\": {\n              \"align\": {\"signal\": \"datum.value === 2008 ? 'left' : datum.value === 2019 ? 'right':'center' \"},\n              \"dx\": {\"signal\": \"datum.value === 2008 ?  2 : datum.value === 2019 ? -2:0 \"}\n            }\n          }\n        }   \n      }\n    ],\n    \"scales\": [\n      {\n        \"name\": \"x\",\n        \"type\": \"point\",\n        \"range\": \"width\",\n        \"zero\": false,\n        \"round\": true,\n        \"domain\": {\"data\": \"table\", \"field\": \"year\"}\n      },\n      {\n        \"name\": \"y\",\n        \"type\": \"linear\",\n        \"range\": \"height\",\n        \"round\": true,\n        \"zero\": true,\n        \"domain\": {\"data\": \"table\", \"field\": \"y1\"}\n      },\n      {\n        \"name\": \"color\",\n        \"type\": \"ordinal\",\n        \"domain\": ['SDG 1','SDG 2','SDG 3','SDG 4','SDG 5','SDG 6','SDG 7','SDG 8','SDG 9','SDG 10','SDG 11','SDG 12','SDG 13','SDG 14','SDG 15','SDG 16','SDG 17'],\n        \"range\": ['#E5243B', '#DDA63A', '#4C9F38', '#C5192D', '#FF3A21', '#26BDE2', '#FCC30B', '#A21942', '#FD6925', '#DD1367', '#FD9D24', '#BF8B2E', '#3F7E44', '#0A97D9', '#56C02B', '#00689D', '#00689D']\n      }\n    ],\n    \"marks\": [\n      {\n        \"type\": \"group\",\n        \"from\": {\n          \"data\": \"series\",\n          \"facet\": {\"name\": \"facet\", \"data\": \"table\", \"groupby\": [\"SDG\"]}\n        },\n        \"marks\": [\n          {\n            \"type\": \"area\",\n            \"interactive\": false,\n            \"name\": \"sdg-serie\",\n            \"from\": {\"data\": \"facet\"},\n            \"encode\": {\n              \"update\": {\n                \"interpolate\": {\"value\": \"monotone\"},\n                \"x\": {\"scale\": \"x\", \"field\": \"year\"},\n                \"y\": {\"scale\": \"y\", \"field\": \"y0\"},\n                \"y2\": {\"scale\": \"y\", \"field\": \"y1\"},\n                \"fill\": {\"scale\": \"color\", \"field\": \"SDG\"},\n                \"fillOpacity\": {\"value\": 1}\n              }\n            }\n          }\n        ]\n      },\n      {\n        \"type\": \"rect\",\n        \"from\": {\"data\":\"programs\"},\n        \"encode\": {\n          \"enter\": {\n            \"x\": {\n              \"signal\": \"datum.id === 'fp7' ? scale('x', 2008) : scale('x', 2013)\"\n            },\n            \"x2\": {\n              \"signal\": \"datum.id === 'h2020' ? scale('x', 2013) : scale('x', 2019)\"\n            },\n            \"y\": {\"value\": -50},\n            \"y2\": {\"value\": -25},\n            \"fill\": {\"value\": \"#eaeef1\"}\n          }\n        }\n      },\n      {\n        \"type\": \"text\",\n        \"from\": {\"data\":\"programs\"},\n        \"name\": \"eu-program-title\",\n        \"encode\": {\n          \"enter\": {\n            \"x\": {\n              \"signal\": \"datum.id === 'fp7' ? (scale('x', 2013) - scale('x', 2008))/2 : scale('x', 2013) + (scale('x', 2019) - scale('x', 2013))/2\"\n            },\n            \"y\": {\"value\": -33},\n            \"text\": {\"signal\": \"datum.name\"},\n            \"fill\":{\"value\": \"#19486A\"},\n            \"baseline\": {\"value\": \"middle\"},\n            \"align\": {\"value\": \"center\"},\n            \"font\": {\"value\": \"sans-serif, Verdana, Arial\"},\n            \"fontWeight\": {\"value\": \"bold\"}\n          }\n        }\n      },\n      {\n        \"type\": \"rule\",\n        \"encode\": {\n          \"enter\": {\n            \"y\": {\"value\": -25},\n            \"y2\": {\"signal\": \"height \"},\n            \"stroke\": {\"value\": \"#333\"},\n            \"strokeOpacity\": {\"value\": 0.5},\n            \"strokeWidth\": {\"value\": 3},\n            \"strokeDash\": {\n              \"value\": [5, 5]\n            },\n            \"x\": {\"scale\": \"x\", \"signal\": \"splitYear\"},\n            \"x2\": {\"scale\": \"x\", \"signal\": \"splitYear\"}\n          }\n        }\n      },\n      {\n        \"type\": \"text\",\n        \"name\": \"split-year-annotation\",\n        \"encode\": {\n          \"enter\": {\n            \"x\": {\n              \"signal\": \"scale('x', 2013)\"\n            },\n            \"y\": {\n              \"value\": -36\n            },\n            \"text\": {\"value\": \"End of FP7 and H2020 starts\"},\n            \"fill\": {\"value\": \"whitesmoke\"},\n            \"baseline\": {\"value\": \"middle\"},\n            \"align\": {\"value\": \"center\"},\n            \"fontWeight\": {\n              \"value\": \"bold\"\n            }\n          }\n        }\n      }\n    ]\n  }","export const keywordsIncrements = {\n    \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",\n    \"height\": 500,\n    \"padding\": {\"left\": 25, \"right\": 225, \"top\": 0, \"bottom\": 20},\n    \"autosize\": \"fit\",\n    \"signals\": [\n      {\"name\": \"cx\", \"update\": \"width / 2\"},\n      {\"name\": \"cy\", \"update\": \"height / 2\"}, \n      {\"name\": \"gravityX\", \"value\": 1},\n      {\"name\": \"gravityY\", \"value\": 0.75},\n      {\"name\": \"lineBreak\", \"value\": \"@\"},\n      {\"name\": \"colorAnnotation\", \"value\": \"cadetblue\"}\n    ],\n    \"data\": [\n      {\n        \"name\": \"keywords\",\n        \"values\": undefined,\n        \"transform\": [\n          {\n            \"type\": \"formula\",\n            \"expr\": \"datum.total_fp7 + datum.total_h2020\",\n            \"as\": \"total\"\n          },\n          {\"type\": \"formula\", \"expr\": \"datum.increment / 100\", \"as\": \"increment\"},\n          {\"type\": \"formula\", \"expr\": \"datum.percent_increment / 100\", \"as\": \"percent_increment\"},\n          { \"type\": \"collect\",\"sort\": { \"field\": [\"total_fp7\"], \"order\":[\"descending\"]}},\n          {\"type\": \"identifier\", \"as\": \"id\"},\n          {\"type\": \"filter\", \"expr\": \"datum.id < 100\"},\n          {\"type\": \"extent\", \"field\": \"percent_increment\", \"signal\": \"extent\"}\n        ]\n      },\n      {\n        \"name\": \"increment\",\n        \"source\": \"keywords\",\n        \"transform\": [\n          {\"type\": \"project\", \"fields\": [\"percent_increment\"], \"as\": [\"percent_increment\"]}\n        ]\n      },\n      {\n        \"name\": \"positive_increment\",\n        \"source\": \"increment\",\n        \"transform\": [{\"type\": \"filter\", \"expr\": \"datum.percent_increment >= 0\"}]\n      },\n      {\n        \"name\": \"negative_increment\",\n        \"source\": \"increment\",\n        \"transform\": [{\"type\": \"filter\", \"expr\": \"datum.percent_increment < 0\"}]\n      }\n    ],\n    \"scales\": [\n      {\n        \"name\": \"x\",\n        \"type\": \"linear\",\n        \"domain\": {\"signal\": \"[extent[0] - 0.005, extent[1] + 0.005]\"},\n        \"range\": \"width\"\n      },\n      {\n        \"name\": \"r\",\n        \"type\": \"pow\",\n        \"exponent\": 0.55,\n        \"domain\": {\"data\": \"keywords\", \"field\": \"total\"},\n        \"range\": [10, 200]\n      },\n      {\n        \"name\": \"font\",\n        \"type\": \"linear\",\n        \"domain\": {\"data\": \"keywords\", \"field\": \"total\"},\n        \"range\": [6, 40]\n      }, \n      {\n        \"name\": \"color_negative\",\n        \"type\": \"linear\",\n        \"domain\": {\"data\": \"negative_increment\", \"field\": \"percent_increment\"},\n        \"range\": [\"#f44336\", \"#888\"]\n      },\n      {\n        \"name\": \"color_positive\",\n        \"type\": \"linear\",\n        \"domain\": {\"data\": \"positive_increment\", \"field\": \"percent_increment\"},\n        \"range\": [\"#888\", \"#008eff\"]\n      }\n    ],\n    \"axes\": [\n      {\n        \"orient\": \"bottom\",\n        \"grid\": true,\n        \"gridColor\": \"#ccc\",\n        \"gridDash\": [1, 4],\n        \"scale\": \"x\",\n        \"labelFontSize\": 8,\n        \"domain\": false,\n        \"ticks\": false,\n        \"encode\": {\n          \"labels\": {\n            \"update\": {\n              \"text\": {\n                \"signal\": \"datum.value === 0? '' : format(datum.value*1, '+.1%')\"\n              },\n              \"grid\": {\n                  \"gridOpacity\": {\n                      \"signal\": \"datum.value === 0 ? 0:1\"\n                  }\n              }\n            }\n          }\n        }\n      }\n    ],\n    \"marks\": [\n        {   \n            \"name\": \"axis-legend\",\n            \"type\": \"text\",\n            \"encode\": {\n                \"enter\": {\n                    \"x\": {\n                        \"signal\": \"scale('x', 0)\"\n                    },\n                    \"y\": {\n                        \"signal\": \"height + 15\"\n                    },\n                    \"text\": {\n                        \"value\": \"Keyword frequency@deviation H2020 vs FP7\"                        \n                    },\n                    \"align\": {\n                        \"value\": \"center\"\n                    },\n                    \"lineBreak\": {\n                        \"signal\": \"lineBreak\"\n                    },\n                    \"fontSize\": {\n                        \"value\": 9\n                    },\n                    \"fill\": {\n                        \"signal\": \"colorAnnotation\"\n                    }\n                }\n            }\n        },\n      {\n        \"name\": \"legend-right\",\n        \"type\": \"text\",\n        \"encode\": {\n          \"enter\": {\n            \"fill\": {\n              \"signal\": \"colorAnnotation\"\n            },\n            \"x\": {\n              \"signal\": \"scale('x', 0) + 25\"\n            },\n            \"y\": {\n              \"value\": 5\n            },\n            \"text\": {\n              \"value\": \"Topics with more presence@over time →\"\n            },\n            \"lineBreak\": {\n              \"signal\": \"lineBreak\"\n            },\n            \"align\": {\n              \"value\": \"left\"\n            },\n            \"fontStyle\": {\n                \"value\": \"italic\"\n            }\n        }\n        }\n      },\n      {\n        \"name\": \"legend-left\",\n        \"type\": \"text\",\n        \"encode\": {\n          \"enter\": {\n            \"fill\": {\n              \"signal\": \"colorAnnotation\"\n            },\n            \"x\": {\n              \"signal\": \"scale('x', 0) - 25\"\n            },\n            \"y\": {\n              \"value\": 5\n            },\n            \"text\": {\n              \"value\": \"Topics with less presence@← over time\"\n            },\n            \"lineBreak\": {\n              \"signal\": \"lineBreak\"\n            },\n            \"align\": {\n              \"value\": \"right\"\n            },\n            \"fontStyle\": {\n                \"value\": \"italic\"\n            }\n        }\n        }\n      },\n      {\n        \"name\": \"threshold\",\n        \"type\": \"rule\",\n        \"encode\": {\n          \"enter\": {\n            \"x\": {\"signal\": \"scale('x', 0)\"},\n            \"x2\": {\"signal\": \"scale('x', 0)\"},\n            \"y\": {\"value\": 0},\n            \"y2\": {\"signal\": \"height\"},\n            \"stroke\": {\"value\": \"#666\"},\n            \"strokeDash\": {\"value\": [1,4]}\n          }\n        }\n      },\n      {\n        \"name\": \"keyword-groups\",\n        \"type\": \"group\",\n       \"from\": {\n          \"facet\": {\n            \"data\": \"keywords\",\n            \"name\": \"facet\",\n            \"groupby\": [\"keyword\", \"percent_increment\", \"total\"]\n          }\n        },\n        \"encode\": {\n          \"enter\": {\n            \"xfocus\": {\"scale\": \"x\", \"field\": \"percent_increment\"},\n            \"yfocus\": {\"signal\": \"cy\"}\n          }\n        },\n        \"marks\": [            \n              {\n                \"name\": \"nodes-circles-fp7\",\n                \"description\": \"Colored circles for FP7 (will be masked later)\",\n                \"type\": \"symbol\",\n                \"from\": {\"data\": \"facet\"},\n                \"encode\": {\n                  \"enter\": {\n                    \"xfocus\": {\"scale\": \"x\", \"field\": \"percent_increment\"},\n                    \"yfocus\": {\"signal\": \"cy\"},\n                    \"fill\":  {\n                        \"signal\": \"scale((datum.percent_increment < 0? 'color_negative':'color_positive'), datum.percent_increment)\"\n                      },\n                    \"stroke\": {\n                        \"signal\": \"scale((datum.percent_increment < 0? 'color_negative':'color_positive'), datum.percent_increment)\"\n                      },\n                    \"strokeDash\": {\"value\": [1,1]},\n                    \"strokeOpacity\": {\"value\": 0.35},\n                    \"fillOpacity\": {\"value\": 0.2}\n                  },\n                  \"update\": {\n                    \"size\": {\"signal\": \"scale('r', datum.total)*20\"},          \n                    \"zindex\": {\"value\": 0}\n                  }\n                }\n              },\n              {\n                \"name\": \"nodes-texts\",\n                \"type\": \"text\",              \n                \"from\": {\"data\": \"facet\"},\n                \"encode\": {\n                  \"enter\": {\n                    \"text\": {\"field\": \"keyword\"},\n                    \"align\": {\"value\": \"center\"},\n                    \"lineBreak\": {\"value\": \" \"},\n                    \"fill\": {\n                        \"signal\": \"scale((datum.percent_increment < 0? 'color_negative':'color_positive'), datum.percent_increment)\"\n                      },\n                      \"dy\": {\n                          \"signal\": \"-scale('font', datum.total) * 0.2\"\n                        }\n                  },\n                  \"update\": {\n                    \"fontSize\": {\"signal\": \"scale('font', datum.total)\"},          \n                    \"zindex\": {\"value\": 0}\n                  }\n                }\n              }\n        ],\n        \"transform\": [\n          {\n            \"type\": \"force\",\n            \"iterations\": 300,\n            \"static\": true,\n            \"forces\": [\n              {\n                \"force\": \"collide\",\n                \"iterations\": 1,\n                \"radius\": {\"expr\": \"scale('r', datum.datum.total) * 0.45\"}\n              },\n              {\"force\": \"x\", \"x\": \"xfocus\", \"strength\": {\"signal\": \"gravityX\"}},\n              {\"force\": \"y\", \"y\": \"yfocus\", \"strength\": {\"signal\": \"gravityY\"}}\n            ]\n          }\n        ]\n      }       \n    ]\n  };","import React, { Component } from 'react';\nimport * as _ from 'lodash';\nimport VegaChart from '../common/vega/VegaChart';\nimport { areaChart } from '../common/vega/VegaSpecifications';\nimport * as d3 from 'd3';\nimport textures from 'textures';\n\n\nclass AreaCharts extends Component {\n\n\n    render() {\n       const { areaChartValues, excludedIndicators } = this.props;\n\n        let clonedValues = [...areaChartValues]\n        if (excludedIndicators) {\n\n            var i;\n             for (i = 0; i < excludedIndicators.length; i++) {\n                 delete clonedValues[excludedIndicators[i]]\n             }\n        }\n\n\n        return <div className=\"col justify-content-md-center\">\n            <div className=\"row row-cols-1 row-cols-md-3 row-cols-lg-4\">\n                {\n                    clonedValues.map(function (SDG, index) {\n                        let sdgClass = _.replace(_.first(SDG)['SDG'], ' ', '');\n                        let color = _.first(SDG).color;\n\n                        return <div key={index} className={\"col p-1 area-placeholder area-placeholder-\" + index}>\n                            <div className={\"w-100 h-100 d-flex flex-wrap area-icon pt-4 area-icon-\" + index}>\n                                <VegaChart\n                                    chartClass={'area w-100 mt-auto ' + sdgClass}\n                                    height={80}\n                                    data={ clonedValues[index]}\n                                    spec={areaChart}\n                                    runAfterCallback={view => {\n                                        const t = textures.lines().size(4).strokeWidth(1).stroke(color);\n                                        const svg = d3.selectAll('.area.' + sdgClass + ' svg');\n                                        svg.call(t);\n                                        svg.selectAll('g.mark-area.role-mark path').style('fill', t.url());\n                                    }}\n                                />\n                            </div>\n                        </div>\n                    })\n                }\n            </div>\n        </div>\n    }\n}\n\nexport default AreaCharts;","import React, { Component } from 'react';\nimport * as _ from 'lodash';\nimport * as d3 from 'd3';\nimport VegaChart from '../../common/vega/VegaChart';\nimport VegaSignalListener from '../../common/vega/VegaSignalListener';\nimport { areaChart, areaChartAll } from '../../common/vega/VegaSpecifications';\nimport textures from 'textures';\nimport { SDG_INFO } from '../../common'\nimport projectsData from '../../data/areacharts/sdgs_projects_by_year.json'\nimport scrollama from 'scrollama';\nimport AreaCharts from '../../components/AreaCharts'\n\nvar Stickyfill = require('stickyfill');\n\nclass Introduction extends Component {\n\n    constructor() {\n        super();\n        this.state = {\n            loading: true,\n            fundingAreaChartValues: [],\n            projectsAreaChartValues: []\n        }\n        this.vegaViews = [];\n\n    }\n\n    componentDidMount() {\n        var scrolly = d3.select('#scrolly2');\n        var figure = scrolly.select('figure');\n        var figureHeight = !this.props.isMobile ? figure.node().getBoundingClientRect().height : 400;\n        var article = scrolly.select('article');\n        var step = article.selectAll('.step');\n\n\n        // initialize the scrollama\n        var scroller = scrollama();\n        // generic window resize listener event\n        function handleResize() {\n            // update height of step elements\n            step.style('height', function(d, i) {\n                return Math.floor(window.innerHeight * (i === 0? 0.1 : 0.75)) + 'px';\n            })\n            scroller.resize();\n        }\n\n        // scrollama event handlers\n        function handleStepEnter(response) {\n            let showGraphs = (response.index === 0 || response.index === 4);\n\n            d3.selectAll('.area-placeholder')\n                .style('opacity', showGraphs? 1:0.15);\n            \n            d3.select('#scrolly2 article')\n                .style('pointer-events', showGraphs? 'none':'auto');\n\n            if(!showGraphs) {\n                var sdgs;\n                switch(response.index) {\n                    case 1: sdgs = [0,1]; break;\n                    case 2: sdgs = [11,12]; break;\n                    case 3: sdgs = [4]; break;\n                    default: break;\n                }\n                sdgs.forEach(i => d3.select('.area-placeholder.area-placeholder-'+i).style('opacity', 1));\n            }\n        }\n\n        function setupStickyfill() {\n            d3.selectAll('.sticky').each(function () {\n                Stickyfill.add(this);\n            });\n        }\n\n        function init() {\n            setupStickyfill();\n            handleResize();\n            scroller.setup({\n                step: '#scrolly2 article .step',\n                offset: 0.66,\n                debug: false,\n                progress: false\n            }).onStepEnter(handleStepEnter);\n\n            window.addEventListener('resize', handleResize);\n        }\n\n        // kick things off\n        !this.props.isMobile && init();\n\n        // Data for SDGs evolution\n        let allProjects = [];\n\n        Object.entries(SDG_INFO).forEach(function (SDG) {\n\n            // let singular = _.map(fundingData, function (entry) {\n            let singular = _.map(projectsData, function (entry) {\n\n                if (entry.SDG === SDG[0]) {\n                    entry.color = SDG[1].color;\n                    entry.title = SDG[1].title;\n                    entry.shortTitle = SDG[1].shortTitle;\n                    return entry\n                }\n\n            });\n            singular = _.without(singular, undefined)\n            allProjects.push(singular)\n\n        })\n\n        this.setState({\n            projectsAreaChartValues: allProjects,\n            areaChartHeight: figureHeight\n        })\n    }\n\n    onVegaViewCreated = vegaView => {\n        this.vegaViews = this.vegaViews.concat(vegaView);\n    }\n\n    render() {\n\n        let hoverListener = new VegaSignalListener('symbolMouseover', (name, value, view) => {\n            this.vegaViews.forEach(vegaView => {\n                if (vegaView !== view) {\n                    vegaView.signal('symbolHighlight', value);\n                    vegaView.runAsync();\n                }\n            })\n        });\n\n        let that = this;\n        const { projectsAreaChartValues, areaChartHeight } = this.state;\n\n        return <div className=\"container-fluid\">\n            <div className=\"container intro-block\">\n                <div className=\"row\">\n                    <div className=\"col-12 col-md-5\">\n                        <p style={{margin: '2rem 0 0 0'}}>\n                            The first noteworthy result of the analysis is that\n                        </p>\n                        <br/>\n                        <h5>\n                            the number of SDG-related projects has grown from 29% to 35%<sup>*</sup> between the two framework programmes (FP7 to H2020).\n                        </h5>\n                        <span className=\"note\"><sup>*</sup>SDGs 8 and 9 excluded from the analysis.</span>\n                    </div>\n                    <div className=\"col-12 col-md-7 text-center\">\n                        <VegaChart\n                            id={\"area-chart-all-container\"}\n                            chartClass={'area-chart-all-container'}\n                            spec={areaChartAll}\n                            data={projectsData}\n                            height={250}\n                            onVegaViewCreated={that.onVegaViewCreated}\n                            runAfterCallback={view => {\n                                const t = textures.lines().size(4).strokeWidth(1).stroke('#19486A');\n                                const svg = d3.select('.area-chart-all-container svg');\n                                svg.call(t);\n\n                                svg.select('g.mark-area path').style('fill', t.url());\n\n                                svg.select('.mark-group.role-legend-entry .mark-group > g:last-child')\n                                    .select('.role-legend-symbol path')\n                                    .style('fill', t.url());\n                            }}\n                            signalListeners={[hoverListener]}\n                        />\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"divider divider-white2grey\"/>\n            <div className='container-fluid title-section bg-light' >\n                <div className=\"row justify-content-md-center\">\n                    <div className=\" align-self-center col-12 col-lg-8 text-center\">\n                        <h1 className=\"mt-5 mb-3\">\n                            Annual share of SDG-related funded projects, by goal\n                        </h1>\n                    </div>\n                </div>\n            </div>\n            {this.props.isMobile ?\n                <section className=\"d-block d-md-none container-fluid bg-light\">\n                    <div className=\"container\">\n\n                        <div className=\"row\">\n                            <div className=\"col\">\n                                <p>Some Goals have gathered more attention recently, in particular those addressing the most vulnerable, such <strong>No Poverty and  Zero Hunger</strong>.</p>\n                                <AreaCharts areaChartValues={projectsAreaChartValues}\n                                    excludedIndicators={[2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]} />\n                            </div>\n                        </div>\n                        <div className=\"row\">\n                            <div className=\"col\">\n                                <p>And those addressing global environmental threats and a more sustainable development, like <strong>Climate action and Responsible Consumption and Production</strong></p>\n                                <AreaCharts areaChartValues={projectsAreaChartValues}\n                                    excludedIndicators={[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15]} />\n                            </div>\n                        </div>\n\n                        <div className=\"row\">\n                            <div className=\"col\">\n                                <p>Also <strong>Gender Equality</strong> is the object of a growing number of projects, and is also of great concern in the orientations and regulations of the whole funding programme.</p>\n                                <AreaCharts areaChartValues={projectsAreaChartValues}\n                                    excludedIndicators={[0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]} />\n                            </div>\n                        </div>\n                        <div className=\"row border-top pt-4 mt-4\">\n                            <div className=\"col\">\n                                <AreaCharts areaChartValues={projectsAreaChartValues}\n                                    excludedIndicators={[0, 1, 4, 11, 12]} />\n                            </div>\n                        </div>\n                    </div>\n                </section>\n                :\n                <section id=\"scrolly2\" className=\"scrolly scrolly-introduction container-fluid bg-light\">\n                    <figure>\n                        <div className=\"container\">\n                            <div className=\"row\">\n                                {\n                                    (projectsAreaChartValues.length > 0) && <div className=\"col justify-content-md-center\">\n                                        <div className=\"row row-cols-2 row-cols-md-3 row-cols-lg-4\">\n                                            {\n                                                projectsAreaChartValues.map(function (SDG, index) {\n                                                    let sdgClass = _.replace(_.first(SDG)['SDG'], ' ', '');\n                                                    let color = _.first(SDG).color;\n                                                    return <div key={index} className={\"col p-0 p-xl-1 area-placeholder area-placeholder-\" + index}>\n                                                        <div className={\"w-100 h-100 d-flex flex-wrap area-icon pt-4 area-icon-\" + index}>\n                                                            <VegaChart\n                                                                chartClass={'area w-100 mt-auto ' + sdgClass}\n                                                                height={areaChartHeight / 8}\n                                                                data={projectsAreaChartValues[index]}\n                                                                spec={areaChart}\n                                                                onVegaViewCreated={that.onVegaViewCreated}\n                                                                signalListeners={[hoverListener]}\n                                                                runAfterCallback={view => {\n                                                                    const t = textures.lines().size(4).strokeWidth(1).stroke(color);\n                                                                    const svg = d3.selectAll('.area.' + sdgClass + ' svg');\n                                                                    svg.call(t);\n                                                                    svg.selectAll('g.mark-area.role-mark path').style('fill', t.url());\n                                                                }}\n                                                            />\n                                                        </div>\n                                                    </div>\n                                                })\n                                            }\n                                        </div>\n                                    </div>\n                                }\n                            </div>\n                        </div>\n                    </figure>\n\n                    <article>\n                        <div className='step' data-step='0'>\n                            <p style={{ display: 'none' }}></p>\n                        </div>\n                        <div className='step' data-step='1'>\n                            <p>\n                                Some Goals have gathered more attention recently, in particular those addressing the most vulnerable, such as <i><strong>Goal 1: End poverty in all its forms everywhere</strong> and <strong>Goal 2: Zero Hunger</strong></i>.\n                            </p>\n                        </div>\n                        <div className='step' data-step='2'>\n                            <p>\n                                In parallel, those addressing global environmental threats and a more sustainable development, like <i><strong>Goal 13: Take urgent action to combat climate change and its impact</strong> and <strong>Goal 12: Ensure sustainable consumption and production patterns</strong></i>, have also grown in importance.\n                            </p>\n                        </div>\n                        <div className='step' data-step='3'>\n                            <p>\n                                Also, <i><strong>Goal 5: Achieve gender equality and empower all women and girls</strong></i> is the object of a growing number of projects, and, transversally, is of greater concern in the orientations and regulations of Horizon 2020, affecting all funded projects.\n                            </p>\n                        </div>\n                        <div className='step' data-step='4'>\n                            <p style={{ display: 'none' }}></p>\n                        </div>\n                    </article>\n\n                </section>\n            }\n\n        </div >\n    }\n}\n\n\nexport default Introduction;","import React, { Component } from 'react';\nimport sirisWhite from '../images/siris_logo_menu1.png'\n\nclass Header extends Component {\n\n    getHeaderContent() {\n        return <div className=\"row\">\n                <div className=\"col-12 col-md-7\">\n                    <h6 className=\"global-preloader text-white\">\n                        <img src='/images/preloader.gif' style={{maxHeight:'20px', opacity:'0.8', paddingRight:'5px'}}></img><span id=\"global-preloader\">Processing data...</span>\n                    </h6>         \n                    <h1 className=\"header_title\"><span className=\"\">Is EU-funded research and innovation evolving towards topics related to the Sustainable Development Goals?</span></h1>\n                    <div className=\"sub-header mb-4\">\n                        <p className=\"d-inline-block mr-2\">A visual essay made by <span className=\"d-inline-block d-md-none\">SIRIS Academic</span></p>\n                        <a href=\"http://www.sirisacademic.com\" target='_blank' rel=\"noopener noreferrer\"><img className=\"d-none d-md-inline-block\" src={sirisWhite} alt=\"SIRIS ACADEMIC\"/></a>\n                    </div>                \n                </div>\n                <div className=\"col-12 col-md-5\" style={{fontSize: '0.85rem', opacity:'0.8', lineHeight: '1.6'}}>      \n                    <p style={{color:'whitesmoke'}}>\n                        <img src='/images/DG logo with UN Emblem_Square_Web_transparent-white.png' style={{maxWidth:'25%', paddingRight:'10px'}} align=\"left\"></img>\n                        In the European Union, the <a style={{color:'whitesmoke'}} rel=\"noopener noreferrer\" href='https://ec.europa.eu/commission/publications/reflection-paper-towards-sustainable-europe-2030_en' target='_blank'>Agenda 2030 is preeminent in the strategic framework</a> guiding the next programming period; most or all policy areas are impacted and necessary to achieve the desired progress towards the goals. Particularly, in the <a style={{color:'whitesmoke'}} rel=\"noopener noreferrer\" href='https://ec.europa.eu/info/horizon-europe-next-research-and-innovation-framework-programme_en' target='_blank'>new Research and Innovation Framework Programme</a> of the European Commission, Horizon Europe, the SDGs set the stage for “Clusters in the Global Challenges and Industrial Competitiveness pillar” and the research and innovation <a style={{color:'whitesmoke'}} rel=\"noopener noreferrer\" href='https://ec.europa.eu/info/horizon-europe-next-research-and-innovation-framework-programme/missions-horizon-europe_en' target='_blank'>Missions</a>.\n                    </p>\n                    <p style={{color:'whitesmoke'}}>\n                        <strong>To better understand how science, technology and innovation efforts are thematically related to the Sustainable Development Goals (SDGs), <a href='http://www.sirisacademic.com/wb/' style={{color:'whitesmoke'}} target='_blank' rel=\"noopener noreferrer\">SIRIS Academic</a> developed a novel methodology to identify SDG-related texts and classify them into the first 16 SDGs.</strong>\n                    </p>\n                </div>\n            </div>\n        \n    }\n\n    getFooterContent() {\n        return <div className=\"row justify-content-md-center\">\n            <div className=\"align-self-center col-12\">\n                <h1>Methodology and data source</h1>\n                <p>\n                    This project has been possible thanks to the open data provided by the European Commission on FP7 and H2020 projects:<br/> © European Union, 1994-2020 CORDIS, <a href=\"https://cordis.europa.eu/\" target='_blank' rel=\"noopener noreferrer\">cordis.europa.eu</a>\n                </p>\n                <p>\n                    Behind these visualisations, there is a complex <strong>3-step process</strong> that allowed us to link the text of the abstracts of EC-funded research projects to their respective Sustainable Development Goals. The process combines <strong>domain knowledge</strong>, <strong>machine learning technologies</strong> and <strong>ad hoc crafted data visualization</strong>.\n                </p>\n                <ol>\n                    <li>\n                        <h4>\n                            Creation of a controlled vocabulary for the case of the Sustainable Development Goals\n                        </h4>\n                        <p>\n                            The first step of the process is the creation of a controlled set of terms (a vocabulary) for each of the Sustainable Development Goals.\n                            In doing so, we rely both on <strong>expert knowledge</strong> (namely, to define and limit the “semantic” breadth of each SDG) and on <strong>machine learning</strong> to rapidly scale the set of key terms defined by the domain experts\n                        </p>\n                        <p>\n                            Our vocabulary is constructed by means of the following methodology:\n                        </p>\n                        <ul>\n                            <li>\n                                Qualitative desk research: We start by reading policy documents, reports and technical documents produced by the UN on the Sustainable Development Goals. This purely human effort allows us to identify an initial set of seed keywords for each SDG.\n                            </li>\n                            <li>\n                                Application of Machine learning: The seed keywords are expanded by machine learning methods. We use both deep learning and AI reasoning on ontologies: on the one hand, a neural network model is trained on a reference textual corpus and it is used to retrieve all synonyms of the seed keywords it learned. On the other, we rely on the ontologies built on top of knowledge repositories to harvest all terms that are logically linked with the seed keywords.\n                            </li>\n                            <li>\n                                Human revision: A final quality check of the results produced by the automated method is performed, to ensure results are in line with the initial definition of the perimeter of the SDGs.\n                            </li>\n                        </ul>\n                        <p></p>\n                    </li>\n\n                    <li>\n                        <h4>\n                            Indexing of the textual records per SDG\n                        </h4>\n                        <p>\n                            Once the vocabulary is created, it must be used to identify pertinent texts and to link them to their respective SDGs.\n                        </p>\n                        <p>\n                            To do so, we use Natural Language Processing techniques: we retrieve the textual records, we process them and we match their content to the vocabulary.\n                        </p>\n                        <p>\n                            We do so in a smart way: we allow up to a certain distance between terms in a keyword, we take into account both plural and singular nouns and we consider contextual terms for the most generic keywords, to avoid indexing “false positive” projects. For instance, the key term “woman’s rights” would match the sentence “empowering the right of all women around the world to choose”.\n                        </p>\n                    </li>\n\n                    <li>\n                        <h4>\n                            Crafting of the interactive visualisations\n                        </h4>\n                        <p>\n                            Multiple analyses can be done in relation to mapping Science Technology and Innovation (STI) efforts towards the SDGs, and there are many possible conclusions, that however remain only preliminary.\n                        </p>\n                        <p>\n                            To foster the conversation around the topic and to drive actions, we make use of data-driven storytelling, in order to provide a guidance to the discussion through the visualizations. In doing so, we combine explanatory and exploratory approaches, where narrative and interaction coexist together.    \n                        </p>\n                        <p>\n                            Data is presented to the user from different points of view, where complexity increases slowly. Our view of STI contributions to SDGs starts from annual shares of SDG-related funded projects, explores how countries feature a different SDG R&I portfolio, it goes on to highlight similarities of such countries and it ends up by showing trends on R&I based on SDG-related keywords.\n                        </p>\n                        <p>\n                            For each analysis around the data, we carefully thought  of specific ad-hoc crafted visuals, aimed at revealing effectively the different types of knowledge, from patterns around research activity, behaviours on how countries can be clustered together, or trends over time.\n                        </p>\n                        <p>\n                            When designing information, we take care about choosing effective visuals, eliminate the clutter and focus attention to what matters.\n                        </p>\n                        <p>\n                            We conduct all this process through a transversal co-design approach: involving actors and stakeholders from the beginning, getting from them the questions they need to answer and ideating interactive visualizations to find responses and meaning from the data.   \n                        </p>\n                    </li>\n                </ol>                              \n            </div>            \n        </div>\n    }\n\n\n\n\n    render() {\n        return <div className={\"header-canvas \" + this.props.canvasId + (this.props.canvasId === 'canvas-footer'? ' bg-light':'')}>                        \n        {/* <HeaderMosaic canvasId = {this.props.canvasId} direction={this.props.direction} probability={0.9}/> */}\n                <div className=\"container\">\n                    { this.props.canvasId === 'canvas-header'?\n                        this.getHeaderContent() : \n                        this.getFooterContent()\n                    }\n                </div>\n        </div>\n    }\n}\n\nexport default Header;","\n// Vega creates an SVG with a main <g> containing a transform translate.\n// Get the y translation of the transform\nexport function getMarginTopFromVegaSVG(svgD3Selection) {\n    var svgMargins = svgD3Selection.select('g').attr('transform');\n    return parseInt(svgMargins.substring(svgMargins.lastIndexOf(',')+1, svgMargins.length-1)) || 0;\n}","\n/*!\n * wordcloud2.js\n * http://timdream.org/wordcloud2.js/\n *\n * Copyright 2011 - 2019 Tim Guan-tin Chien and contributors.\n * Released under the MIT license\n */\nimport * as d3 from 'd3';\nimport paper from 'paper';\nimport {getMarginTopFromVegaSVG} from '../../common/vega/VegaUtils'; \n\n// setImmediate\nif (!window.setImmediate) {\n  window.setImmediate = (function setupSetImmediate() {\n    return window.msSetImmediate ||\n    window.webkitSetImmediate ||\n    window.mozSetImmediate ||\n    window.oSetImmediate ||\n    (function setupSetZeroTimeout() {\n      if (!window.postMessage || !window.addEventListener) {\n        return null;\n      }\n\n      var callbacks = [undefined];\n      var message = 'zero-timeout-message';\n\n      // Like setTimeout, but only takes a function argument.  There's\n      // no time argument (always zero) and no arguments (you have to\n      // use a closure).\n      var setZeroTimeout = function setZeroTimeout(callback) {\n        var id = callbacks.length;\n        callbacks.push(callback);\n        window.postMessage(message + id.toString(36), '*');\n\n        return id;\n      };\n\n      window.addEventListener('message', function setZeroTimeoutMessage(evt) {\n        // Skipping checking event source, retarded IE confused this window\n        // object with another in the presence of iframe\n        if (typeof evt.data !== 'string' ||\n            evt.data.substr(0, message.length) !== message/* ||\n            evt.source !== window */) {\n          return;\n        }\n\n        evt.stopImmediatePropagation();\n\n        var id = parseInt(evt.data.substr(message.length), 36);\n        if (!callbacks[id]) {\n          return;\n        }\n\n        callbacks[id]();\n        callbacks[id] = undefined;\n      }, true);\n\n      /* specify clearImmediate() here since we need the scope */\n      window.clearImmediate = function clearZeroTimeout(id) {\n        if (!callbacks[id]) {\n          return;\n        }\n\n        callbacks[id] = undefined;\n      };\n\n      return setZeroTimeout;\n    })() ||\n    // fallback\n    function setImmediateFallback(fn) {\n      window.setTimeout(fn, 0);\n    };\n  })();\n}\n\nif (!window.clearImmediate) {\n  window.clearImmediate = (function setupClearImmediate() {\n    return window.msClearImmediate ||\n    window.webkitClearImmediate ||\n    window.mozClearImmediate ||\n    window.oClearImmediate ||\n    // \"clearZeroTimeout\" is implement on the previous block ||\n    // fallback\n    function clearImmediateFallback(timer) {\n      window.clearTimeout(timer);\n    };\n  })();\n}\n\n(function(global) {\n  // Check if WordCloud can run on this browser\n  var isSupported = (function isSupported() {\n    var canvas = document.createElement('canvas');\n    if (!canvas || !canvas.getContext) {\n      return false;\n    }\n\n    var ctx = canvas.getContext('2d');\n    if (!ctx) {\n      return false;\n    }\n    if (!ctx.getImageData) {\n      return false;\n    }\n    if (!ctx.fillText) {\n      return false;\n    }\n\n    if (!Array.prototype.some) {\n      return false;\n    }\n    if (!Array.prototype.push) {\n      return false;\n    }\n\n    return true;\n  }());\n\n  // Find out if the browser impose minium font size by\n  // drawing small texts on a canvas and measure it's width.\n  var minFontSize = (function getMinFontSize() {\n    if (!isSupported) {\n      return;\n    }\n\n    var ctx = document.createElement('canvas').getContext('2d');\n\n    // start from 20\n    var size = 20;\n\n    // two sizes to measure\n    var hanWidth, mWidth;\n\n    while (size) {\n      ctx.font = size.toString(10) + 'px sans-serif';\n      if ((ctx.measureText('\\uFF37').width === hanWidth) &&\n          (ctx.measureText('m').width) === mWidth) {\n        return (size + 1);\n      }\n\n      hanWidth = ctx.measureText('\\uFF37').width;\n      mWidth = ctx.measureText('m').width;\n\n      size--;\n    }\n\n    return 0;\n  })();\n\n  // Based on http://jsfromhell.com/array/shuffle\n  var shuffleArray = function shuffleArray(arr) {\n    for (var j, x, i = arr.length; i;\n      j = Math.floor(Math.random() * i),\n      x = arr[--i], arr[i] = arr[j],\n      arr[j] = x) {}\n    return arr;\n  };\n\n  var WordCloud = function WordCloud(elements, options) {\n    if (!isSupported) {\n      return;\n    }\n\n    if (!Array.isArray(elements)) {\n      elements = [elements];\n    }\n\n    elements.forEach(function(el, i) {\n      if (typeof el === 'string') {\n        elements[i] = document.getElementById(el);\n        if (!elements[i]) {\n          throw new Error('The element id specified is not found.');\n        }\n      } else if (!el.tagName && !el.appendChild) {\n        throw new Error('You must pass valid HTML elements, or ID of the element.');\n      }\n    });\n\n    /* Default values to be overwritten by options object */\n    var settings = {\n      list: [],\n      fontFamily: '\"Trebuchet MS\", sans-serif',\n      fontWeight: 'lighter',\n      color: 'random-dark',\n      minSize: 0, // 0 to disable\n      weightFactor: 1,\n      scaleOpacity: null,\n      clearCanvas: true,\n      backgroundColor: '#fff',  // opaque white = rgba(255, 255, 255, 1)\n\n      gridSize: 8,\n      drawOutOfBound: false,\n      shrinkToFit: false,\n      origin: null,\n\n      drawMask: false,\n      maskColor: 'rgba(255,0,0,0.3)',\n      maskGapWidth: 0.3,\n\n      wait: 0,\n      abortThreshold: 0, // disabled\n      abort: function noop() {},\n\n      minRotation: - Math.PI / 2,\n      maxRotation: Math.PI / 2,\n      rotationSteps: 0,\n\n      shuffle: true,\n      rotateRatio: 0.1,\n\n      shape: 'circle',\n      ellipticity: 0.65,\n\n      classes: null,\n\n      hover: null,\n      click: null,\n\n      meta: null\n    };\n\n    if (options) {\n      for (var key in options) {\n        if (key in settings) {\n          settings[key] = options[key];\n        }\n      }\n    }\n\n    // get vertical translation in the main <g> of the vega SVG\n    settings.marginTop = getMarginTopFromVegaSVG(d3.select('.stream-river svg.marks'));\n\n    /* Convert weightFactor into a function */\n    if (typeof settings.weightFactor !== 'function') {\n      var factor = settings.weightFactor;\n      settings.weightFactor = function weightFactor(pt) {\n        return pt * factor; //in px\n      };\n    }\n\n    /* Convert shape into a function */\n    if (typeof settings.shape !== 'function') {\n      switch (settings.shape) {\n        case 'circle':\n        /* falls through */\n        default:\n          // 'circle' is the default and a shortcut in the code loop.\n          settings.shape = 'circle';\n          break;\n\n        case 'cardioid':\n          settings.shape = function shapeCardioid(theta) {\n            return 1 - Math.sin(theta);\n          };\n          break;\n\n        /*\n\n        To work out an X-gon, one has to calculate \"m\",\n        where 1/(cos(2*PI/X)+m*sin(2*PI/X)) = 1/(cos(0)+m*sin(0))\n        http://www.wolframalpha.com/input/?i=1%2F%28cos%282*PI%2FX%29%2Bm*sin%28\n        2*PI%2FX%29%29+%3D+1%2F%28cos%280%29%2Bm*sin%280%29%29\n\n        Copy the solution into polar equation r = 1/(cos(t') + m*sin(t'))\n        where t' equals to mod(t, 2PI/X);\n\n        */\n\n        case 'diamond':\n          // http://www.wolframalpha.com/input/?i=plot+r+%3D+1%2F%28cos%28mod+\n          // %28t%2C+PI%2F2%29%29%2Bsin%28mod+%28t%2C+PI%2F2%29%29%29%2C+t+%3D\n          // +0+..+2*PI\n          settings.shape = function shapeSquare(theta) {\n            var thetaPrime = theta % (2 * Math.PI / 4);\n            return 1 / (Math.cos(thetaPrime) + Math.sin(thetaPrime));\n          };\n          break;\n\n        case 'square':\n          // http://www.wolframalpha.com/input/?i=plot+r+%3D+min(1%2Fabs(cos(t\n          // )),1%2Fabs(sin(t)))),+t+%3D+0+..+2*PI\n          settings.shape = function shapeSquare(theta) {\n            return Math.min(\n              1 / Math.abs(Math.cos(theta)),\n              1 / Math.abs(Math.sin(theta))\n            );\n          };\n          break;\n\n        case 'triangle-forward':\n          // http://www.wolframalpha.com/input/?i=plot+r+%3D+1%2F%28cos%28mod+\n          // %28t%2C+2*PI%2F3%29%29%2Bsqrt%283%29sin%28mod+%28t%2C+2*PI%2F3%29\n          // %29%29%2C+t+%3D+0+..+2*PI\n          settings.shape = function shapeTriangle(theta) {\n            var thetaPrime = theta % (2 * Math.PI / 3);\n            return 1 / (Math.cos(thetaPrime) +\n                        Math.sqrt(3) * Math.sin(thetaPrime));\n          };\n          break;\n\n        case 'triangle':\n        case 'triangle-upright':\n          settings.shape = function shapeTriangle(theta) {\n            var thetaPrime = (theta + Math.PI * 3 / 2) % (2 * Math.PI / 3);\n            return 1 / (Math.cos(thetaPrime) +\n                        Math.sqrt(3) * Math.sin(thetaPrime));\n          };\n          break;\n\n        case 'pentagon':\n          settings.shape = function shapePentagon(theta) {\n            var thetaPrime = (theta + 0.955) % (2 * Math.PI / 5);\n            return 1 / (Math.cos(thetaPrime) +\n                        0.726543 * Math.sin(thetaPrime));\n          };\n          break;\n\n        case 'star':\n          settings.shape = function shapeStar(theta) {\n            var thetaPrime = (theta + 0.955) % (2 * Math.PI / 10);\n            if ((theta + 0.955) % (2 * Math.PI / 5) - (2 * Math.PI / 10) >= 0) {\n              return 1 / (Math.cos((2 * Math.PI / 10) - thetaPrime) +\n                          3.07768 * Math.sin((2 * Math.PI / 10) - thetaPrime));\n            } else {\n              return 1 / (Math.cos(thetaPrime) +\n                          3.07768 * Math.sin(thetaPrime));\n            }\n          };\n          break;\n      }\n    }\n\n    /* Make sure gridSize is a whole number and is not smaller than 4px */\n    settings.gridSize = Math.max(Math.floor(settings.gridSize), 4);\n\n    /* shorthand */\n    var g = settings.gridSize;\n    var maskRectWidth = g - settings.maskGapWidth;\n\n    /* normalize rotation settings */\n    var rotationRange = Math.abs(settings.maxRotation - settings.minRotation);\n    var rotationSteps = Math.abs(Math.floor(settings.rotationSteps));\n    var minRotation = Math.min(settings.maxRotation, settings.minRotation);\n\n    /* information/object available to all functions, set when start() */\n    var grid, // 2d array containing filling information\n      ngx, ngy, // width and height of the grid\n      center, // position of the center of the cloud\n      maxRadius;\n\n    /* timestamp for measuring each putWord() action */\n    var escapeTime;\n\n    /* function for getting the color of the text */\n    var getTextColor;\n    function random_hsl_color(min, max) {\n      return 'hsl(' +\n        (Math.random() * 360).toFixed() + ',' +\n        (Math.random() * 30 + 70).toFixed() + '%,' +\n        (Math.random() * (max - min) + min).toFixed() + '%)';\n    }\n    switch (settings.color) {\n      case 'random-dark':\n        getTextColor = function getRandomDarkColor() {\n          return random_hsl_color(10, 50);\n        };\n        break;\n\n      case 'random-light':\n        getTextColor = function getRandomLightColor() {\n          return random_hsl_color(50, 90);\n        };\n        break;\n\n      default:\n        if (typeof settings.color === 'function') {\n          getTextColor = settings.color;\n        }\n        break;\n    }\n\n    /* function for getting the font-weight of the text */\n    var getTextFontWeight;\n    if (typeof settings.fontWeight === 'function') {\n      getTextFontWeight = settings.fontWeight;\n    }\n\n    /* function for getting the classes of the text */\n    /*var getTextClasses = null;\n    if (typeof settings.classes === 'function') {\n      getTextClasses = settings.classes;\n    }*/\n\n    /* Interactive */\n    var interactive = false;\n    var infoGrid = [];\n    var hovered;\n\n    var getInfoGridFromMouseTouchEvent =\n    function getInfoGridFromMouseTouchEvent(evt) {\n      var canvas = evt.currentTarget;\n      var rect = canvas.getBoundingClientRect();\n      var clientX;\n      var clientY;\n      /** Detect if touches are available */\n      if (evt.touches) {\n        clientX = evt.touches[0].clientX;\n        clientY = evt.touches[0].clientY;\n      } else {\n        clientX = evt.clientX;\n        clientY = evt.clientY;\n      }\n      var eventX = clientX - rect.left;\n      var eventY = clientY - rect.top;\n\n      var x = Math.floor(eventX * ((canvas.width / rect.width) || 1) / g);\n      var y = Math.floor(eventY * ((canvas.height / rect.height) || 1) / g);\n\n      return infoGrid[x][y];\n    };\n\n    var wordcloudhover = function wordcloudhover(evt) {\n      var info = getInfoGridFromMouseTouchEvent(evt);\n\n      if (hovered === info) {\n        return;\n      }\n\n      hovered = info;\n      if (!info) {\n        settings.hover(undefined, undefined, evt);\n\n        return;\n      }\n\n      settings.hover(info.item, info.dimension, evt);\n\n    };\n\n    var wordcloudclick = function wordcloudclick(evt) {\n      var info = getInfoGridFromMouseTouchEvent(evt);\n      if (!info) {\n        return;\n      }\n\n      settings.click(info.item, info.dimension, evt);\n      evt.preventDefault();\n    };\n\n    /* Get points on the grid for a given radius away from the center */\n    var pointsAtRadius = [];\n    var getPointsAtRadius = function getPointsAtRadius(radius) {\n      if (pointsAtRadius[radius]) {\n        return pointsAtRadius[radius];\n      }\n\n      // Look for these number of points on each radius\n      var T = radius * 8;\n\n      // Getting all the points at this radius\n      var t = T;\n      var points = [];\n\n      if (radius === 0) {\n        points.push([center[0], center[1], 0]);\n      }\n\n      while (t--) {\n        // distort the radius to put the cloud in shape\n        var rx = 1;\n        if (settings.shape !== 'circle') {\n          rx = settings.shape(t / T * 2 * Math.PI); // 0 to 1\n        }\n\n        // Push [x, y, t]; t is used solely for getTextColor()\n        points.push([\n          center[0] + radius * rx * Math.cos(-t / T * 2 * Math.PI),\n          center[1] + radius * rx * Math.sin(-t / T * 2 * Math.PI) *\n            settings.ellipticity,\n          t / T * 2 * Math.PI]);\n      }\n\n      pointsAtRadius[radius] = points;\n      return points;\n    };\n\n    /* Return true if we had spent too much time */\n    var exceedTime = function exceedTime() {\n      return ((settings.abortThreshold > 0) &&\n        ((new Date()).getTime() - escapeTime > settings.abortThreshold));\n    };\n\n    /* Get the deg of rotation according to settings, and luck. */\n    var getRotateDeg = function getRotateDeg() {\n      if (settings.rotateRatio === 0) {\n        return 0;\n      }\n\n      if (Math.random() > settings.rotateRatio) {\n        return 0;\n      }\n\n      if (rotationRange === 0) {\n        return minRotation;\n      }\n\n      if (rotationSteps > 0) {\n        // Min rotation + zero or more steps * span of one step\n        return minRotation +\n          Math.floor(Math.random() * rotationSteps) *\n          rotationRange / (rotationSteps - 1);\n      }\n      else {\n        return minRotation + Math.random() * rotationRange;\n      }\n    };\n\n    var getTextInfo = function getTextInfo(word, weight, rotateDeg) {\n      // calculate the acutal font size\n      // fontSize === 0 means weightFactor function wants the text skipped,\n      // and size < minSize means we cannot draw the text.\n      var debug = false;\n      var fontSize = settings.weightFactor(weight);\n      if (fontSize <= settings.minSize) {\n        return false;\n      }\n\n      // Scale factor here is to make sure fillText is not limited by\n      // the minium font size set by browser.\n      // It will always be 1 or 2n.\n      var mu = 1;\n      if (fontSize < minFontSize) {\n        mu = (function calculateScaleFactor() {\n          var mu = 2;\n          while (mu * fontSize < minFontSize) {\n            mu += 2;\n          }\n          return mu;\n        })();\n      }\n\n      // Get fontWeight that will be used to set fctx.font\n      var fontWeight;\n      if (getTextFontWeight) {\n        fontWeight = getTextFontWeight(word, weight, fontSize);\n      } else {\n        fontWeight = settings.fontWeight;\n      }\n\n      var fcanvas = document.createElement('canvas');\n      var fctx = fcanvas.getContext('2d', { willReadFrequently: true });\n\n      fctx.font = fontWeight + ' ' +\n        (fontSize * mu).toString(10) + 'px ' + settings.fontFamily;\n\n      // Estimate the dimension of the text with measureText().\n      var fw = fctx.measureText(word).width / mu;\n      var fh = Math.max(fontSize * mu,\n                        fctx.measureText('m').width,\n                        fctx.measureText('\\uFF37').width) / mu;\n\n      // Create a boundary box that is larger than our estimates,\n      // so text don't get cut of (it sill might)\n      var boxWidth = fw + fh * 2;\n      var boxHeight = fh * 3;\n      var fgw = Math.ceil(boxWidth / g);\n      var fgh = Math.ceil(boxHeight / g);\n      boxWidth = fgw * g;\n      boxHeight = fgh * g;\n\n      // Calculate the proper offsets to make the text centered at\n      // the preferred position.\n\n      // This is simply half of the width.\n      var fillTextOffsetX = - fw / 2;\n      // Instead of moving the box to the exact middle of the preferred\n      // position, for Y-offset we move 0.4 instead, so Latin alphabets look\n      // vertical centered.\n      var fillTextOffsetY = - fh * 0.4;\n\n      // Calculate the actual dimension of the canvas, considering the rotation.\n      var cgh = Math.ceil((boxWidth * Math.abs(Math.sin(rotateDeg)) +\n                           boxHeight * Math.abs(Math.cos(rotateDeg))) / g);\n      var cgw = Math.ceil((boxWidth * Math.abs(Math.cos(rotateDeg)) +\n                           boxHeight * Math.abs(Math.sin(rotateDeg))) / g);\n      var width = cgw * g;\n      var height = cgh * g;\n\n      fcanvas.setAttribute('width', width);\n      fcanvas.setAttribute('height', height);\n\n      if (debug) {\n        // Attach fcanvas to the DOM\n        document.body.appendChild(fcanvas);\n        // Save it's state so that we could restore and draw the grid correctly.\n        fctx.save();\n      }\n\n      // Scale the canvas with |mu|.\n      fctx.scale(1 / mu, 1 / mu);\n      fctx.translate(width * mu / 2, height * mu / 2);\n      fctx.rotate(- rotateDeg);\n\n      // Once the width/height is set, ctx info will be reset.\n      // Set it again here.\n      fctx.font = fontWeight + ' ' +\n        (fontSize * mu).toString(10) + 'px ' + settings.fontFamily;\n\n      // Fill the text into the fcanvas.\n      // XXX: We cannot because textBaseline = 'top' here because\n      // Firefox and Chrome uses different default line-height for canvas.\n      // Please read https://bugzil.la/737852#c6.\n      // Here, we use textBaseline = 'middle' and draw the text at exactly\n      // 0.5 * fontSize lower.\n      fctx.fillStyle = '#000';\n      fctx.textBaseline = 'middle';\n      fctx.fillText(word, fillTextOffsetX * mu,\n                    (fillTextOffsetY + fontSize * 0.5) * mu);\n\n      // Get the pixels of the text\n      var imageData = fctx.getImageData(0, 0, width, height).data;\n\n      if (exceedTime()) {\n        return false;\n      }\n\n      if (debug) {\n        // Draw the box of the original estimation\n        fctx.strokeRect(fillTextOffsetX * mu,\n                        fillTextOffsetY, fw * mu, fh * mu);\n        fctx.restore();\n      }\n\n      // Read the pixels and save the information to the occupied array\n      var occupied = [];\n      var gx = cgw, gy, x, y;\n      var bounds = [cgh / 2, cgw / 2, cgh / 2, cgw / 2];\n      while (gx--) {\n        gy = cgh;\n        while (gy--) {\n          y = g;\n          // eslint-disable-next-line\n          singleGridLoop: {\n            while (y--) {\n              x = g;\n              while (x--) {\n                if (imageData[((gy * g + y) * width +\n                               (gx * g + x)) * 4 + 3]) {\n                  occupied.push([gx, gy]);\n\n                  if (gx < bounds[3]) {\n                    bounds[3] = gx;\n                  }\n                  if (gx > bounds[1]) {\n                    bounds[1] = gx;\n                  }\n                  if (gy < bounds[0]) {\n                    bounds[0] = gy;\n                  }\n                  if (gy > bounds[2]) {\n                    bounds[2] = gy;\n                  }\n\n                  if (debug) {\n                    fctx.fillStyle = 'rgba(255, 0, 0, 0.5)';\n                    fctx.fillRect(gx * g, gy * g, g - 0.5, g - 0.5);\n                  }\n                  // eslint-disable-next-line\n                  break singleGridLoop;\n                }\n              }\n            }\n            if (debug) {\n              fctx.fillStyle = 'rgba(0, 0, 255, 0.5)';\n              fctx.fillRect(gx * g, gy * g, g - 0.5, g - 0.5);\n            }\n          }\n        }\n      }\n\n      if (debug) {\n        fctx.fillStyle = 'rgba(0, 255, 0, 0.5)';\n        fctx.fillRect(bounds[3] * g,\n                      bounds[0] * g,\n                      (bounds[1] - bounds[3] + 1) * g,\n                      (bounds[2] - bounds[0] + 1) * g);\n      }\n\n      // Return information needed to create the text on the real canvas\n      return {\n        mu: mu,\n        occupied: occupied,\n        bounds: bounds,\n        gw: cgw,\n        gh: cgh,\n        fillTextOffsetX: fillTextOffsetX,\n        fillTextOffsetY: fillTextOffsetY,\n        fillTextWidth: fw,\n        fillTextHeight: fh,\n        fontSize: fontSize\n      };\n    };\n\n    /* Determine if there is room available in the given dimension */\n    var canFitText = function canFitText(gx, gy, gw, gh, occupied) {\n      // Go through the occupied points,\n      // return false if the space is not available.\n      var i = occupied.length;\n      while (i--) {\n        var px = gx + occupied[i][0];\n        var py = gy + occupied[i][1];\n\n        if (px >= ngx || py >= ngy || px < 0 || py < 0) {\n          if (!settings.drawOutOfBound) {\n            return false;\n          }\n          continue;\n        }\n\n        if (!grid[px][py]) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n    /* Actually draw the text on the grid */\n    var drawText = function drawText(gx, gy, info, word, weight,\n                                     distance, theta, rotateDeg, attributes) {\n      var fontSize = info.fontSize;\n      var color;\n      let datum;\n\n      if (getTextColor) {\n        color = getTextColor(word, weight, fontSize, distance, theta);\n      } else {\n        color = settings.color;\n      }\n\n      /*var bounds = info.bounds;\n      var dimension;\n      dimension = {\n        x: (gx + bounds[3]) * g,\n        y: (gy + bounds[0]) * g,\n        w: (bounds[1] - bounds[3] + 1) * g,\n        h: (bounds[2] - bounds[0] + 1) * g\n      };*/\n\n      elements.forEach(function(el) {        \n         // drawText on SVG element\n         var x = el.offsetLeft + ((gx + info.gw / 2) * g + info.fillTextOffsetX) - info.fillTextOffsetX;\n         // with the y, added a factor 1.5 to place the svg text in the same exact location as the span's position\n         // don't know why there is a difference...\n         var y = el.offsetTop + ((gy + info.gh / 2) * g + info.fillTextOffsetY) - (info.fillTextOffsetY*1.5);\n\n         var transformRule = 'rotate(' + (- rotateDeg / Math.PI * 180) + ', ' + x + ',' + y + ') ';\n          if (info.mu !== 1) {\n            transformRule +=\n              'translate(-' + (info.fillTextWidth / 4) + ' 0) ' +\n              'scale(' + (1 / info.mu) + ' ' + (1 / info.mu) + ')';\n          }\n\n          // get intersection between the two curves and the vertical line\n          // with the x of the text's x value\n          var vLine = new paper.Path();\n          vLine.add( new paper.Point(x, el.offsetTop));\n          vLine.add( new paper.Point(x, el.offsetTop + el.offsetHeight));\n\n          var topIntersect = [];\n          var bottomIntersect = [];\n\n          if(settings.meta.curves) {\n            topIntersect = vLine.getIntersections(settings.meta.curves[0]);\n            bottomIntersect = vLine.getIntersections(settings.meta.curves[1]);\n          }\n\n          let streamRiverSVG = d3.select('.stream-river svg');\n\n\n          datum = [x,y];\n          datum.year = settings.meta.year;\n          datum.sdg = settings.meta.sdg;\n          datum.word = word;\n          // properties to be used by the quadtree\n          datum.selected = false;          \n          // properties to be used by the fisheye (also with the x,y)\n          datum.myOpacity = settings.scaleOpacity(weight);\n          datum.myFontSize = fontSize * info.mu;\n          datum.myMaxFontSize = settings.weightFactor.range()[0];\n\n          // if we find intersections, then create a curve for our word, \n          // otherwise just put word on its position without curving\n          if(topIntersect.length > 0 && bottomIntersect.length > 0) {\n            // having now the points on both curves, we can estimate the text's \n            // y position as an offset between these 2 curves\n            var getFactor = function(input, min, max) {\n              return (input - min) / (max - min);\n            };\n\n            var factor = getFactor(y, topIntersect[0].point.y, bottomIntersect[0].point.y);\n\n            // now get the curve passing by the text y position\n            var curve = new paper.Path();\n            try {\n              curve.interpolate(settings.meta.curves[0], settings.meta.curves[1], factor);\n              // remember that vega creates a main <g> with \n              // a vertical translation. Consider this offset\n              // when placing the curves\n              curve.translate(new paper.Point(0, settings.marginTop));\n            } catch(e) {\n              // error likely because we got a CompoundPath in pathSDGYear\n              console.error(\"Interpolation error: \", e);\n            }\n\n            // we place text along the curve, but when increasing the fontsize\n            // the texts overflow the path, so they are not displayed totally\n            // (the overflowing part of the text is cut). To avoid these, we\n            // scale the curve horizontally in order to give more space so\n            // increasing the text does not generated overflowed text.\n            var curveScaleFactor = 1.4;\n            // we have to take this into account when calculating at which\n            // percentage of the curve we place our text: the curve will\n            // grow at the sides (we scale it from the center, so it expands\n            // from the center point), so we have to consider that on each\n            // side we have the percentage that we apply for scaling, divided\n            // by two\n            var offsetLateral = (curveScaleFactor - 1 ) / 2;\n            \n            streamRiverSVG\n              .append(\"defs\")\n              .append(\"path\")\n              .attr(\"id\", \"curve-\" + word + \"-\" + settings.meta.sdg + \"-\" + settings.meta.year)\n              .attr(\"d\", curve.scale(curveScaleFactor, 1).exportSVG().getAttribute('d'));\n            \n            streamRiverSVG\n              .append('text')\n              .attr('class', 'curve-text')\n              .datum(datum)\n              .attr(\"id\", \"curve-text-\" + word  + \"-\" + settings.meta.sdg + \"-\" + settings.meta.year)\n                .append(\"textPath\")\n                .datum(datum)\n                .attr('startOffset', (\n                  getFactor(\n                    // position of the text\n                    x,\n                    // x of the canvas minus the percentage of curve's growth\n                    el.offsetLeft - (el.offsetWidth*offsetLateral), \n                    // x of the canvas, plus its width, plus the percentage of curve's growth\n                    el.offsetLeft+el.offsetWidth+(el.offsetWidth*offsetLateral)\n                  ) * 100) + '%'\n                )\n                .attr(\"xlink:href\", \"#curve-\"+ word + \"-\" + settings.meta.sdg + \"-\" + settings.meta.year)\n                .attr('transform', transformRule)            \n                .attr('opacity', datum.myOpacity)\n                .attr('fill', 'whitesmoke'/*color*/ )\n                .style('font-size', fontSize * info.mu )\n                .style('font-family', '\"Trebuchet MS\", sans-serif')\n                .style('dominant-baseline', \"middle\")\n                .style('text-anchor', 'middle')\n                .text(word);\n            }\n          else {\n            streamRiverSVG\n              .append('text')\n                .attr('class', 'curve-text')\n                .datum(datum)\n                .attr(\"id\", \"curve-text-\" + word  + \"-\" + settings.meta.sdg + \"-\" + settings.meta.year)\n                .attr('x',  x)\n                .attr('y',  y + 50)\n                .attr('transform', transformRule)\n                .attr('opacity', datum.myOpacity)            \n                .attr('fill', 'whitesmoke'/*color*/ )\n                .style('font-size', fontSize * info.mu )\n                .style('font-family', '\"Trebuchet MS\", sans-serif')\n                .style('dominant-baseline', \"middle\")\n                .style('text-anchor', 'middle')\n                .text(word);\n          }\n      });\n    };\n\n    /* Help function to updateGrid */\n    var fillGridAt = function fillGridAt(x, y, drawMask, dimension, item) {\n      if (x >= ngx || y >= ngy || x < 0 || y < 0) {\n        return;\n      }\n\n      grid[x][y] = false;\n\n      if (drawMask) {\n        var ctx = elements[0].getContext('2d');\n        ctx.fillRect(x * g, y * g, maskRectWidth, maskRectWidth);\n      }\n\n      if (interactive) {\n        infoGrid[x][y] = { item: item, dimension: dimension };\n      }\n    };\n\n    /* Update the filling information of the given space with occupied points.\n       Draw the mask on the canvas if necessary. */\n    var updateGrid = function updateGrid(gx, gy, gw, gh, info, item) {\n      var occupied = info.occupied;\n      var drawMask = settings.drawMask;\n      var ctx;\n      if (drawMask) {\n        ctx = elements[0].getContext('2d');\n        ctx.save();\n        ctx.fillStyle = settings.maskColor;\n      }\n\n      var dimension;\n      if (interactive) {\n        var bounds = info.bounds;\n        dimension = {\n          x: (gx + bounds[3]) * g,\n          y: (gy + bounds[0]) * g,\n          w: (bounds[1] - bounds[3] + 1) * g,\n          h: (bounds[2] - bounds[0] + 1) * g\n        };\n      }\n\n      var i = occupied.length;\n      while (i--) {\n        var px = gx + occupied[i][0];\n        var py = gy + occupied[i][1];\n\n        if (px >= ngx || py >= ngy || px < 0 || py < 0) {\n          continue;\n        }\n\n        fillGridAt(px, py, drawMask, dimension, item);\n      }\n\n      if (drawMask) {\n        ctx.restore();\n      }\n    };\n\n    /* putWord() processes each item on the list,\n       calculate it's size and determine it's position, and actually\n       put it on the canvas. */\n    var putWord = function putWord(item) {\n      var word, weight, attributes;\n      if (Array.isArray(item)) {\n        word = item[0];\n        weight = item[1];\n      } else {\n        word = item.word;\n        weight = item.weight;\n        attributes = item.attributes;\n      }\n      var rotateDeg = getRotateDeg();\n\n      // get info needed to put the text onto the canvas\n      var info = getTextInfo(word, weight, rotateDeg);\n\n      // not getting the info means we shouldn't be drawing this one.\n      if (!info) {\n        console.log(word, \" skipped\");\n        return false;\n      }\n\n      if (exceedTime()) {\n        console.log(word, \" exeeded time\");\n        return false;\n      }\n\n      // If drawOutOfBound is set to false,\n      // skip the loop if we have already know the bounding box of\n      // word is larger than the canvas.\n      if (!settings.drawOutOfBound) {\n        var bounds = info.bounds;\n        if ((bounds[1] - bounds[3] + 1) > ngx ||\n          (bounds[2] - bounds[0] + 1) > ngy) {\n          return false;\n        }\n      }\n\n      // Determine the position to put the text by\n      // start looking for the nearest points\n      var r = maxRadius + 1;\n\n      var tryToPutWordAtPoint = function(gxy) {\n        var gx = Math.floor(gxy[0] - info.gw / 2);\n        var gy = Math.floor(gxy[1] - info.gh / 2);\n        var gw = info.gw;\n        var gh = info.gh;\n\n        // If we cannot fit the text at this position, return false\n        // and go to the next position.\n        if (!canFitText(gx, gy, gw, gh, info.occupied)) {\n          return false;\n        }\n\n        // Actually put the text on the canvas\n        drawText(gx, gy, info, word, weight,\n                 (maxRadius - r), gxy[2], rotateDeg, attributes);\n\n        // Mark the spaces on the grid as filled\n        updateGrid(gx, gy, gw, gh, info, item);\n\n        // Return true so some() will stop and also return true.\n        return true;\n      };\n\n      while (r--) {\n        var points = getPointsAtRadius(maxRadius - r);\n\n        if (settings.shuffle) {\n          points = [].concat(points);\n          shuffleArray(points);\n        }\n\n        // Try to fit the words by looking at each point.\n        // array.some() will stop and return true\n        // when putWordAtPoint() returns true.\n        // If all the points returns false, array.some() returns false.\n        var drawn = points.some(tryToPutWordAtPoint);\n\n        if (drawn) {\n          // leave putWord() and return true\n          return true;\n        }\n      }\n      if (settings.shrinkToFit) {\n        if (Array.isArray(item)) {\n          item[1] = item[1] * 0.75;\n        } else {\n          item.weight = item.weight * 0.75;\n        }\n        return putWord(item);\n      }\n      // we tried all distances but text won't fit, return false\n      //console.log(word, \"(\" + weight + \") doesn't fit (\" + settings.meta.sdg + \" \" + settings.meta.year + \")\");\n      return false;\n    };\n\n    /* Send DOM event to all elements. Will stop sending event and return\n       if the previous one is canceled (for cancelable events). */\n    var sendEvent = function sendEvent(type, cancelable, details) {\n      if (cancelable) {\n        return !elements.some(function(el) {\n          var event = new CustomEvent(type, {\n            detail: details || {}\n          });\n          return !el.dispatchEvent(event);\n        }, this);\n      } else {\n        elements.forEach(function(el) {\n          var event = new CustomEvent(type, {\n            detail: details || {}\n          });\n          el.dispatchEvent(event);\n        }, this);\n      }\n    };\n\n    /* Start drawing on a canvas */\n    var start = function start() {\n      // For dimensions, clearCanvas etc.,\n      // we only care about the first element.\n      var canvas = elements[0];\n\n      if (canvas.getContext) {\n        ngx = Math.ceil(canvas.width / g);\n        ngy = Math.ceil(canvas.height / g);\n      } else {\n        var rect = canvas.getBoundingClientRect();\n        ngx = Math.ceil(rect.width / g);\n        ngy = Math.ceil(rect.height / g);\n      }\n\n      // Sending a wordcloudstart event which cause the previous loop to stop.\n      // Do nothing if the event is canceled.\n      if (!sendEvent('wordcloudstart', true)) {\n        return;\n      }\n\n      // Determine the center of the word cloud\n      center = (settings.origin) ?\n        [settings.origin[0]/g, settings.origin[1]/g] :\n        [ngx / 2, ngy / 2];\n\n      // Maxium radius to look for space\n      maxRadius = Math.floor(Math.sqrt(ngx * ngx + ngy * ngy));\n\n      /* Clear the canvas only if the clearCanvas is set,\n         if not, update the grid to the current canvas state */\n      grid = [];\n\n      var gx, gy, i;\n      if (!canvas.getContext || settings.clearCanvas) {\n        elements.forEach(function(el) {\n          if (el.getContext) {\n            var ctx = el.getContext('2d');\n            ctx.fillStyle = settings.backgroundColor;\n            ctx.clearRect(0, 0, ngx * (g + 1), ngy * (g + 1));\n            ctx.fillRect(0, 0, ngx * (g + 1), ngy * (g + 1));\n          } else {\n            el.textContent = '';\n            el.style.backgroundColor = settings.backgroundColor;\n            el.style.position = 'relative';\n          }\n        });\n\n        /* fill the grid with empty state */\n        gx = ngx;\n        while (gx--) {\n          grid[gx] = [];\n          gy = ngy;\n          while (gy--) {\n            grid[gx][gy] = true;\n          }\n        }\n      } else {\n        /* Determine bgPixel by creating\n           another canvas and fill the specified background color. */\n        var bctx = document.createElement('canvas').getContext('2d');\n\n        bctx.fillStyle = settings.backgroundColor;\n        bctx.fillRect(0, 0, 1, 1);\n        var bgPixel = bctx.getImageData(0, 0, 1, 1).data;\n\n        if(canvas.width === 0 || canvas.height === 0) {\n          //console.warn(\"canvas with no size for \", settings.meta.year, settings.meta.sdg);\n          return;\n        }\n        /* Read back the pixels of the canvas we got to tell which part of the\n           canvas is empty.\n           (no clearCanvas only works with a canvas, not divs) */\n        var imageData =\n          canvas.getContext('2d').getImageData(0, 0, ngx * g, ngy * g).data;\n\n        gx = ngx;\n        var x, y;\n        while (gx--) {\n          grid[gx] = [];\n          gy = ngy;\n          while (gy--) {\n            y = g;\n            singleGridLoop: while (y--) {\n              x = g;\n              while (x--) {\n                i = 4;\n                while (i--) {\n                  if (imageData[((gy * g + y) * ngx * g +\n                                 (gx * g + x)) * 4 + i] !== bgPixel[i]) {\n                    grid[gx][gy] = false;\n                    break singleGridLoop;\n                  }\n                }\n              }\n            }\n            if (grid[gx][gy] !== false) {\n              grid[gx][gy] = true;\n            }\n          }\n        }\n      }\n\n      // fill the infoGrid with empty state if we need it\n      if (settings.hover || settings.click) {\n\n        interactive = true;\n\n        /* fill the grid with empty state */\n        gx = ngx + 1;\n        while (gx--) {\n          infoGrid[gx] = [];\n        }\n\n        if (settings.hover) {\n          canvas.addEventListener('mousemove', wordcloudhover);\n        }\n\n        if (settings.click) {\n          canvas.addEventListener('click', wordcloudclick);\n          canvas.style.webkitTapHighlightColor = 'rgba(0, 0, 0, 0)';\n        }\n\n        canvas.addEventListener('wordcloudstart', function stopInteraction() {\n          canvas.removeEventListener('wordcloudstart', stopInteraction);\n\n          canvas.removeEventListener('mousemove', wordcloudhover);\n          canvas.removeEventListener('click', wordcloudclick);\n          hovered = undefined;\n        });\n      }\n\n      i = 0;\n      var loopingFunction, stoppingFunction;\n      if (settings.wait !== 0) {\n        loopingFunction = window.setTimeout;\n        stoppingFunction = window.clearTimeout;\n      } else {\n        loopingFunction = window.setImmediate;\n        stoppingFunction = window.clearImmediate;\n      }\n\n      var addEventListener = function addEventListener(type, listener) {\n        elements.forEach(function(el) {\n          el.addEventListener(type, listener);\n        }, this);\n      };\n\n      var removeEventListener = function removeEventListener(type, listener) {\n        elements.forEach(function(el) {\n          el.removeEventListener(type, listener);\n        }, this);\n      };\n\n      var anotherWordCloudStart = function anotherWordCloudStart() {\n        removeEventListener('wordcloudstart', anotherWordCloudStart);\n        stoppingFunction(timer);\n      };\n\n      addEventListener('wordcloudstart', anotherWordCloudStart);\n\n      var timer = loopingFunction(function loop() {\n        if (i >= settings.list.length) {\n          stoppingFunction(timer);\n          //console.log(\"wordcloudstop by \", settings.meta.sdg +  \" \" + settings.meta.year);\n          sendEvent('wordcloudstop', false);          \n          removeEventListener('wordcloudstart', anotherWordCloudStart);\n          return;\n        }\n        escapeTime = (new Date()).getTime();\n        \n        var drawn = putWord(settings.list[i]);\n\n        var canceled = !sendEvent(\n          'wordclouddrawn', \n          true, {\n            item: settings.list[i], \n            drawn: drawn \n          }\n        );\n        \n        if (exceedTime() || canceled) {\n          stoppingFunction(timer);\n          settings.abort();\n          console.warning(\"wordcloudabort by \", settings.meta.sdg +  \" \" + settings.meta.year);\n          sendEvent('wordcloudabort', false);\n          sendEvent('wordcloudstop', false);\n          removeEventListener('wordcloudstart', anotherWordCloudStart);\n          return;\n        }\n        i++;\n        timer = loopingFunction(loop, settings.wait);\n      }, settings.wait);\n    };\n\n    // All set, start the drawing\n    start();\n  };\n\n  WordCloud.isSupported = isSupported;\n  WordCloud.minFontSize = minFontSize;\n/*\n  // Expose the library as an AMD module\n  if (typeof define === 'function' && define.amd) {\n    global.WordCloud = WordCloud;\n    define('wordcloud', [], function() { return WordCloud; });\n  } else if (typeof module !== 'undefined' && module.exports) {\n    module.exports = WordCloud;\n  } else {\n    global.WordCloud = WordCloud;\n  }\n*/\nwindow.WordCloud = WordCloud;\n})(this); //jshint ignore:line\n","import React, { Component } from 'react';\nimport * as _ from 'lodash';\nimport * as d3 from 'd3';\n// eslint-disable-next-line\nimport WordCloud from './wordcloud2';\n\nclass Canvas extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {};\n    }\n\n\n    componentDidMount() {\n        const {\n            color,\n            path,\n            data,\n            angle,\n            offsetWidthFactor,\n            curves,\n            year,\n            sdg,\n            wordCloudCompletionListener            \n        } = this.props;\n        setTimeout( () => {\n\n\n            const minFontSize = 4;\n            const drawingAreaColor = 'black';\n            const foregroundColor = color;\n            let context = this.refs.canvas.getContext('2d');\n            context.strokeStyle = context.fillStyle = drawingAreaColor;\n            var p = new Path2D(path);\n            context.stroke(p);\n            context.fill(p);\n            if(data.length === 0)\n                return;\n            let maxWeight = d3.max(data, d => d[1]);\n            let minWeight = d3.min(data, d => d[1]);\n\n            // given the highest weight, estimate the maximum font\n            // size\n            const fitTextOnWidth = (text, width) => {    \n                // start with a large font size\n                var fontsize = 30;\n                // lower the font size until the text fits the width\n                do {\n                    fontsize--;\n                    context.font = '300 ' + fontsize.toString() + 'px Trebuchet MS';\n                } while(context.measureText(text).width > width)\n                return fontsize;\n            };\n\n            let maxFontSize = fitTextOnWidth(\n                _.first(data)[0], \n                context.canvas.clientWidth / offsetWidthFactor\n            );\n\n            let scaleFontSize = d3.scaleLinear()\n                .domain([maxWeight, minWeight])\n                .range([maxFontSize, minFontSize + 0.1]);\n\n            let scaleOpacity = d3.scaleLinear()\n                .domain([maxWeight, minWeight])\n                .range([0.9, 0.5]);\n\n            // add listener to control when wordclouds finish\n            this.refs.canvas.addEventListener('wordcloudstop', function(e) {\n                wordCloudCompletionListener(e);\n            }, false);\n\n            window.WordCloud(\n                this.refs.canvas,\n                {\n                    // Presentation\n                    list: data.sort( (a, b) => b[1] - a[1]),\n                    color: foregroundColor,\n                    minSize: minFontSize,\n                    weightFactor: scaleFontSize,\n                    scaleOpacity: scaleOpacity,\n                    backgroundColor: drawingAreaColor,\n                    clearCanvas: false,\n                    // Dimension\n                    gridSize: 4, // but the algorithm doesn't allow less than 4\n                    drawOutOfBound: false,\n                    shrinkToFit: false,\n                    // Mask\n                    drawMask: false,\n                    // Rotation\n                    minRotation: angle,\n                    maxRotation: angle,\n                    rotateRatio: 1,\n                    // shape\n                    shape: 'square',\n\n                    // curves,\n                    meta: { curves, year, sdg}\n                } \n            );         \n        }, 1000);\n    }\n\n    render() {\n        return <div className={'canvasSDG'}>\n            <canvas ref='canvas' \n                width={this.props.width} \n                height={this.props.height}\n                style={{\n                    width: this.props.width, \n                    height: this.props.height,\n                    left: this.props.x,\n                    top: this.props.y\n                }}\n            />\n        </div>        \n    }\n}\nexport default Canvas; ","import * as d3 from 'd3';\n\nconst myAnnotation = function(){\n\n    function show (text) {\n\n      //positionate tooltip\n      var tooltip = d3.select('#node-annotation')\n        .style('display', 'block')\n        .style('left', (d3.event? d3.event.pageX:0) + 'px');\n        //.style('top', (d3.event.pageY - 50) + 'px');\n\n      //update text\n      tooltip.select('.node-annotation-text').html(text);\n      tooltip.style('top', (d3.event? d3.event.pageY:0) + 'px');\n    }\n\n    function hide() {\n      d3.select('#node-annotation').style('display', 'none');\n    };\n\n    function move(coords) {\n        var tooltip = d3.select('#node-annotation');\n\n        tooltip.style('display', 'block')\n            .style('left', (coords[0] + 15) + 'px')\n            .style('top', (coords[1] - 50) + 'px');\n\n        // if tooltip is placed out of the boundaries of the screen,\n        // automatically placed it inside\n        var tooltipWidth = tooltip.node().getBoundingClientRect().width,\n            tooltipX = tooltip.node().getBoundingClientRect().left,\n            windowWidth = window.innerWidth;\n        if ((tooltipX + tooltipWidth) > windowWidth)\n            tooltip.style('left', (tooltipX - tooltipWidth - 5) + 'px');        \n    }\n    \n\n\n    return {\n        show: show,\n        hide: hide,\n        move: move\n    };\n}\nconst Annotation = myAnnotation();\nexport default Annotation;","import React, { Component } from 'react';\nimport paper from 'paper';\nimport * as d3 from 'd3';\nimport * as _ from 'lodash';\nimport CanvasSDG from './canvasSDG';\nimport { fisheye } from '../../common/fisheye';\nimport { getMarginTopFromVegaSVG } from '../../common/vega/VegaUtils';\nimport Annotation from '../../components/Annotation';\n\n\nclass WordleGenerator extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            numWordCloudCompleted: 0,\n            textPaths: []\n        }\n        this.fisheye = fisheye.circular().radius(50).distortion(5);\n        this.wordCloudCompletionListener = this.wordCloudCompletionListener.bind(this);\n        this.showAnnotation = this.showAnnotation.bind(this);\n    }\n\n\n    // show annotation only if we detect\n    // there is a hovered word\n    showAnnotation(coords) {\n\n        const hoveredText = d3.select('.stream-river svg')\n            .selectAll('.curve-text')\n            .filter(d => d ? d.selected : false)\n            .selectAll('textPath')\n            .nodes()\n            .filter(function (el) {\n                return 1 === +getComputedStyle(el).getPropertyValue('--my-hovered-state');\n            })\n\n        if (hoveredText.length > 0) {\n            clearInterval(this.interval);\n            Annotation.show(\"Click for details about <span class='dottedUnderline'><strong>\" + hoveredText[0].textContent + '</strong></span>');\n            Annotation.move(coords);\n        }\n    }\n\n\n\n    findUpperPath(result, intersections) {\n        let initialIndex, finalIndex, mySegments, segment, len;\n\n        // get min and max x\n        var min = Math.min(...intersections.map(function (i) { return i.point.x; }))\n        var max = Math.max(...intersections.map(function (i) { return i.point.x; }))\n\n        // get left and right points\n        var leftPoints = intersections.filter(function (i) { return i.point.x === min; })\n        var rightPoints = intersections.filter(function (i) { return i.point.x === max; })\n\n        // re-group left and right points into top and bottom points\n        var topPoints = [\n            leftPoints.reduce(function (acumulator, currentValue) {\n                return currentValue.point.y <= acumulator.point.y ? currentValue : acumulator;\n            }, leftPoints[0]),\n            rightPoints.reduce(function (acumulator, currentValue) {\n                return currentValue.point.y <= acumulator.point.y ? currentValue : acumulator;\n            }, rightPoints[0]),\n        ];\n\n        var bottomPoints = [\n            leftPoints.reduce(function (acumulator, currentValue) {\n                return currentValue.point.y > acumulator.point.y ? currentValue : acumulator;\n            }, leftPoints[0]),\n            rightPoints.reduce(function (acumulator, currentValue) {\n                return currentValue.point.y > acumulator.point.y ? currentValue : acumulator;\n            }, rightPoints[0]),\n        ];\n\n        // the first segment in the array of path segments can be any: the segments are sorted\n        // in a circular manner around the path, but the first segment is not the one with the\n        // most left-top point, per example. Order in segments is on its 'index' property, but\n        // its read-only. So we have to create the segments in the right order to make operations\n        // like cutting the path without headaches\n        len = result.segments.length;\n\n        // finding the top path, containing the upper intersection points:\n\n        // find the index of the segment containing our left-top point\n        initialIndex = result.segments.findIndex(function (o) {\n            //return Math.round(o.point.x) === Math.round(topPoints[0].point.x) && \n            //        Math.round(o.point.y) === Math.round(topPoints[0].point.y);     \n            return o.point.getDistance(topPoints[0].point) < 1;\n        });\n        mySegments = [];\n        for (let i = 0; i < result.segments.length; i++) {\n            segment = result.segments[(initialIndex + i) % len];\n            mySegments.push(new paper.Segment(\n                segment.point, segment.handleIn, segment.handleOut\n            ));\n        }\n        var result2 = new paper.Path(mySegments);\n\n        finalIndex = result2.segments.findIndex(function (o) {\n            //return Math.round(o.point.x) === Math.round(topPoints[1].point.x) && \n            //        Math.round(o.point.y) === Math.round(topPoints[1].point.y);     \n            return o.point.getDistance(topPoints[1].point) < 1;\n        });\n        result2.removeSegments(finalIndex + 1)\n\n\n\n        // finding the path containing the lower intersection points:\n        // find index of segment containing our right-bottom point\n        initialIndex = result.segments.findIndex(function (o) {\n            //return Math.round(o.point.x) === Math.round(bottomPoints[1].point.x) && \n            //        Math.round(o.point.y) === Math.round(bottomPoints[1].point.y);     \n            return o.point.getDistance(bottomPoints[1].point) < 1;\n        });\n        len = result.segments.length;\n        mySegments = [];\n        for (let i = 0; i < result.segments.length; i++) {\n            segment = result.segments[(initialIndex + i) % len];\n            mySegments.push(new paper.Segment(\n                segment.point, segment.handleIn, segment.handleOut\n            ));\n        }\n\n        var result3 = new paper.Path(mySegments);\n\n        finalIndex = result3.segments.findIndex(function (o) {\n            //return Math.round(o.point.x) === Math.round(bottomPoints[0].point.x) && \n            //        Math.round(o.point.y) === Math.round(bottomPoints[0].point.y);     \n            return o.point.getDistance(bottomPoints[0].point) < 1;\n        });\n        result3.removeSegments(finalIndex + 1)\n\n        // in order to interpolate the two curves,\n        // orientation of the path's points has to\n        // be the same (both path with its points\n        // going from left to right)\n        result3.reverse();\n        return [result2, result3];\n    };\n\n\n    wordCloudCompletionListener(e) {\n        // there is no exact number of wordlcloud that will be resolved,\n        // since depending on the dimensions (mobile, desktop, etc) the\n        // numbers of allocated wordlclouds will vary\n        // Put here a number which is close to the all possible wordclouds\n        // but high enough to consider that we are close to have them\n        // all resolved\n        const MAX_WORDLCLOUD = 170;\n\n        this.setState({\n            textPaths: this.state.textPaths.concat(e.detail),\n            numWordCloudCompleted: this.state.numWordCloudCompleted + 1\n        })\n\n        let percentage = Math.ceil((this.state.numWordCloudCompleted / MAX_WORDLCLOUD) * 100);\n\n        document.querySelector('#global-preloader')\n            .innerHTML = 'Processing data... ' +\n            percentage + '%';\n \n        const quadTreeRadius = 30,\n            svg = document.querySelector('.stream-river svg');\n\n        console.log(this.state.numWordCloudCompleted)\n        if(percentage > 95) {\n            document.querySelector('body').style['overflow-y'] = 'initial';\n            document.querySelector('body').classList.remove('loading');\n            document.querySelector('.stream-river').style.opacity = 1;\n        }\n        \n        // without 2017 and 2020, MAX_WORDLCLOUD wordclouds\n        if (this.state.numWordCloudCompleted > MAX_WORDLCLOUD) {\n\n            let self = this;\n\n            const curveText = d3.selectAll('.curve-text')\n                .filter(d => !_.isUndefined(d))\n                .on('click', function (d) {\n                    // hide any current annotation\n                    Annotation.hide();\n                    if (self.interval)\n                        clearInterval(self.interval);\n                    // show modal\n                    self.props.handleOpenModalKeyword(d.word);\n                });\n\n            // get only with elements visible on the screen:\n            // https://stackoverflow.com/questions/123999/how-can-i-tell-if-a-dom-element-is-visible-in-the-current-viewport\n            //.filter( function() { return isElementInViewport(this); });\n\n            // !important: vega specification has a top margin. Take into account\n            // this offset when getting the positions of the words\n            const marginTop = getMarginTopFromVegaSVG(d3.select('.stream-river svg.marks'));\n\n            const quadTree = d3.quadtree()\n                .extent(\n                    [-1, -1],\n                    [+d3.select('.stream-river svg').attr(\"width\") + 1, +d3.select('.stream-river svg').attr(\"height\") + 1])\n                .addAll(\n                    curveText.data()\n                );\n\n            var buffer = {};\n            const remap = function (value, istart, istop, ostart, ostop) {\n                return ostart + (ostop - ostart) * ((value - istart) / (istop - istart));\n            };\n\n            // Find the nodes within the specified rectangle.\n            const search = function (quadtree, x0, y0, x3, y3) {\n                quadtree.visit(function (node, x1, y1, x2, y2) {\n                    if (!node.length) {\n                        do {\n                            var d = node.data;\n                            d.selected = (d[0] >= x0) && (d[0] < x3) && (d[1] >= y0) && (d[1] < y3);\n                        } \n                        // eslint-disable-next-line\n                        while (node = node.next);\n                    }\n                    return x1 >= x3 || y1 >= y3 || x2 < x0 || y2 < y0;\n                });\n            };\n\n            const pt = svg.createSVGPoint();\n            //https://stackoverflow.com/questions/10298658/mouse-position-inside-autoscaled-svg\n            const cursorPoint = function (x, y) {\n                pt.x = x;\n                pt.y = y;\n                return pt.matrixTransform(svg.getScreenCTM().inverse());\n            }\n\n            const searchAndFish = function (e) {\n\n                // hide any current annotation\n                Annotation.hide();\n                if (self.interval)\n                    clearInterval(self.interval);\n\n                // check for a 'mouse stop' to show the annotation\n                let pageCoords = [d3.event.pageX, d3.event.pageY],\n                    clientCoords = [d3.event.clientX, d3.event.clientY]\n                self.interval = setInterval(() => self.showAnnotation(pageCoords), 1000);\n\n                requestAnimationFrame(function () {\n                    // since throttling a mousemove event from d3 is \n                    // hard, do stuff to get mouse coords natively\n                    const p = cursorPoint(clientCoords[0], clientCoords[1])\n                    const mouse = [p.x, p.y - marginTop];\n\n                    // keep the fisheye updated to the mouse\n                    self.fisheye.focus(mouse);\n\n                    // search all texts close to the mouse position\n                    curveText\n                        .each(function (d) { d.selected = false; });\n\n                    search(\n                        quadTree,\n                        mouse[0] - quadTreeRadius,\n                        mouse[1] - quadTreeRadius,\n                        mouse[0] + quadTreeRadius,\n                        mouse[1] + quadTreeRadius\n                    );\n                    curveText\n                        .filter(d => d ? d.selected : false)\n                        .each(function (d) {\n                            d.fisheye = self.fisheye({ x: d[0], y: d[1] })\n                        });\n\n                    //curveText.classed('selected', function(d) { return d.selected; });\n\n                    //\n                    if (!_.isEmpty(buffer)) {\n                        // get words selected in the previous search\n                        // and get those not present in the new \n                        // quadtree selection\n                        var oldWords = _.difference(\n                            _.keys(buffer),\n                            curveText\n                                .filter(d => d.selected)\n                                .data()\n                                .map(d => d.word)\n                        );\n                        oldWords.forEach(w => {\n                            // check whether is a textPath or a text\n                            let selection = buffer[w].select('textPath');\n                            (selection.size() > 0 ? selection : buffer[w] )\n                                .attr('opacity', d => d.myOpacity)\n                                .style('font-size', d => d.myFontSize);\n                            /*buffer[w]\n                                .select('textPath')\n                                .attr('opacity', d => d.myOpacity)\n                                .style('font-size', d => d.myFontSize);*/\n                        });\n                    }\n                    // create new buffer with the current search\n                    buffer = {}\n                    curveText\n                        .filter(function (d) { return d && d.selected; })\n                        .each(function (d) {\n                            buffer[d.word] = d3.select(this); // MAYBE THIS IS SLOW?\n                        });\n\n                    curveText\n                        .filter(d => d ? d.selected : false)\n                        .each( function(d, i) {\n                            let selection = d3.select(this).select('textPath');\n                            (selection.size() > 0 ? selection : d3.select(this) )\n                                .attr('opacity', function (d) {\n                                    // typical z values range between 1 and 4 aprox... \n                                    return remap(d.fisheye.z, 1, 3, d.myOpacity, 1);\n                                })\n                                .style('font-size', function (d) {\n                                    const myFontSize = d.myFontSize;\n                                    // max font size for the wordcloud this word belongs to\n                                    const maxFontSize = d.myMaxFontSize;\n                                    // don't let bigger font size than the maximum, otherwise the text\n                                    // overflows the path and appears incomplete (maxFontSize is esimated)\n                                    // by looking for the maximum font size with the available width canvas\n                                    // of the wordcloud\n                                    const fontSize = myFontSize * d.fisheye.z;\n                                    //return fontSize;\n                                    return (fontSize < maxFontSize ? fontSize : maxFontSize) + 'px';\n                                });\n                        });                        \n                });\n            };\n\n            // throttle our mousemove function to avoid drops\n            // in the performance. Do not rely on d3.on('mousemove',...)\n            // when throttling since d3 resets info about the d3.event\n            // and it's hard to mantain the context (d3.mouse and this)\n            //svg.addEventListener('mousemove', _.throttle(searchAndFish, 100));\n            //svg.addEventListener('mousemove', searchAndFish);\n            d3.select('.stream-river svg').on('mousemove', searchAndFish);\n            //svg.addEventListener('click', findNode);       \n        }\n    }\n\n    generateCanvasLayout() {\n        const {\n            data,\n            canvasLayout,\n            scaleX,\n            keywords\n        } = this.props;\n\n        // when creating the wordclouds, often there is empty space\n        // between them. While this is correct (the wordcloud algorithm\n        // starts from the center of its available space ot the outside)\n        // it would be nice to reduce this blank space: to achieve this\n        // we \"expand\" the width of the intersection area, so the wordcloud\n        // will have more space to place the words. This will create some\n        // overlapping, specially with the word with more weight (the \n        // wordcloud alg. places it using all the available width to determine\n        // the max font size), so we pass this factor to the wordcloud in\n        // order to by inverse applied when placing the most weighted word.\n        const offsetWidthFactor = 1;\n\n        // generated collection of wordclouds\n        const wordClouds = //_.filter(data, d => (d.year < 2020))\n            //_.filter(data, d => (d.SDG === 'SDG 13' || d.SDG === 'SDG 7' || d.SDG === 'SDG 11' || d.SDG === 'SDG 2' )\n            _.filter(data, d => /*d.SDG === 'SDG 11' && */d.year < 2020)\n                .map((o, index) => {\n\n                    // get the keyword counts for each <SDG,year> \n                    let canvasData = _.filter(\n                        keywords,\n                        o2 => o2.SDG === o.SDG && o2.year === o.year\n                    );\n                    // estimate position and size for the canvas\n                    // paper.js stuff\n                    var pathSDG = new paper.Path(canvasLayout[o.SDG].path);\n                    var square = new paper.Path.Rectangle(\n                        [scaleX(o.year), 0], [scaleX.step(), window.innerHeight]\n                    );\n                    if (o.year !== 2007 && o.year !== 2019) {\n                        square.scale(offsetWidthFactor, 1)\n                    };\n\n                    var pathSDGYear = square.intersect(pathSDG);\n                    if (pathSDGYear.children) {\n                        // we got a compound path.. ¿?\n                        // just get the first children\n                        pathSDGYear = pathSDGYear.children[0];\n                    }\n                    let intersections = square.getIntersections(pathSDG);\n                    let offsetX = d3.min(intersections, i => i.point.x);\n                    let offsetY = d3.min(intersections, i => i.point.y);\n                    try {\n                        var curves = this.findUpperPath(pathSDGYear, intersections);\n                    } catch (e) {\n                        // error likely because we got a CompoundPath in pathSDGYear\n                        console.warn(\"no curves have been found in \" + o.SDG + \" \" + o.year);\n                    }\n\n                    // we are going to place the canvas on its position relative\n                    // to window 0,0, so translate the path to 0,0 on its canvas\n                    pathSDGYear.translate(new paper.Point(-offsetX, -offsetY));\n\n                    // TODO: check ending years for 4 intersections\n                    var vector, vector1, vector2;\n                    if (intersections && intersections.length === 4) {\n                        vector1 = new paper.Point(\n                            intersections[3].point.x - intersections[0].point.x,\n                            intersections[3].point.y - intersections[0].point.y\n                        );\n                        vector2 = new paper.Point(\n                            intersections[2].point.x - intersections[1].point.x,\n                            intersections[2].point.y - intersections[1].point.y\n                        );\n                        vector = Math.abs(vector1.angle) > Math.abs(vector2.angle) ? vector1 : vector2;\n                    }\n\n                    return <div id={o.SDG + '-' + o.year} key={index} style={{ position: 'absolute', left: '0px', top: '0px' }} className='canvas-sdg'>\n                        <CanvasSDG id={o.SDG + '-' + o.year}\n                            wordCloudCompletionListener={this.wordCloudCompletionListener}\n                            path={pathSDGYear.exportSVG().getAttribute('d')}\n                            curves={curves}\n                            width={pathSDGYear.bounds.width}\n                            height={pathSDGYear.bounds.height}\n                            x={offsetX}\n                            y={offsetY}\n                            sdg={o.SDG}\n                            year={o.year}\n                            offsetWidthFactor={offsetWidthFactor}\n                            angle={vector ? vector.angle * (Math.PI / 180) * -1 : 0}\n                            color={canvasLayout[o.SDG].color}\n                            data={canvasData\n                                .map(o => [o.keyword, o.count])\n                                .sort((a, b) => b[1] - a[1])\n                            }\n                        />\n                    </div>;\n                });\n\n        this.setState({\n            amountWordClouds: wordClouds.length\n        });\n\n        return <div>{wordClouds}</div>\n    };\n\n    shouldComponentUpdate() {\n        // we just want to render once\n        return false;\n    }\n\n    render() {\n        return this.generateCanvasLayout();\n    }\n}\n\nexport default WordleGenerator;","import React, { PureComponent } from 'react';\nimport * as d3 from 'd3';\nimport * as datalib from 'datalib';\nimport * as _ from 'lodash';\nimport VegaChart from '../../common/vega/VegaChart';   //from './VegaChart'\nimport { streamgraph } from '../../common/vega/VegaSpecifications';\nimport paper from 'paper';\nimport WordleGenerator from './WordleGenerator';\n\nimport streamRiverData from '../../data/streamriver/streamriver-data-new.json';\nimport streamRiverKeywords from '../../data/streamriver/streamriver-keywords-new.json';\n\nlet InfoSDG = {\n    'SDG 1' : { color: '#E5243B'},\n    'SDG 2' : { color: '#DDA63A'},\n    'SDG 3' : { color: '#4C9F38'},\n    'SDG 4' : { color: '#C5192D'},\n    'SDG 5' : { color: '#FF3A21'},\n    'SDG 6' : { color: '#26BDE2'},\n    'SDG 7' : { color: '#FCC30B'},\n    'SDG 8' : { color: '#A21942'},\n    'SDG 9' : { color: '#FD6925'},\n    'SDG 10' : { color: '#DD1367'},\n    'SDG 11' : { color: '#FD9D24'},\n    'SDG 12' : { color: '#BF8B2E'},\n    'SDG 13' : { color: '#3F7E44'},\n    'SDG 14' : { color: '#0A97D9'},\n    'SDG 15' : { color: '#56C02B'},\n    'SDG 16' : { color: '#00689D'},\n    'SDG 17' : { color: '#00689D'}\n}\n\nclass StreamRiver extends PureComponent {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            data: null,\n            canvasLayout: []\n        };\n        this.saveCanvasLayoutData = this.saveCanvasLayoutData.bind(this);\n    }\n\n\n\n    componentDidMount() {\n        paper.setup([1,1]);\n        \n        // add a sorting field to data\n        streamRiverData.forEach( o => {\n            o.order = +o.SDG.substring((\"SDG \").length)\n        });\n\n        let data = _.filter(streamRiverData, o => o.year > 2007 && o.year < 2020);\n        let keywords = _(streamRiverKeywords)\n            .filter(o => o.year > 2007 && o.year <2020)\n            .filter(o => o.count > 2)\n            .value();\n\n        this.setState({\n            data: data,\n            years: datalib.extent(data, o => o.year),\n            keywords: keywords\n        });\n    }\n\n    \n\n    saveCanvasLayoutData(vegaView) {\n\n        const getSDGLabelFromPath = (path) => {\n            return _.find( \n                _.keys(InfoSDG),\n                key => d3.color(InfoSDG[key].color).toString() === d3.color(path.style('fill')).toString()\n            );            \n        };\n\n        d3.selectAll('.role-mark.sdg-serie path')\n            .each( function() {\n                let SDGLabel = getSDGLabelFromPath(d3.select(this));\n                if(SDGLabel) {\n                    InfoSDG[SDGLabel].path = d3.select(this).attr('d');\n                }\n            });\n        \n        // show the right side of the streamriver\n        document.querySelector('.stream-river').scrollLeft = window.innerWidth * 2\n\n        this.setState({\n            canvasLayout: InfoSDG,\n            // use the horizontal scale in vega to calculate the \n            // cutting points for the streamgraph\n            scaleX: vegaView.scale('x')\n        });\n    };\n\n\n\n    render() {\n        let {\n            data,\n            canvasLayout\n        } = this.state;\n\n        if(data) \n            return <div className=\"stream-river\">\n                <VegaChart\n                    chartClass={'vega-layout'}\n                    autoSize={{ type: 'none', contains: 'padding'}}\n                    padding={{top: 50, bottom: 50}}\n                    data={data}\n                    height={window.innerHeight * 0.90 /* same as in the CSS, .stream-river-> height: 95vh*/}\n                    width={window.innerWidth * 2}\n                    spec={streamgraph}\n                    runAfterCallback={(vegaView) => {\n                        _.isEmpty(canvasLayout) && this.saveCanvasLayoutData(vegaView);\n                        }\n                    }>\n                </VegaChart>\n                {\n                    !_.isEmpty(canvasLayout) && <WordleGenerator \n                        {...this.state} \n                        handleOpenModalKeyword={this.props.handleOpenModalKeyword}\n                    />\n                }\n            </div>\n        else\n            return <div/>\n    }\n}\n\nexport default StreamRiver;","export async function postQuery(query) {\n    const response = await fetch(\n        'http://ec2-52-51-177-228.eu-west-1.compute.amazonaws.com/unics/sparql/query', \n        {\n            method: 'POST',\n            mode: 'cors',\n            headers: { \n                // must set this content type when querying via POST\n                'Content-Type': 'application/x-www-form-urlencoded',\n                // get sure we get a JSON instead default XML\n                'Accept': 'application/sparql-results+json'\n            },\n            body: 'query=' + query\n        });\n\n    // fetch won’t reject on HTTP error status even if the response\n    // is an HTTP 404 or 500. Instead, it will resolve normally with\n    // ok status set to false\n    if(response.ok)\n        return await response.json();\n    else {\n        // capture the error message\n        const err = await response.json();            \n        throw Error(\n            (err.error + ': ' + err.message).replace(/(\\r\\n|\\n|\\r)/gm, \"\")\n        );\n    }\n};","const p = 'http://www.w3.org/2001/XMLSchema#';\nconst xsd = {\n    xboolean: p + 'boolean',\n    xint: p + 'int',\n    xinteger: p + 'integer',\n    xlong: p + 'long',\n    decimal: p + 'decimal',\n    xfloat: p + 'float',\n    xdouble: p + 'double',\n    xstring: p + 'string',\n    date: p + 'date',\n    dateTime: p + 'dateTime'\n};\n\nexport default xsd;","\nexport default class DatatypeLabel {\n\n    parse() {\n        throw new Error('Not implemented');\n    }\n\n    unparse() {\n        throw new Error('Not implemented');\n    }\n};\n","import DatatypeLabel from './DatatypeLabel';\n\nexport default class DatatypeLabelInteger extends DatatypeLabel{\n\n    parse(str) {\n        return parseInt(str, 10);\n    }\n\n    unparse(val) {\n        return val.toString();\n    }\n};","import DatatypeLabel from './DatatypeLabel';\n\nexport default class DatatypeLabelString extends DatatypeLabel{\n\n    parse(str) {\n        return str;\n    }\n\n    unparse(val) {\n        return val.toString();\n    }\n};","import DatatypeLabel from './DatatypeLabel';\n\nexport default class DatatypeLabelFloat extends DatatypeLabel{\n\n    parse(str) {\n        return parseFloat(str);\n    }\n\n    unparse(val) {\n        return val.toString();\n    }\n};\n","import DatatypeLabel from './DatatypeLabel';\n\nexport default class DatatypeLabelDate extends DatatypeLabel{\n\n    parse(str) {\n        return !str ? null : new Date(str);\n    }\n\n    unparse(val) {\n        throw new Error('Not implemented');\n    }\n};\n","import DatatypeLabel from './DatatypeLabel';\n\nexport default class DatatypeLabelBoolean extends DatatypeLabel{\n\n    parse(str) {\n        return (str === 'true');\n    }\n\n    unparse(val) {\n        return val.toString();\n    }\n};","import xsd from '../vocab/xsd';\nimport DatatypeLabelInteger from './DatatypeLabelInteger'\nimport DatatypeLabelString from './DatatypeLabelString';\nimport DatatypeLabelFloat from './DatatypeLabelFloat';\nimport DatatypeLabelDate from './DatatypeLabelDate';\nimport DatatypeLabelBoolean from './DatatypeLabelBoolean';\n\nlet defaultRdfDatatypes = {};\ndefaultRdfDatatypes[xsd.xint] = new DatatypeLabelInteger();\ndefaultRdfDatatypes[xsd.xinteger] =  new DatatypeLabelInteger();\ndefaultRdfDatatypes[xsd.xfloat] = new DatatypeLabelFloat();\ndefaultRdfDatatypes[xsd.xdouble] = new DatatypeLabelFloat();\ndefaultRdfDatatypes[xsd.xstring] = new DatatypeLabelString();\ndefaultRdfDatatypes[xsd.date] = new DatatypeLabelDate();\ndefaultRdfDatatypes[xsd.dateTime] = new DatatypeLabelDate();\ndefaultRdfDatatypes[xsd.decimal] = new DatatypeLabelFloat();\ndefaultRdfDatatypes[xsd.xboolean] = new DatatypeLabelBoolean();\n\nexport default defaultRdfDatatypes;","import defaultRdfDatatypes from './rdf/defaultRdfDatatypes';\n\n\n\n/**\n * Parses a value based on its specified datatype\n * @param {String} str Unparsed value \n * @param {*} typeUri a datatype definition\n */\nfunction createTypedLiteralFromString (str, typeUri) {\n    // use default RDF data types for now\n    const dtype = defaultRdfDatatypes[typeUri];\n\n    if(!dtype) {\n        throw new Error('Internal error: No datatype object for: ' + typeUri + '(' + typeof(typeUri) + ')');\n    }\n    return dtype.parse(str);        \n};\n\n\n\n/**\n * Parses an RDF term to its appropiate value\n * @param {obj} nodeValue An RDF-term (https://www.w3.org/TR/sparql11-query/#defn_RDFTerm) \n */\nfunction parseNodeValue(nodeValue) {\n    if (!nodeValue || typeof(nodeValue.type) === 'undefined')\n        throw new Error('Invalid node: ' + JSON.stringify(nodeValue));\n\n    const datatype = nodeValue.datatype;\n        \n    let result;\n    switch (nodeValue.type) {\n        case 'bnode':\n            result = undefined;\n            break;\n\n        case 'uri':\n            result = nodeValue.value;\n            break;\n\n        case 'literal':\n            result = (!(datatype == null || datatype.length === 0 || datatype.trim() === ''))?\n                createTypedLiteralFromString(nodeValue.value, datatype) : \n                nodeValue.value;\n            break;\n\n        case 'typed-literal':\n            result = createTypedLiteralFromString(nodeValue.value, datatype);\n            break;\n\n        default:\n            console.log('Unknown type: \\'' + nodeValue.type + '\\'');\n            throw new Error('Bailing out');\n    }\n\n    return result;\n} \n\n\n\n/**\n * Converts a binding object to a collection of {keys,values}\n * @param {Array} varNames all the projected vars existing in the query\n * @param {Binding} binding (https://www.w3.org/TR/sparql11-query/#docResultDesc)\n * @returns A collection \n */\nfunction binding2Obj(varNames, binding) {\n    var o = {};\n    varNames.forEach( varName => {\n        o[varName] = null;\n    });\n\n    for (var key in binding) {\n        var nodeValue = binding[key];\n        o[key] = parseNodeValue(nodeValue);\n    }\n    return o;\n};\n\n\n\n/**\n * Converts all bindings from the result of an SPARQL query to a plain js collection\n * @param {JSON} json A Json SPARQL query response \n */\nexport function bindingsToJsMap (json) {\n    const varNames = json.head.vars,\n          bindings = json.results.bindings;\n    return bindings.map(binding => binding2Obj(varNames, binding));\n};","import React, { Component } from 'react';\nimport * as _ from 'lodash';\nimport * as d3 from 'd3';\nimport { SDG_ARR, SDG_INFO } from '../common'\nimport { postQuery } from '../common/sparql/PostQuery';\nimport { bindingsToJsMap } from '../common/sparql/ResultSet';\nimport Annotation from '../components/Annotation';\nimport * as vega from 'vega';\nimport SPARQL from 'vega-transform-sparql';\nimport Select from 'react-select';\nimport sdg_by_country_data from '../data/flower/3-SDGs_by_country.json';\nimport textures from 'textures';\nvega.transforms['sparql'] = SPARQL;\n\nclass Treemap extends Component {\n\n    constructor(props) {\n        super(props);\n        this.createChart      = this.createChart.bind(this);\n        this.checkSizeForVega = this.checkSizeForVega.bind(this);\n        this.onCompareCountry = this.onCompareCountry.bind(this);\n\n        // object to populate the treemap\n        this.data = {\n            name:'root',\n            children: []\n        };\n\n        // comparison obj to populate\n        this.comparisonData = {\n            name:'root',\n            children: []\n        };\n        this.countryCompared = undefined;\n        \n        // dynamic query to retrieve SDG keyword\n        // by SDG and (optionally) by country\n        this.queryKeywordsBySDGAndCountry = (sdg='', country= '') => {\n            let filterCountry = country === ''? '': 'FILTER (?country = \"' + country + '\") . ';\n            return `PREFIX : <http://unics.cloud/ontology#>\n            SELECT\n            ?sdgName ?keyword (COUNT(DISTINCT ?projId) AS ?numProjs)\n            WHERE {\n            ?proj a :EC-Project .\n            ?proj :unicsId ?projId .\n            \n            ?proj :sdgReified ?sdgr .\n            ?sdgr :sdg ?sdg .\n            ?sdg :shortName ?sdgName .\n            ?sdgr :keyword ?kw .\n            ?kw :textualValue ?keyword .\n            \n            ?proj :ecParticipant ?part .\n            ?part :country ?cou .\n            ?cou :extendedName ?country .\n            ${filterCountry} \n            FILTER (?sdgName = \"${sdg}\")\n            }\n            GROUP BY ?sdgName ?keyword\n            ORDER BY ?sdgName DESC(?numProjs)\n            LIMIT 10`;\n        };\n\n        // svg textures for comparison mode\n        this.textures = {};\n        _.each(_.keys(SDG_INFO), key => {\n            this.textures[key] = textures.lines()\n                .size(8)\n                .strokeWidth(1)\n                .stroke(d3.rgb(SDG_INFO[key].color).darker(0.5))\n                .background(SDG_INFO[key].color)\n        });\n        this.textureLegend = textures.lines().size(8).strokeWidth(1).stroke('black');\n    }\n\n\n\n    /**\n     * Interval callback to check whether we \n     * have the markup ready to contain the\n     * vega charts. If so, stop interval and\n     * update state with the available height\n     * for the vega wordclouds. Check document\n     * object since it can be destroyed if modal\n     * window is closed before we get results\n     */\n    checkSizeForVega() {\n        clearInterval(this.interval);\n        document !== null && this.createChart(\n            document.querySelector('.modal-country').querySelector('.treemap-container').offsetWidth - (20 * 2), //padding of .modal-body\n            document.querySelector('.modal-country').querySelector('.treemap-container').offsetHeight- (20 * 2) //padding of .modal-body\n        );\n    }\n\n\n\n    createChart(width, height) {\n        const self = this;\n        // remove preloader text and exisiting treemap\n        d3.select('.sdg-treemap').select('.preloader-text').style('display', 'none');\n        d3.select('.sdg-treemap').select('.treemap').style('display', 'block');\n        \n        if(!_.isUndefined(this.countryCompared)) {\n            d3.select('.country-legend').style('display', 'block');\n            d3.select('#country-legend-svg').style('display', 'block');\n            d3.select('.country-legend-label').html('Striped area corresponds to <strong>' + this.countryCompared + '</strong>');\n        }\n\n        d3.select('#treemap-keyword').selectAll(\"*\").remove();\n\n        let root = d3.treemap()\n            .tile(d3.treemapSquarify)\n            .size([width, height])\n            .padding(_.isUndefined(this.countryCompared)? 0:1)\n            .round(true)\n        (d3.hierarchy(this.data)\n            .sum(d => d.value)\n            .sort((a, b) => b.value - a.value));\n        \n        const svg = d3.select('#treemap-keyword');\n        _.each(this.textures, t => svg.call(t));\n        svg.call(this.textureLegend);\n        svg.attr('width', width);\n        svg.attr('height', height);\n        \n        const leaf = svg.selectAll(\"g\")\n            .data(root.leaves())\n            .join(\"g\")\n            .attr(\"transform\", d => `translate(${d.x0},${d.y0})`)\n            .on('mouseover', function(d) {           \n                var ancestors = _.drop(d.ancestors().reverse(), 1).map(d => d.data.name);\n                Annotation.show(\n                    d.value + \n                    ' projects ' +\n                    ((d.data.valueSecondary)? \n                        '(' + d.data.valuePrimary + ' ' + self.props.country + ', ' + d.data.valueSecondary + ' ' + d.data.countryCompared + ') '\n                        : '') +\n                    'mentioning \"' +\n                    _.capitalize(ancestors[1]) + \n                    '\", classified as <span style=\"color:' + SDG_INFO[ancestors[0]].color + '\"><strong>' + \n                    SDG_INFO[ancestors[0]].shortTitle + '</strong></span>'\n                );\n                d3.select(this).select('rect')\n                    .style('fill', d3.rgb(SDG_INFO[ancestors[0]].color).darker(0.5));\n            })\n            .on('mouseout', function(d) {\n                var ancestors = _.drop(d.ancestors().reverse(), 1).map(d => d.data.name);\n                Annotation.hide()\n                d3.select(this).select('rect')\n                    .style('fill', SDG_INFO[ancestors[0]].color);\n            });\n\n        // clipping area, when comparing it clips to show only\n        // the proportion of the main country\n        leaf.append('clipPath')\n            .attr('id', d => d.ancestors().reverse().map(d => d.data.name).join('/').replace(/ /g, ''))\n            .append('rect')\n            .attr(\"width\", d => {\n                // if we have comparison data, clip \n                // proportionally, othwerise, clip to \n                // 100% (no clip)\n                return (d.data.valueSecondary)?\n                    (d.x1 - d.x0) * (d.data.valuePrimary / d.data.value) : d.x1 - d.x0;\n            })\n            .attr(\"height\", d => d.y1 - d.y0);\n\n        // rect representing the 100% (whether is a single\n        // country or the total of the two compared countries)\n        leaf.append(\"rect\")\n            .attr('fill', d => {\n                const sdg = _.drop(d.ancestors().reverse(), 1).map(d => d.data.name)[0];\n                return this.textures[sdg].url();\n            })\n            .attr(\"width\", d => d.x1 - d.x0)\n            .attr(\"height\", d => d.y1 - d.y0);\n\n        // rect, clipped (when comparing) to the value\n        // of the primary country relative to the sum\n        // of both countries\n        leaf.append(\"rect\")\n            .attr('class', 'treemap-cell')\n            .attr('clip-path', d => 'url(#' + d.ancestors().reverse().map(d => d.data.name).join('/').replace(/ /g, '') + ')')\n            .attr(\"fill\", d => d.data.color)\n            .attr(\"width\", d => d.x1 - d.x0)\n            .attr(\"height\", d => d.y1 - d.y0);\n        \n        leaf.append(\"text\")            \n            .selectAll(\"tspan\")\n            .data(d => d.data.name.split(/(?=[A-Z][a-z])|\\s+/g))\n            .join(\"tspan\")\n            .attr('class', 'treemap-text-label')\n            .attr(\"x\", 3)\n            .attr(\"y\", (d, i, nodes) => `${(i === nodes.length - 1) * 0.3 + 1 + i * 0.8}em`)\n            .attr(\"fill-opacity\", (d, i, nodes) => i === nodes.length - 1 ? 0.7 : null)\n            .text(d => d);\n        leaf.selectAll('text')\n            .attr('transform', function(d) {\n                var datum = d3.select(this).datum();\n                var bb = d3.select(this).node().getBBox();\n                var width = datum.x1 - datum.x0;\n                var height = datum.y1 - datum.y0;\n                var widthTransform = width*0.9 / bb.width;\n                var heightTransform = height*0.75 / bb.height; // be sure we leave v space for the value text\n                var value = widthTransform < heightTransform ? widthTransform : heightTransform;\n                d.scaleFactor = value;\n                return (\"transform\", \"matrix(\"+value+\", 0, 0, \"+value+\", 0,0)\");\n            });\n        /*\n        leaf.append('text')\n            .text(d => d.scaleFactor < 0.8 ? '' : d.value)\n            .style('dominant-baseline', \"baseline\")\n            //.style('text-anchor', 'middle')\n            .attr('class', 'treemap-text-value')\n            .attr('x', d => 5)\n            .attr('y', d => (d.y1 - d.y0) - 5)\n        */\n    }\n\n\n    async getSDGData(sdg, comparisonCountry = undefined) {\n\n        // if we pass a country we are comparing against the country of the modal\n        let comparisonMode = !_.isUndefined(comparisonCountry);\n\n        // get for current SDG, all SDG keywords\n        let queryResults = await postQuery(this.queryKeywordsBySDGAndCountry(sdg, comparisonCountry || this.props.country));\n        queryResults = bindingsToJsMap(queryResults);\n\n        // join and group by keyword\n        let bySDG = _.groupBy(queryResults, 'sdgName');\n\n        // prepare the object for the treemap\n        _.keys(bySDG).forEach(key => {\n            let grouped = bySDG[key];\n            var g = {\n                name: key,\n                children: _.map(\n                    grouped, \n                    d => { return {\n                        'name': d.keyword, \n                        'value': d.numProjs, \n                        'color': SDG_INFO[d.sdgName].color,\n                        'country': _.isUndefined(comparisonCountry)? 'primary':'secondary'\n                    }}\n                )\n            };\n            if(comparisonMode)\n                this.comparisonData.children.push(g);\n            else\n                this.data.children.push(g);\n        })\n    };\n\n\n\n    async onCompareCountry(option) {\n        \n        // update UI\n        d3.select('.sdg-treemap').select('.preloader-text').style('display', 'block');\n        d3.select('.sdg-treemap').select('.treemap').style('display', 'none');\n        d3.select('.country-legend').style('display', 'none');\n        d3.select('.country-legend-label').style('display', 'block');\n        d3.select('#treemap-keyword').selectAll(\"*\").remove();\n\n        this.countryCompared = option.value;\n\n        // recover original country data and clean comparison data\n        this.data = _.cloneDeep(this.safeData);\n        this.comparisonData = {\n            name:'root',\n            children: []\n        };\n\n        for(let i = 0; i < SDG_ARR.length; i++) {\n            await this.getSDGData(SDG_ARR[i], option.value);\n        }\n\n        // loop to main country and add info about the 2nd country\n        _.each(this.data.children, sdg => {\n            _.each(sdg.children, keyword => {\n                // look for the keyword on the 2nd country. If found\n                // then sum values\n                var o = _.find(this.comparisonData.children, sdg2 => sdg2.name === sdg.name);\n                var k = _.find(o.children, keyword2 => keyword2.name === keyword.name);\n                if(k) {\n                    keyword.valuePrimary    = keyword.value;\n                    keyword.valueSecondary  = k.value;\n                    keyword.value           = keyword.value + k.value;\n                    keyword.countryCompared = this.countryCompared\n                }\n            });\n        });\n        this.checkSizeForVega();\n    }\n\n\n\n    async componentDidMount() {\n        for(let i = 0; i < SDG_ARR.length; i++) {\n            await this.getSDGData(SDG_ARR[i]);\n        }\n        // make a safe copy of data\n        this.safeData = _.cloneDeep(this.data);\n        this.interval = setInterval(this.checkSizeForVega, 300);\n\n        d3.select('#country-legend-svg')\n            .attr('fill', this.textureLegend.url());\n    }\n\n    render() {\n        return <div className=\"sdg-treemap\">\n            <div className='preloader-text'>Loading data...</div>\n            <div className='treemap'>\n                <div class='row'>\n                    <div className='col-9 country-legend'>\n                        <svg id=\"country-legend-svg\" height='20' width='100'>\n                            <rect x='0' y='0' width='80' height='20'></rect>\n                        </svg>\n                        <span className='country-legend-label'></span>\n                    </div>\n                    <div className='col-3'>                        \n                        <div className='country-selector'>\n                            <Select \n                                classNamePrefix={\"country-selector\"}\n                                placeholder=\"Select country to compare...\"\n                                options={\n                                    _(sdg_by_country_data.map(d => { return {value:d.countryName, label:d.countryName}}))\n                                    .uniqBy('label')\n                                    .sortBy('label')\n                                    .value()\n                                }\n                                onChange={this.onCompareCountry}\n                            />\n                        </div>                \n                    </div>\n                </div>                \n                <svg id=\"treemap-keyword\"></svg>\n                {/*<ul>\n                    { _.range(1,17).map( n => <li><img src={'/images/SDG' + n + '@4x.png'}></img></li>) }\n                </ul>*/}\n            </div>\n        </div>\n    }\n}\nexport default Treemap;","import React, { Component } from 'react';\nimport { bindingsToJsMap } from '../common/sparql/ResultSet';\nimport { postQuery } from '../common/sparql/PostQuery';\nimport * as d3 from 'd3';\n\n\n\nclass CORDISKeywords extends Component {\n\n    async componentDidMount() {\n        //extent the number of keyword based on the number of SDG?\n\n        let query = `PREFIX : <http://unics.cloud/ontology#>\n            SELECT\n            ?keywordCORDIS (COUNT(DISTINCT ?projId) AS ?numProjs)\n            WHERE {\n            ?proj a :EC-Project .\n            ?proj :unicsId ?projId .\n            ?proj :startingYear ?year .\n            \n            ?proj :sdgReified ?sdgr .\n            ?sdgr :sdg ?sdg .\n            ?sdg :shortName ?sdgName .\n            filter (?sdgName = \"${this.props.sdgLabel}\") .\n            ?sdgr :keyword ?kw .\n            ?kw :textualValue ?keyword .\n            filter (?keyword = \"${this.props.keyword}\") .\n            ?proj :keyword ?kwCORDIS .\n            ?kwCORDIS :textualValue ?keywordCORDIS \n            }\n            GROUP BY ?keywordCORDIS\n            ORDER BY  DESC(?numProjs)\n            limit 20`;\n\n        try {\n            const queryResults = await postQuery(query);\n            this.setState({\n                data: bindingsToJsMap(queryResults)\n            });\n            \n        } catch (error) {\n            console.log(error);\n        }\n    }\n\n    render() {\n        const { data } = this.state || {};\n\n        if(data) {\n            const fontSizeScale = d3.scaleLinear()\n                .domain(d3.extent(data, d => d.numProjs).reverse())\n                .range([24, 10]);\n            \n            return <ul className=\"cordis-keyword-list\">\n                {\n                    data.map( (d, i) => {\n                        return <li key={i} style={{fontSize: fontSizeScale(d.numProjs) + 'px'}}> {d.keywordCORDIS}</li>\n                    })\n                }\n            </ul>\n        }\n        else\n            return <div/>;\n    }\n}\nexport default CORDISKeywords;","import React, { Component } from 'react';\nimport * as _ from 'lodash';\nimport { sdgKeywordTrend } from '../common/vega/VegaSpecifications';\nimport VegaChart from '../common/vega/VegaChart';\nimport CORDISKeywords from './CORDISKeywords';\nimport {SDG_INFO} from '../common/index';\n\nclass KeywordData extends Component {\n\n\n    constructor(props) {\n        super(props)\n        this.checkSizeForVega = this.checkSizeForVega.bind(this);\n    }\n\n\n\n    /**\n     * Interval callback to check whether we \n     * have the markup ready to contain the\n     * vega charts. If so, stop interval and\n     * update state with the available height\n     * for the vega wordclouds\n     */\n    checkSizeForVega() {\n        if(document.querySelector('.col-sdg') !== null) {\n            clearInterval(this.interval);\n            this.setState({\n                // space to allocate the Vega chart\n                columWidth: 0.9 * document.querySelector('.col-sdg').offsetWidth\n            });\n        }\n    }\n\n\n\n    componentDidMount() {\n        let dynamicSpecs = [];\n\n        this.props.sdgLabels.forEach( sdgLabel => {\n            let spec = _.cloneDeep(sdgKeywordTrend);\n            spec.data[1].transform[0].query = `PREFIX : <http://unics.cloud/ontology#>\n                SELECT\n                ?year ?sdgName ?keyword (COUNT(DISTINCT ?projId) AS ?numProjs)\n                WHERE {\n                    ?proj a :EC-Project .\n                    ?proj :unicsId ?projId .\n                    ?proj :startingYear ?year .\n                    \n                    ?proj :sdgReified ?sdgr .\n                    ?sdgr :sdg ?sdg .\n                    ?sdg :shortName ?sdgName .\n                    FILTER(?sdgName = \"${sdgLabel}\")\n                    ?sdgr :keyword ?kw .\n                    ?kw :textualValue ?keyword .\n                    FILTER(?keyword = \"${this.props.keyword}\")\n                }\n                GROUP BY ?year ?sdgName ?keyword\n                ORDER BY ?year ?sdgName DESC(?numProjs)`;\n            dynamicSpecs.push(spec);\n        });\n        \n        // set a timeout to give time to generate\n        // the markup so we can obtain a height\n        // for the vega chart (the vega chart\n        // needs the height in pixels)\n        this.interval = setInterval(this.checkSizeForVega, 300);\n\n        this.setState({ specs: dynamicSpecs });\n    }\n\n\n\n    render() {\n        const {\n            specs,\n            columWidth\n        } = this.state || {};\n        \n        let colWidth;\n        // decide column width\n        if(this.props.sdgLabels)\n            colWidth = (this.props.sdgLabels.length === 1)? 12 : \n                (this.props.sdgLabels.length === 2)? 6 :\n                (this.props.sdgLabels.length === 3)? 4 :\n                (this.props.sdgLabels.length === 4)? 3 : 2;\n\n        return <div className=\"container-fluid\">\n            {\n                specs && <div className=\"row justify-content-center\">\n                    {\n                        this.props.sdgLabels.map((sdgLabel, i) => {\n                            return <div key={i} className={\"col-sdg col-12 col-md-\" + colWidth}>\n                                <div className='img-header'>\n                                    <img alt='' src={'images/' + _.replace(sdgLabel, ' ', '') + '.png'}/>\n                                </div>\n                                <p>Trend of research projects mentioning <span><strong>{this.props.keyword}</strong></span>:</p>\n                                { columWidth && \n                                    <VegaChart\n                                        id={\"keyword-evolution\"}\n                                        spec={specs[i]}\n                                        padding={{top: 0, left: 0, right: 10, bottom: 0}}\n                                        autoSize={'fit'}\n                                        height={100}\n                                        width={columWidth}/>\n                                }                                \n                                <p>Find below the most frequent keywords for all projects related to <span><strong style={{color:SDG_INFO[sdgLabel].color}}>{SDG_INFO[sdgLabel].shortTitle}</strong></span>:</p>\n                                <CORDISKeywords \n                                    sdgLabel={sdgLabel}\n                                    keyword={this.props.keyword}/>\n                            </div>\n                        })\n                    }\n                    </div>\n            }                \n        </div>\n    }\n}\nexport default KeywordData;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"style\", {\n  type: \"text/css\"\n}, \"\\n\\t.st0{display:none;}\\n\\t.st1{display:inline;fill:#026BB6;stroke:#026BB6;}\\n\\t.st2{fill:none;stroke:#E2E7EC;stroke-width:11.7;stroke-linecap:round;}\\n\\t.st3{fill:none;}\\n\\t.st4{opacity:0.95;fill:none;stroke:#FFFFFF;stroke-width:3.9878;stroke-linecap:round;enable-background:new    ;}\\n\\t.st5{opacity:0.9;fill:none;stroke:#FFFFFF;stroke-width:2;enable-background:new    ;}\\n\\t.st6{opacity:0.9;fill:#FFFFFF;enable-background:new    ;}\\n\\t.st7{opacity:0.9;fill:#E2E7EC;enable-background:new    ;}\\n\\t.st8{fill:#999999;}\\n\\t.st9{font-family:'Arial-BoldItalicMT';}\\n\\t.st10{font-size:5px;}\\n\\t.st11{font-family:'Arial-ItalicMT';}\\n\\t.st12{fill:none;stroke:#B7B7B7;stroke-width:0.5;}\\n\\t.st13{fill:none;stroke:#B7B7B7;stroke-width:0.5;stroke-dasharray:0.9538,0.9538;}\\n\\t.st14{fill:#888888;}\\n\\t.st15{font-size:4px;}\\n\\t.st16{font-family:'ArialMT';}\\n\");\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"circle\", {\n  className: \"st1\",\n  cx: 0,\n  cy: -21.6,\n  r: 12.4\n});\n\nvar _ref4 =\n/*#__PURE__*/\nReact.createElement(\"g\", null, React.createElement(\"line\", {\n  className: \"st2\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 148.7,\n  y2: 40.4\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st4\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 91.7,\n  y2: 40.3\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st3\",\n  x1: 15.7,\n  y1: 40.2,\n  x2: 15.7,\n  y2: 40.2\n}), React.createElement(\"line\", {\n  className: \"st5\",\n  x1: 82.2,\n  y1: 34.9,\n  x2: 82.2,\n  y2: 45.6\n}), React.createElement(\"circle\", {\n  className: \"st6\",\n  cx: 148.7,\n  cy: 40.4,\n  r: 1\n}), React.createElement(\"circle\", {\n  className: \"st6\",\n  cx: 126.6,\n  cy: 40.3,\n  r: 1\n}), React.createElement(\"circle\", {\n  className: \"st6\",\n  cx: 104.4,\n  cy: 40.3,\n  r: 1\n}), React.createElement(\"circle\", {\n  className: \"st7\",\n  cx: 82.3,\n  cy: 40.3,\n  r: 1\n}), React.createElement(\"circle\", {\n  className: \"st7\",\n  cx: 60.1,\n  cy: 40.2,\n  r: 1\n}), React.createElement(\"circle\", {\n  className: \"st7\",\n  cx: 38,\n  cy: 40.2,\n  r: 1\n}), React.createElement(\"circle\", {\n  className: \"st7\",\n  cx: 16.2,\n  cy: 40.1,\n  r: 1\n}));\n\nvar _ref5 =\n/*#__PURE__*/\nReact.createElement(\"text\", {\n  transform: \"matrix(1 0 0 1 103.4044 7.9074)\"\n}, React.createElement(\"tspan\", {\n  x: 0,\n  y: 0,\n  className: \"st8 st9 st10\"\n}, \"Twice \"), React.createElement(\"tspan\", {\n  x: 15.3,\n  y: 0,\n  className: \"st8 st11 st10\"\n}, \"as specialized\"), React.createElement(\"tspan\", {\n  x: 0,\n  y: 6,\n  className: \"st8 st11 st10\"\n}, \"as all the countries\"));\n\nvar _ref6 =\n/*#__PURE__*/\nReact.createElement(\"g\", null, React.createElement(\"g\", null, React.createElement(\"line\", {\n  className: \"st12\",\n  x1: 104.4,\n  y1: 33.5,\n  x2: 104.4,\n  y2: 33\n}), React.createElement(\"line\", {\n  className: \"st13\",\n  x1: 104.4,\n  y1: 32.1,\n  x2: 104.4,\n  y2: 17.3\n}), React.createElement(\"line\", {\n  className: \"st12\",\n  x1: 104.4,\n  y1: 16.8,\n  x2: 104.4,\n  y2: 16.3\n})));\n\nvar _ref7 =\n/*#__PURE__*/\nReact.createElement(\"text\", {\n  transform: \"matrix(1 0 0 1 124.7691 50.0441)\",\n  className: \"st14 st11 st15\"\n}, \"x4\");\n\nvar _ref8 =\n/*#__PURE__*/\nReact.createElement(\"text\", {\n  transform: \"matrix(1 0 0 1 146.6626 50.0443)\",\n  className: \"st14 st11 st15\"\n}, \"x8\");\n\nvar _ref9 =\n/*#__PURE__*/\nReact.createElement(\"text\", {\n  transform: \"matrix(1 0 0 1 18.7758 7.9075)\"\n}, React.createElement(\"tspan\", {\n  x: 0,\n  y: 0,\n  className: \"st8 st9 st10\"\n}, \"Half \"), React.createElement(\"tspan\", {\n  x: 10.8,\n  y: 0,\n  className: \"st8 st11 st10\"\n}, \"as specialized\"), React.createElement(\"tspan\", {\n  x: 0.6,\n  y: 6,\n  className: \"st8 st11 st10\"\n}, \"as all the countries\"));\n\nvar _ref10 =\n/*#__PURE__*/\nReact.createElement(\"g\", null, React.createElement(\"g\", null, React.createElement(\"line\", {\n  className: \"st12\",\n  x1: 60.1,\n  y1: 33.5,\n  x2: 60.1,\n  y2: 33\n}), React.createElement(\"line\", {\n  className: \"st13\",\n  x1: 60.1,\n  y1: 32.1,\n  x2: 60.1,\n  y2: 17.3\n}), React.createElement(\"line\", {\n  className: \"st12\",\n  x1: 60.1,\n  y1: 16.8,\n  x2: 60.1,\n  y2: 16.3\n})));\n\nvar _ref11 =\n/*#__PURE__*/\nReact.createElement(\"text\", {\n  transform: \"matrix(1 0 0 1 34.6018 50.044)\",\n  className: \"st14 st11 st15\"\n}, \"1/4\");\n\nvar _ref12 =\n/*#__PURE__*/\nReact.createElement(\"text\", {\n  transform: \"matrix(1 0 0 1 12.7617 50.0441)\",\n  className: \"st14 st11 st15\"\n}, \"1/8\");\n\nvar _ref13 =\n/*#__PURE__*/\nReact.createElement(\"line\", {\n  className: \"st12\",\n  x1: 91.7,\n  y1: 60.1,\n  x2: 91.7,\n  y2: 41.2\n});\n\nvar _ref14 =\n/*#__PURE__*/\nReact.createElement(\"text\", {\n  transform: \"matrix(1 0 0 1 62.7431 65.8848)\"\n}, React.createElement(\"tspan\", {\n  x: 0,\n  y: 0,\n  className: \"st8 st16 st10\"\n}, \"Specialization Inde\"), React.createElement(\"tspan\", {\n  x: 42,\n  y: 0,\n  className: \"st8 st16 st10\"\n}, \"x\"), React.createElement(\"tspan\", {\n  x: 44.3,\n  y: 0,\n  className: \"st8 st16 st10\"\n}, \" score\"));\n\nvar _ref15 =\n/*#__PURE__*/\nReact.createElement(\"text\", {\n  transform: \"matrix(1 0 0 1 57.0173 50.0438)\",\n  className: \"st14 st11 st15\"\n}, \"1/2\");\n\nvar _ref16 =\n/*#__PURE__*/\nReact.createElement(\"text\", {\n  transform: \"matrix(1 0 0 1 102.3482 50.0437)\",\n  className: \"st14 st11 st15\"\n}, \"x2\");\n\nvar SvgSiLegend = function SvgSiLegend(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    id: \"spain\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 166.3 73.8\",\n    style: {\n      enableBackground: \"new 0 0 166.3 73.8\"\n    },\n    xmlSpace: \"preserve\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, _ref2, React.createElement(\"g\", {\n    className: \"st0\"\n  }, _ref3, React.createElement(\"text\", {\n    pointerEvents: \"none\",\n    transform: \"matrix(1 0 0 1 5 -26.6276)\",\n    className: \"st16\",\n    style: {\n      display: \"inline\",\n      fill: \"#014B7F\",\n      enableBackground: \"new\",\n      fontSize: \"14.9336px\"\n    }\n  }, \"Spain\")), _ref4, _ref5, _ref6, _ref7, _ref8, _ref9, _ref10, _ref11, _ref12, _ref13, _ref14, _ref15, _ref16);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgSiLegend, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/SI-legend.7bb2d408.svg\";\nexport { ForwardRef as ReactComponent };","import React, { Component, ReactComponent } from 'react';\nimport * as d3 from \"d3\";\nimport * as _ from 'lodash';\nimport 'intersection-observer';\nimport scrollama from 'scrollama';\nimport CountryPlots from '../CountryPlots'\nimport Introduction from '../Introduction'\nimport Header from '../Header';\nimport StreamRiver from '../Streamriver/StreamRiver';\nimport { Link, Element, animateScroll as scroll } from 'react-scroll'\nimport SDGTreemap from '../../components/SDGTreemap';\nimport withSizes from 'react-sizes';\nimport streamRiverKeywords from '../../data/streamriver/streamriver-keywords.json';\nimport modalHeaderData from '../../data/modal/countries_absolute_values.json'\nimport KeywordData from '../../components/KeywordData';\nimport keywordsIncrementsData from '../../data/keywords/keyword_relative_increment.json';\nimport CountryPlotGenerator from '../../components/CountryPlotGenerator';\nimport * as vega from 'vega';\nimport SPARQL from 'vega-transform-sparql';\nimport { IoMdClose } from \"react-icons/io\";\nimport { IoIosMenu } from \"react-icons/io\";\nimport VegaChart from '../../common/vega/VegaChart';\nimport { keywordsIncrements } from '../../common/vega/VegaSpecifications';\nimport { Modal } from 'react-bootstrap';\nimport {ReactComponent as LegendSDG} from '../../images/svg/SI-legend.svg';\n\n\nvega.transforms['sparql'] = SPARQL;\n\nvar Stickyfill = require('stickyfill');\n\nconst variableGroup =\n{\n    funding: {\n        country: 'p_fundingSDG',\n        ghost: 'p_totalFundingCORDIS',\n        sorting: 'totalFundingCountry'\n    },\n    projects: {\n        country: 'p_numProjectsSDG',\n        ghost: 'p_totalNumCORDIS',\n        sorting: 'totalProjectsCountry'\n    }\n}\n\n\nclass Home extends Component {\n\n    constructor() {\n        super();\n        this.state = {\n            loading: true,\n            step: 0,\n            stepStream: 0,\n            activeComponent: null,\n            selectedOption: null,\n            activeVariable: 'projects',\n            showModal: false,\n            activeMenu: false,\n            showModalKeyword: false\n        }\n\n        this.myCountryPlots = React.createRef();\n\n        this.toggleClass = this.toggleClass.bind(this);\n        this.scrollToTop = this.scrollToTop.bind(this);\n\n        // modal window when clicking a keyword\n        this.handleOpenModalKeyword = this.handleOpenModalKeyword.bind(this);\n        this.handleCloseModalKeyword = this.handleCloseModalKeyword.bind(this);\n        // modal window when clicking a country\n        this.handleOpenModalCountry = this.handleOpenModalCountry.bind(this);\n        this.handleCloseModalCountry = this.handleCloseModalCountry.bind(this);\n    }\n\n    handleOpenModalKeyword(keyword) {\n        // get SDGs where this keyword is present. Per each SDG\n        // the modal show a column with data related the presence\n        // of the keyword on the SDG, show we size the modal\n        // window width according the number of columns\n        let modalKeywordClassName;\n        const sdgLabels = _(streamRiverKeywords)\n            .filter(o => o.year > 2007 && o.year < 2020)\n            .filter(o => o.keyword === keyword)\n            .uniqBy('SDG')\n            .map('SDG')\n            .value();\n        switch (sdgLabels.length) {\n            case 1: modalKeywordClassName = 'modal-25w'; break;\n            case 2:\n            case 3: modalKeywordClassName = 'modal-75w'; break;\n            case 4:\n            default: modalKeywordClassName = 'modal-90w'; break;\n        }\n\n        this.setState({\n            showModalKeyword: true,\n            modalSDGLabels: sdgLabels,\n            modalKeywordClassName: modalKeywordClassName,\n            clickedKeyword: keyword\n        });\n    }\n\n    handleCloseModalKeyword() {\n        this.setState({\n            showModalKeyword: false,\n            modalSDGLabels: null,\n            modalKeywordClassName: null,\n            clickedKeyword: null\n        });\n    };\n\n    handleOpenModalCountry(countryName, countryData, id, countryVariable, ghostVariable, sortingVariable) {\n        this.setState({\n            showModalCountry: true,\n            modalTitle: countryName,\n            modalData: countryData,\n            modalIndicators: {\n                totalProjectsCountry: modalHeaderData.find(country => country.countryName === countryName).totalProjectsCountry,\n                totalProjectsCountrySDG: modalHeaderData.find(country => country.countryName === countryName).numProjectsInSomeSDG,\n                totalFundingCountry: modalHeaderData.find(country => country.countryName === countryName).totalFundingCountry,\n                totalFundingCountrySDG: modalHeaderData.find(country => country.countryName === countryName).classifiedFundingInSomeSDG\n            },\n            modalId: id,\n            modalCountryVariable: countryVariable,\n            modalGhostVariable: ghostVariable,\n            modalSortingVariable: sortingVariable\n        });\n    }\n\n    handleCloseModalCountry() {\n        this.setState({\n            showModalCountry: false\n        });\n    };\n\n    componentDidMount() {\n\n        let that = this;\n\n        var main = d3.select('main')\n\n        // PLOTS\n        var scrolly = main.select('#scrolly');\n        // var figure = scrolly.select('figure');\n        var article = scrolly.select('article');\n        var step = article.selectAll('.step');\n\n        // STREAM\n        var scrollyStream = main.select('#scrollyStream');\n        // var figure = scrolly.select('figure');\n        var articleStream = scrollyStream.select('article');\n        var stepStream = articleStream.selectAll('.step');\n\n        // initialize the scrollama\n        var scroller = scrollama();\n        var scrollerStream = scrollama();\n\n        // generic window resize listener event\n        function handleResize() {\n            // update height of step elements\n            // var stepH = Math.floor(window.innerHeight * 0.75);\n            // var stepHStream = Math.floor(window.innerHeight);\n            // step.style('height', stepH + 'px');\n            // stepStream.style('height', stepHStream + 'px');\n\n            // tell scrollama to update new element dimensions\n            scroller.resize();\n            scrollerStream.resize();\n        }\n\n        // scrollama event handlers\n        function handleStepEnter(response) {\n            // add color to current step only\n            step.classed('is-active', function (d, i) {\n                return i === response.index;\n            })\n\n            // update graphic based on step\n            that.setState({ step: response.index })\n        }\n\n\n        function handleStepEnterStream(response) {\n            // add color to current step only\n            stepStream.classed('is-active', function (d, i) {\n                return i === response.index;\n            })\n\n            // update graphic based on step\n            that.setState({ stepStream: response.index })\n        }\n\n        function setupStickyfill() {\n            d3.selectAll('.sticky').each(function () {\n                Stickyfill.add(this);\n            });\n        }\n\n        function init() {\n            setupStickyfill();\n\n            // 1. force a resize on load to ensure proper dimensions are sent to scrollama\n            handleResize();\n\n            // 2. setup the scroller passing options\n            // \t\tthis will also initialize trigger observations\n            // 3. bind scrollama event handlers (this can be chained like below)\n            scroller.setup({\n                step: '#scrolly article .step',\n                offset: 0.33,\n                debug: false,\n                progress: false,\n                order: true\n            }).onStepEnter(handleStepEnter);\n\n            scrollerStream.setup({\n                step: '#scrollyStream article .step',\n                offset: 0.33,\n                debug: false,\n                progress: false,\n                order: true\n            }).onStepEnter(handleStepEnterStream);\n\n\n            // setup resize event\n            window.addEventListener('resize', handleResize);\n        }\n\n        // kick things off\n        init();\n    }\n\n    toggleClass() {\n        const currentState = this.state.activeMenu;\n        this.setState({ activeMenu: !currentState });\n    }\n\n    scrollToTop() {\n        scroll.scrollToTop();\n    }\n\n    createTinyCountry(label, id, data, countryVariable, ghostVariable, sortingVariable) {\n        if(document.querySelector('.tinyCountry') === null)\n            return;\n    \n        const w = document.querySelector('.tinyCountry').offsetWidth,\n            h = document.querySelector('.tinyCountry').offsetHeight;\n\n        this.tinyCountryPlot = new CountryPlotGenerator(\n            '.tinyCountrySVG',\n            '',\n            id + '-tiny',\n            {\n                width: w * 1.2,\n                height: h * 1.2,\n                x: w / 2,\n                y: h / 2\n            },\n            data,\n            countryVariable,\n            ghostVariable,\n            sortingVariable\n        );\n        this.tinyCountryPlot.fold(false);\n        this.tinyCountryPlot.show();\n    };\n\n\n\n    render() {\n\n        const { \n            step, \n            activeVariable, \n            modalTitle, \n            modalIndicators,\n            modalData,\n            modalId,\n            modalCountryVariable,\n            modalGhostVariable,\n            modalSortingVariable\n        } = this.state;\n\n        const self = this;\n\n        return <main className=\"w-100\">\n\n            <nav className={`navbar jump-navigation p-0 ${this.state.activeMenu ? 'unfolded' : ''} `}>\n                <button className=\"jump-navigation_button jump-navigation_button-toggle\" onClick={this.toggleClass}>\n                    <IoMdClose className=\"opened\" color=\"#97aabb\" />\n                    <IoIosMenu className=\"closed\" color=\"#97aabb\" />\n                </button>\n\n                {/* <button className=\"jump-navigation_button jump-navigation_button-top\" onClick={this.scrollToTop}>\n                    <IoMdArrowUp color=\"#97aabb\" />\n                </button> */}\n\n                <ul className=\"nav flex-column\">\n                    <li className=\"nav-item\"><Link activeClass=\"active\" className=\"nav-link\" to=\"introduction\" spy={true} smooth={true} >Introduction</Link></li>\n                    <li className=\"nav-item\"><Link activeClass=\"active\" className=\"nav-link\" to=\"evolution\" spy={true} smooth={true} >Annual share of SDG-related funded projects</Link></li>\n                    <li className=\"nav-item\"><Link activeClass=\"active\" className=\"nav-link\" to=\"relationships\" spy={true} smooth={true} >How do countries specialise their R+I on the SDG?</Link></li>\n                    <li className=\"nav-item\"><Link activeClass=\"active\" className=\"nav-link\" to=\"tsne\" offset={200} spy={true} smooth={true} >How do countries group according to their R+I on SDGs?</Link></li>\n                    <li className=\"nav-item\"><Link activeClass=\"active\" className=\"nav-link\" to=\"ternary\" offset={200} spy={true} smooth={true} >How do countries distribute research between Economy, Society and Biosphere?</Link></li>\n                    <li className=\"nav-item\"><Link activeClass=\"active\" className=\"nav-link\" to=\"stream\" spy={true} smooth={true} >How do R+I interests evolve?</Link></li>\n                    <li className=\"nav-item\"><Link activeClass=\"active\" className=\"nav-link\" to=\"methodology\" spy={true} smooth={true}>Methodology / Background</Link></li>\n                </ul>\n            </nav>\n\n            <Element name=\"introduction\" className=\"anchor\">\n                <Header canvasId={'canvas-header'} />\n                <section id=\"home\" className=\"container-fluid py-5 bg-white\">\n                    <div className=\"container\">\n                        <div className=\"row\">\n                            <div className=\"col-12 col-md-6\">\n                                <p>On this website, we present an application of this methodology: <strong>we have classified the textual descriptions of all research and innovation (R&I) projects</strong> financed by the European Commission under the <strong>7th Framework Programme</strong> (FP7) and <strong><a href='https://ec.europa.eu/programmes/horizon2020/en' target='_blank' rel=\"noopener noreferrer\">Horizon 2020</a></strong> (H2020) into the SDGs, and developed a set of visualisations exploring the temporal evolution and the country specialisation of SDG-related efforts.</p>\n                            </div>\n                            <div className=\"col-12 col-md-6\">\n                                <img src=\"/images/sdg-hero-800x800.png\" style={{width: '100%'}}></img>                                \n                            </div>\n                        </div>\n                    </div>\n                </section>\n\n                <section className=\"container-fluid py-5\">\n                    <div className=\"container\">\n                        <div className=\"row\">\n                            <div className=\"col-12 col-md-6\">\n                                <p>Behind the data there are collaborative projects by actors in Europe and abroad, such as <a href='https://cordis.europa.eu/project/id/727450' target='_blank' rel=\"noopener noreferrer\"><strong>WATERPROTECT</strong></a>, which “contributes to effective uptake and realisation of management practices and mitigation measures to protect drinking water resources” in rural and urban environments, or <a href='https://cordis.europa.eu/project/id/645668' target='_blank' rel=\"noopener noreferrer\"><strong>SALEACOM</strong></a>, which proposes “an innovative education for a new century with, with a global scope, to address educational and social exclusion in schools and learning communities.”</p>\n                            </div>                            \n                        </div>\n                    </div>\n                </section>\n            </Element>\n            \n            <Element name=\"evolution\" className=\"anchor\">\n                <section id=\"intro\" className=\"container-fluid px-0 bg-white\">\n                    {<Introduction isMobile={this.props.isMobile} />}\n                </section>\n            </Element>\n\n            {   modalTitle && \n                !this.props.isMobile && \n                <Modal show={this.state.showModalCountry}\n                    onHide={this.handleCloseModalCountry}\n                    dialogClassName={'modal-country modal-90w'}\n                    animation={false}>\n                    <Modal.Body>\n                        <div className=\"container-fluid\">\n                            <div className=\"row\">\n                                <div className=\"col-2 stats-container\">   \n                                    <h4>{modalTitle.toUpperCase()}</h4>\n                                    <div className=\"tinyCountry\" style={{width: '100%', display:'block', height:'200px'}}>\n                                        <svg className=\"tinyCountrySVG\" height=\"100%\" width=\"100%\">\n                                            {\n                                                setTimeout(() => {\n                                                    this.createTinyCountry(\n                                                        modalTitle, \n                                                        modalId, \n                                                        modalData, \n                                                        modalCountryVariable, \n                                                        modalGhostVariable, \n                                                        modalSortingVariable\n                                                    );\n                                                }, 300)\n                                            }\n                                        </svg>\n                                    </div>     \n                                    <div className=\"caption\">\n                                        <strong>How are its R&I projects related to the SDGs?</strong> The plot on the right shows the top 10 most recurrent SDG keywords\n                                    </div>                               \n                                    <p style={{borderTop: \"1px solid whitesmoke\", paddingTop: '5px'}}>Total projects:</p>\n                                    <h5>{\n                                        modalIndicators.totalProjectsCountry < 1000 ? \n                                            modalIndicators.totalProjectsCountry :\n                                            d3.format(\".3s\")(modalIndicators.totalProjectsCountry)\n                                    }</h5>\n                                    <p>Total SDG-related projects:</p>\n                                    <h5>{\n                                        modalIndicators.totalProjectsCountrySDG < 1000 ?\n                                        modalIndicators.totalProjectsCountrySDG :\n                                        d3.format(\".3s\")(modalIndicators.totalProjectsCountrySDG)\n                                    }</h5>\n                                    <p>Total funding:</p>\n                                    <h5>€{d3.format(\",.0f\")(modalIndicators.totalFundingCountry)}</h5>\n                                    <p>TOTAL funding in SDG-related projects</p>\n                                    <h5>€{d3.format(\",.0f\")(modalIndicators.totalFundingCountrySDG)}</h5>                                    \n                                </div>\n                                <div className=\"col-10 treemap-container\">\n                                    <SDGTreemap country={modalTitle}></SDGTreemap>\n                                </div>\n                            </div>\n                        </div>\n                    </Modal.Body>\n                </Modal>\n            }           \n            \n            <div className=\"divider divider-grey2white\"/>\n\n            <div className='container-fluid title-section' >\n                <div className=\"row justify-content-md-center\">\n                    <div className=\" align-self-center col-12 col-lg-8 text-center\">\n                        <h1 className=\"mt-5 mb-3\">\n                            “Hot topics”: which keywords have gained more presence in the descriptions of R&I projects?\n                        </h1>\n                        <p style={{margin: \"1rem 10%\"}}>\n                        This word cloud presents the most distinctive and frequent words in the project’s titles and objectives. The color palette represents words that are relatively more (less) frequent in Horizon 2020 versus the 7th Framework Programme.\n                        </p>\n                        <p style={{margin: \"1rem 10% 0\"}}>\n                            <span className=\"highlight instruction\">Click on any keyword</span> for more information about the associated SDGs and their most frequent keywords.\n                        </p>\n                    </div>                                        \n                </div>\n                <div className=\"row justify-content-center\">\n                    <div className=\"col-12 text-center\">\n                        <VegaChart\n                            id={\"keywords\"}\n                            chartClass={'keywords-container'}\n                            spec={keywordsIncrements}\n                            data={keywordsIncrementsData.map(o => {\n                                o.keyword = _.capitalize(o.keyword);\n                                return o;\n                            })}\n                            width={this.props.keywordsBreakpoint && 900}\n                            height={600}\n                            runAfterCallback={() => {\n                                const svg = d3.select('.keywords-container svg');                                                                \n                                svg.selectAll('.nodes-texts text')\n                                    .style('fill', function(d) {\n                                        return d3.color(\n                                            d3.select(this).style('fill')\n                                        ).darker(1).formatHex();\n                                    })\n                                    .style('cursor', 'pointer')\n                                    .on('click', function(d) {\n                                        const me = d3.select(this);\n                                        let keyword = [];\n                                        if(me.selectAll('tspan').size() > 0)\n                                            me.selectAll('tspan').each( function() {\n                                                keyword.push(d3.select(this).text());\n                                            })\n                                        else\n                                            keyword.push(me.text());\n    \n                                        self.handleOpenModalKeyword(\n                                            keyword.join(\" \").toLowerCase()\n                                        );\n                                    })\n                                    .on('mouseover', function(d) {\n                                        d3.select(this)\n                                            .style('text-shadow', '1px 1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, -1px -1px 0 #fff');\n                                        d3.select(this.parentNode.parentNode).select('path')\n                                            .style('stroke-width', 2)\n                                            .style('stroke-dasharray', 'none')\n                                    })\n                                    .on('mouseout', function(d) {\n                                        d3.select(this)\n                                            .style('text-shadow', 'none');\n                                        d3.select(this.parentNode.parentNode).select('path')\n                                            .style('stroke-width', 1)\n                                            .style('stroke-dasharray', '1,1')\n                                    })\n                                    \n                            }}\n                        />\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"divider divider-white2grey\"/>\n\n            <div className='container-fluid title-section bg-light' >\n                <div className=\"row justify-content-md-center\">\n                    <div className=\" align-self-center col-12 col-lg-8 text-center\">\n                        <h1 className=\"mt-5 mb-3\">\n                            How do different countries specialise their research and innovation on the SDG?\n                        </h1>\n                    </div>\n                </div>\n            </div>\n\n\n            <section id=\"scrolly\" className=\"scrolly scrolly-dots container-fluid bg-light\">\n\n                <figure className=\"scrolly-wrapper\">\n                    <CountryPlots\n                        ref={this.myCountryPlots}\n                        step={step}\n                        countryVariable={variableGroup[activeVariable].country}\n                        ghostVariable={variableGroup[activeVariable].ghost}\n                        sortingVariable={variableGroup[activeVariable].sorting}\n                        openModal={this.handleOpenModal}\n                        closeModal={this.handleCloseModal}\n                        isOpen={this.state.showModal}\n                        handleOpenModalCountry={this.handleOpenModalCountry}\n                        isMobile={this.props.isMobile}\n                    ></CountryPlots>\n                </figure>\n\n                <article className=\"scrolly_tracker\">\n\n                    <Element name=\"relationships\" className=\"anchor\">\n                        <div className=\"step is-active\" data-scrollama-index=\"0\">\n                            <p style={this.props.isMobile ? { marginTop: '50vh' } : {}} className=\"pt-0 pt-sm-5\">This visualization provides two measures describing the <strong>pattern of activity of countries across the SDGs</strong>. <br/><br/>The size of each bar corresponds to the percentage of projects related to a given SDG for that country. <br/>Inside the bar there is a scale depicting the Specialization Index (SI), also known as <a href=\"https://en.wikipedia.org/wiki/Economic_base_analysis\" target='_blank' rel=\"noopener noreferrer\">location quotient</a>, a measure of the distribution of projects across SDGs in the country in comparison to the general distribution for all countries.</p>\n                            <p>The inner bar of the SDG bar represents the SI score, as follows:</p>\n                            <LegendSDG/>\n                        </div>\n                        <div className=\"step\" data-scrollama-index=\"1\" style={this.props.isMobile ? { opacity: 0, zIndex: 0 } : {}}>\n                            <p className=\"d-none d-sm-block\">To the right of the selected country, the smaller plots show the 4 countries featuring the most similar specialization pattern  in terms of SDG.</p>\n                            <p style={this.props.isMobile ? { pointerEvents: 'none' } : {}}>SDGs in this plot are organized in three spheres: those pertinent to the <strong>Economy</strong> only, to <strong>Society</strong> as a whole and to the “all-encompassing” <strong>Biosphere</strong>, as proposed by the <a href='https://www.stockholmresilience.org/SDG2016' target='_blank' rel=\"noopener noreferrer\">Stockholm Resilience Center</a>.</p>\n                            <p style={this.props.isMobile ? { pointerEvents: 'none' } : {}}>In this framework, all initiatives supporting the Economy must be consistent with societal needs, and both with sustainability in the Biosphere.</p>\n                            <p style={this.props.isMobile ? { pointerEvents: 'none' } : {}}><span className=\"highlight instruction\">Click on the <strong>(+) sign</strong></span> of a country for more detailed information on the projects and specialisation of the country.</p>\n                        </div>\n                        <div className=\"step\" data-scrollama-index=\"2\">\n                            <h3 className=\"d-none d-sm-block\">What characteristic specialisation patterns can we find?</h3>\n                            <p style={this.props.isMobile ? { marginTop: '-80vh' } : {}}><span className=\"highlight instruction\">Click on the following countries</span>, to show that <span onClick={() => this.myCountryPlots.current.handleChange({ label: 'Portugal' })} className='highlight sdg-9'>Portugal</span>, <span onClick={() => this.myCountryPlots.current.handleChange({ label: 'Ireland' })} className='highlight sdg-9'>Ireland</span> and <span onClick={() => this.myCountryPlots.current.handleChange({ label: 'Romania' })} className='highlight sdg-9'>Romania</span> are highly specialised in SDG 9 Industry, Innovation and Infrastructure.</p>\n                            <p style={this.props.isMobile ? { marginTop: '50vh' } : {}}><span onClick={() => this.myCountryPlots.current.handleChange({ label: 'Croatia' })} className='highlight sdg-11'>Croatia</span> is highly specialised in SDG 11 Sustainable Cities and Communities.</p>\n                            <p style={this.props.isMobile ? { marginTop: '50vh' } : {}}><span onClick={() => this.myCountryPlots.current.handleChange({ label: 'Norway' })} className='highlight sdg-14'>Norway</span> is highly specialised in SDG 14 Life Below Water.</p>\n                        </div>\n                    </Element>\n\n                    <Element name=\"tsne\" className=\"anchor\">\n                        <div className=\"step\" data-scrollama-index=\"3\">\n                            <h3 className=\"\" style={this.props.isMobile ? { marginTop: '15vh' } : {}}>Can we group countries according to their research and innovation portfolio on SDGs? </h3>\n                            <p className=\"d-none d-sm-block\">The research and innovation of each country is distributed across the 16 SDGs.<br />This means that each country can be represented as a 16-dimensional vector.</p>\n                            <p className=\"d-none d-sm-block\">Here we use a popular dimensionality reduction technique called <a href='http://www.jmlr.org/papers/volume9/vandermaaten08a/vandermaaten08a.pdf' target=\"_blank\" rel=\"noopener noreferrer\">t-sne</a> to represent those vectors into a 2-dimensional space.</p>\n                            <p style={this.props.isMobile ? { marginTop: '75vh' } : {}}>In this representation, <strong>each point is a country and closer points have similar SDG-related research portfolios.</strong></p>\n                        </div>\n                        <div className=\"step\" data-scrollama-index=\"4\" style={this.props.isMobile ? { opacity: 0, zIndex: 0 } : {}}>\n                            <p>Not all countries have equal access to the European Commission Funding.</p>\n                            <p>For this reason, European Union members and <a href=\"https://ec.europa.eu/research/iscp/index.cfm?pg=associated\" target=\"_blank\" rel=\"noopener noreferrer\">Associated countries</a> have more projects, and they cluster closely, while third countries are scattered across the plot, with more distinctive research and innovation portfolio.</p>\n                            <p><span className=\"highlight instruction\">Use the stripes graph</span>(<img src=\"images/stripes.png\" style={{ maxHeight: '14px', display: 'inline' }} alt=\"Range stripes\" />),  representing the country distribution based on number of projects, to select/mark subsets of data in the graph.</p>\n                            <p><span className=\"highlight instruction\">Click</span> on a country point to reveal more data about the country.</p>\n                        </div>\n                        <div className=\"step\" data-scrollama-index=\"5\">\n                            <p>\n                                The larger EU countries (<strong>Germany</strong>, <strong>France</strong>, <strong>UK</strong>, <strong>Italy</strong>, <strong>Netherlands</strong>, <strong>Spain</strong>…) cluster together, with a similar, evenly distributed, portfolio of activities.\n                            </p>\n                            <p>\n                                Smaller countries in the EU have a more distinctive pattern of specialisation, with many of them focusing on GOAL 9 Industry, Innovation and Infrastructure.\n                            </p>\n                        </div>\n                        <div className=\"step\" data-scrollama-index=\"6\">\n                            <p style={this.props.isMobile ? { marginTop: '25vh' } : {}}>In the middle range of number of projects (countries with 100 to 1000 projects), we see countries with a more specialised pattern of activity across the Goals.</p>\n                        </div>\n                        <div className=\"step\" data-scrollama-index=\"7\">\n                            <p style={this.props.isMobile ? { marginTop: '50vh' } : {}}>In the range with the lower number of projects (countries with 1 to 100 projects), we see the most extreme specialisation and collaboration patterns. Countries orbit in the perimeter of the distributions according to their similarity</p>\n                        </div>\n                    </Element>\n\n                    <Element name=\"ternary\" className=\"anchor\">\n                        <div className=\"step\" data-scrollama-index=\"8\">\n                            <h3 className=\"d-none d-sm-block\">How do countries distribute research between Economy, Society and Biosphere related goals?</h3>\n                            <p>SDG distributions can be summarised in a three-dimensional space spanning the following three spheres of impact: <strong>Economy only, Society as a whole, Biosphere in general</strong>.</p>\n                            <p className=\"d-none d-sm-block\">But since distributions are normalised, each country actually lies in a two-dimensional plane called <a href='https://en.wikipedia.org/wiki/Simplex' target='_blank' rel=\"noopener noreferrer\">simplex</a>.\n                            </p>\n                            <p>\n                                The plot on the left shows the distribution of countries across this plane.\n                            </p>\n                        </div>\n                        <div className=\"step\" data-scrollama-index=\"9\">\n                            <p className=\"d-none d-sm-block\">Many of the patterns observed and highlighted in the previous visualisation become apparent here.\n                            </p>\n                            <p>\n                                Feel free to explore how countries specialise and collaborate in research and innovation!\n                            </p>\n                            <p>\n                                <span className=\"highlight instruction\">Click on any country</span> for more information on the projects of the country.\n                            </p>\n                        </div>\n                    </Element>\n                </article>\n            </section>\n\n            <Modal show={this.state.showModalKeyword}\n                onHide={this.handleCloseModalKeyword}\n                dialogClassName={'modal-keyword ' + this.state.modalKeywordClassName}\n                animation={false}>\n                <Modal.Header closeButton>\n                    <Modal.Title>{this.state.clickedKeyword}</Modal.Title>\n                </Modal.Header>\n                <Modal.Body>\n                    <p className=\"subheader\">appears in the following SDGs:</p>\n                    <KeywordData keyword={this.state.clickedKeyword} sdgLabels={this.state.modalSDGLabels} />\n                </Modal.Body>\n            </Modal>\n\n            <div className=\"divider divider-grey2white\"/>\n\n            <Element name=\"stream\" className=\"anchor\">\n                <div className='container-fluid title-section bg-white' >\n                    <div className=\"row justify-content-md-center\">\n                        <div className=\" align-self-center col-12 col-lg-8 text-center\">\n                            <h1>How do research and innovation interests evolve?</h1>\n                        </div>\n                        <div className=\" align-self-center col-12 col-lg-8 text-center\">\n                            <p style={{margin: \"1rem 10%\"}}>\n                                This plot presents the evolution of the most frequent SDG-related words found in the titles and descriptions of all the projects, organised by Goal. This provides a view of the specific topics of interest of the policy instruments and of the funded projects, and how these terms evolve through time.\n                            </p>\n                            <p style={{margin: \"1rem 10%\"}}>\n                                <span className=\"highlight instruction\">Click on any keyword</span> for more information about the associated SDGs and their most frequent keywords.\n                            </p>\n                        </div>\n                    </div>\n                </div>\n                 <StreamRiver handleOpenModalKeyword={this.handleOpenModalKeyword} />\n            </Element>\n\n            <div className=\"divider divider-white2grey\" style={{marginTop: '5vh'}}/>\n\n            <Element name=\"methodology\" className=\"anchor\">\n                <Header canvasId={'canvas-footer'} direction='up' />\n            </Element>\n\n            <div className=\"divider divider-grey2white\"/>\n\n            <div className=\"container\" style={{marginBottom: \"5vh\"}}>\n                <div className=\"row justify-content-md-center\">\n                    <div className=\"align-self-center col-12\">\n                        <h1>Background</h1>\n                        <p>\n                            The United Nations General Assembly ratified in 2015 the <a href=\"http://www.un.org/ga/search/view_doc.asp?symbol=A/RES/70/1&Lang=E\" target=\"_blank\" rel=\"noopener noreferrer\">2030 Agenda for Sustainable Development</a>, as a plan for “action to end poverty, protect the planet and improve the lives and prospects of everyone, everywhere”. The Agenda outlines 17 <a href=\"https://www.un.org/sustainabledevelopment/sustainable-development-goals/\" target=\"_blank\" rel=\"noopener noreferrer\">Sustainable Development Goals (SDGs)</a>, conceived to be a \"blueprint to achieve a better and more sustainable future for all”. The Goals concern all continents and societies, they concern all of us and the new generations to come.\n                        </p>\n                        <p>                                        \n                            In this context, the United Nations Sustainable Development Summit in September 2015, <a href=\"https://sustainabledevelopment.un.org/content/documents/19009STI_Roadmap_Background_Paper_pre_STI_Forum_Final_Draft.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">“positioned Science, Technology and Innovation (STI) as key means of implementation of the SDGs”</a>, and is developing a policy framework for the development of <a href=\"https://sustainabledevelopment.un.org/partnership/?p=33852\" target=\"_blank\" rel=\"noopener noreferrer\">STI for SDGs Roadmaps</a> (click <a href=\"https://sdg.iisd.org/commentary/policy-briefs/sdg-knowledge-weekly-science-technology-and-innovation-roadmaps-for-the-sdgs/\" target=\"_blank\" rel=\"noopener noreferrer\">here</a> for more information).  \n                        </p>\n                        <p>\n                            In the European Union, the <a href=\"https://ec.europa.eu/commission/publications/reflection-paper-towards-sustainable-europe-2030_en\" target=\"_blank\" rel=\"noopener noreferrer\">Agenda 2030 is preeminent in the strategic framework</a> guiding the next programming period; most or all policy areas are impacted and necessary to achieve the desired progress towards the goals. Particularly, in the new Research and Innovation Framework Programme of the European Commission, Horizon Europe, the SDGs set the stage for “Clusters in the Global Challenges and Industrial Competitiveness pillar” and the research and innovation Missions, amongst other policy elements.\n                        </p>\n                        <p>\n                            In this context, we have participated in projects aimed at mapping the relationship between science and innovation activities and the SDGs, led by higher education and research institutions, public administrations and sectoral or disciplinary organisations. An exciting example is <a href=\"http://ris3mcat.gencat.cat/#/\" target=\"_blank\" rel=\"noopener noreferrer\">RIS3-MCAT</a>, the Catalan smart specialisation monitoring platform, developed by the <a href=\"http://catalunya2020.gencat.cat/en/inici/index.html\" target=\"_blank\" rel=\"noopener noreferrer\">Generalitat de Catalunya</a>, which allows users to explore publicly-funded research and innovation projects related to each SDG (using the filter “ODS”, Objectius de desenvolupament sostenible). Find <a href=\"https://s3platform.jrc.ec.europa.eu/sustainable-development-goals\" target=\"_blank\" rel=\"noopener noreferrer\">here</a> more information about Smart Specialisation for Sustainable Development Goals.\n                        </p>\n                        <hr/>\n                        <p>\n                            <a href=\"http://www.sirisacademic.com/\" target='_blank' rel=\"noopener noreferrer\">SIRIS Academic</a><br/>\n                            info@sirisacademic.com\n                            <br/>\n                            © SIRIS Academic, 2020                    \n                        </p>  \n                    </div>\n                </div>\n            </div>\n        </main>\n    }\n}\n\nconst mapSizesToProps = ({ width }) => ({\n    isMobile: width < 768,\n    keywordsBreakpoint: width <= 900\n})\n\nexport default withSizes(mapSizesToProps)(Home);","import React from 'react';\nimport { Router, Route, Switch } from 'react-router-dom';\n\nimport { history } from './common';\nimport Home from './containers/Home';\n\nexport const RouteApp = props => {\n    return (   \n        <Router history={history}>\n            <Switch>\n                <Route exact path={`${process.env.PUBLIC_URL}/`} component={Home} />    \n            </Switch>\n        </Router>\n    )        \n}","import React from 'react';\nimport { RouteApp } from './routes';\n\nclass App extends React.Component {\n  render() {\n      return (\n          <div className=\"app-container\">\n              <RouteApp />\n          </div>\n      )        \n  } \n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}