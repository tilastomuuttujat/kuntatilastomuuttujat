<!DOCTYPE html>
<meta charset="utf-8">
<title>Four Noble Truths Chart</title>
<link rel="stylesheet" type="text/css" href="./inspector.css">
<body>
<script type="module">

//import define from "./index.js";
import {Runtime, Library, Inspector} from "./runtime.js";

const runtime = new Runtime();
const main = runtime.module(define, Inspector.into(document.body));

import define1 from "./e93997d5089d7165@2303.js";
import define2 from "./576f8943dbfbd395@114.js";

function _1(md){return(
md`# Four Noble Truths Chart

- **Make Your Own Translation!**
  - Fill out the [GoogleSheet Translation Table](https://docs.google.com/spreadsheets/d/14jOoMTnVV0dQc4NZ8keP3pjiLVOrS4IIDPc_xISSxlA/edit#gid=0) with your language
  - Add your own Language by adding three new columns (**yourLanguage, yourLanguageFontSize, yourLanguageLetterSpacing**) like the previous ones (and refresh this page)!
  - Put the chart window on the left and the translation table on the right **on your screen** to ease the work. See [this sceenshot](https://observablehq.com/d/3915c29fed00300c#screenshot20221130At154010) for example.
  - Click on the button **"Refresh Translation"** for updating the chart when adding new translations.
  - Add numbers in the column **FontSize** and **LetterSpacing** to adapt your words to the chart. The font is 10 by default.
  - Use "**//**" (**double slash**) to indicate line break
  - Use **Title Case Capitalisation** ([link](https://apastyle.apa.org/style-grammar-guidelines/capitalization/title-case))
  - **Adjust the x & y coordinate** below the chart when working in a small area of translation.
  - Uncheck the **Display** checkboxes that are not necessary to have a faster rendering when translating
- **Sources**:
  - [Outline of Buddhism](https://en.wikipedia.org/wiki/Outline_of_Buddhism#:~:text=Buddhism%20(Pali%2FSanskrit%3A%20%E0%A4%AC%E0%A5%8C%E0%A4%A6%E0%A5%8D%E0%A4%A7,%2C%20%22the%20awakened%20one%22) (wikipedia.org)
  - [Buddha's Lists](https://www.dhammawiki.com/index.php?title=Category:Buddha%27s_Lists) (dhammawiki.com)
  - [iDhamma Guide](https://www.idhamma.org/)
  - [A Gradual Training](https://www.accesstoinsight.org/ptf/dhamma/index.html) (accesstoinsight.org)
- **Target Image**: [At the bottom](https://observablehq.com/d/3915c29fed00300c#cell-2314)
- **Expected Date of Completion:** April 2023
- **Title to Consider** : The Dhamma Citadel (4NT Citadel) / The Castle of the Buddha / The Citadel of Dhamma

Gradient: 
- https://codepen.io/blackjacques/pen/qBBwjmd?anon=true&view=pen
- https://www.visualcinnamon.com/2016/05/data-based-svg-gradient-d3/
- DOM.uid() for gradient and poly ? https://observablehq.com/@d3/gradient-encoding`
)}

function _2(md){return(
md`# The Dhamma Citadel

- **Medieval Castle Terminology **: [At the bottom](https://observablehq.com/d/3915c29fed00300c#medievalCastleTerminology)
- See [The Simile of the Citadel](https://suttacentral.net/an7.67/en/sujato?layout=plain&reference=none&notes=asterisk&highlight=false&script=latin)
  
<details>
  <summary>Citatel Parts</summary>

<ul>
<li>Donjon or Keep or Great Tower : 4NT
</li>
<li>Donjon Chemise : 4 Duties
</li>
  <br>
  
<li>NW Higher Bailey / Ward : 5A
</li>
<li>NW Inner Stockade (Pallisade) : 3Char
</li>
<li>NW Lower Bailey : N&amp;F, 6Consc
</li>
<li>NW Corner Stone : 6S
</li>
<li>NW Corner Tower : 31P
</li>
<li>SW Higher Bailey : 3Crav
</li>
<li>SW Inner Stockade : 3 Roots
</li>
<li>SW Lower Bailey : 3Eff (7Eff), 4 Cling
</li>
<li>SW Corner Stone : 5H
</li>
<li>SW Corner tower : 3Bec
</li>  <br>
<li>SE Heiger Bailey : 8FP
</li>
<li>SE Inner Srockade : 3Train
</li>
<li>SE Lower Bailey : RV, 3RI, 4RS, 3RA, 5RL, 4REF, 4FofM, 4Jh
</li>
<li>SE Corner Stone : 4REF
</li>
<li>SE Corner Tower : 4FofM
</li>
<li>NE Higher Bailey : 10FP &amp; 4SofE
</li>
<li>NE Inner Stockade : Final Division, Abandonned Fett
</li>
<li>NE Lower Bailey : 6HighKn, 10Fet
</li>
<li>NE Corner Stone : 7FoE
</li>
<li>NE Corner Tower : 16 SofA
</li>  <br>
<li>W Inner Wall : 12 DO
</li>
<li>E Inner Wall : 12 TDO
</li>
<li>W Outer Wall : 8NfI
</li>
<li>E Outer Wall : 8NfL
</li>  <br>
<li>W Gate/Flanking Tower : 5Rev, 10Per, 7SD, 7Esc, 3Van, 4PracTrainee (purity, sens-rest, food, wake)
</li>
<li>South Flanking Tower : 62WV
</li>
<li>E Flanking Tower : 37WtA/38Bless
</li>
<li>N Flanking Tower : 3Gem
</li>  <br>
<li>SW Battlement : 10FDh, 10CourseWrong
</li>
<li>SE Battlement : 10TDh, 10CourseGood
</li>
<li>NW Battlement : 3Suff, 8WorWind
</li>
<li>NE Battlement : 9Jh, 2Nib
</li>  <br>
<li>N-NW Watch Tower : 4HeavMess
</li>
<li>W-NW Watch Tower : 4Nut
</li>
<li>W-SW Watch Tower : 3Conceits
</li>
<li>S-SW Watch Tower : 4Unspeculable
</li>
<li>S-SE Watch Tower : 4FacSE
</li>
<li>E-SE Watch Tower : 4Post/3Pil
</li>
<li>E-NE Watch Tower : 4DivA
</li>
<li>N-NE Watch Tower : 4BofP
</li><br>
<li>N Circular Rampart : 33SfN
</li>
<li>S Circular Rampart : 32PoB
</li>
</ul>



</details>
`
)}

function _3($0,$1,$2,$3,$4,htl){return(
htl.html` <span style="font: 700 0.9rem sans-serif;"> Colors</span>
<table style="margin:0">
<tr><td><td>${$0}</td><td>${$1}</td><td>${$2}</td><td>${$3}</td><td>${$4}</td></tr>`
)}

function _option(checkbox){return(
checkbox({
  options: [
    { value: "darkColors", label: "Darker Colors" },
    { value: "backrotate", label: "Background Rotation" }
  ],
  value: ["darkColors", "backrotate"],
  title: "Options"
})
)}

function _check(checkbox){return(
checkbox({
  options: [
    { value: "4NT", label: "Donjon" },
    { value: "ring1", label: "Higher Bailey" },
    { value: "ring2", label: "Lower Bailey" },
    { value: "corner", label: "Corner Stones" },
    { value: "do", label: "Inner Wall" },
    { value: "nutriments", label: "Outer Wall" },
    { value: "centerRadius", label: "Battlements" },
    { value: "flanking", label: "Flanking Towers" },
    { value: "watch", label: "Watch Towers" },
    { value: "moat", label: "Moat" },
    { value: "background", label: "Grass" }
  ],
  value: [
    "4NT",
    "ring1",
    "ring2",
    "corner",
    "do",
    "nutriments",
    "centerRadius",
    "flanking",
    "watch",
    "moat",
    "background"
  ],
  title: "Display"
})
)}

function _6($0,DOM,rasterizeWhite,chart,serialize,$1,$2,$3,$4,htl){return(
htl.html`<style>
  div[k] {
    display: inline-block;
    padding-right: 20px;
  }
  div[l] {
/*     width: 110px */
  }
  div[p] {
    padding-bottom: 20px;
  }
</style>
<div p>
  <div k>${$0}</div><div k l>${DOM.download(() => rasterizeWhite(chart), undefined, "Save as PNG")}</div><div k l>${DOM.download(() => serialize(chart), undefined, "Save as SVG")}</div>
</div>
<div p>
  <div k >${$1}</div><div k l>${$2}</div>
</div>
<div >
  <div k>${$3}</div><div k>${$4}</div>
</div>

`
)}

function _chart(d3,zoom,x,y,GFontToDataURI,check,drawRing,Ramparts,grass1,grass2,grass3,grass4,DonjonChemise,HigherBaileyTitle,HigherBailey,LowerBaileySubTitle,LowerBaileyTitle,LowerBailey,Donjon,InnerWall,InnerWallTitle,CornerStones,OuterWallBackGround,OuterWall,OuterWallTitle,WBattlements,EBattlements,NEBattlements,SBattlements,SBattlements2,WBattlementsNumbers,SBattlementsNumbers,EBattlementsNumbers,EBattlementsNumbersTitle,WBattlementsTitle,EBattlementsTitle,NBattlementsTitle,SBattlementsTitle,NWCornerTower,NECornerTower,SECornerTower,NECornerTowerSubTitle,SWCornerTower,Moat,MoatTitle,EFlankingTowerTitle,EFlankingTower,NFlankingTowerTitle,WFlankingTowerTitle,SFlankingTowerTitle,NFlankingTower,NNEWatchTower,ENEWatchTower)
{
  const w = 400;
  const svgOrigin = d3
    .create("svg")
    .attr("viewBox", [
      ((1 / zoom) * -w) / 2 + x,
      ((1 / zoom) * -w) / 2 - y,
      (1 / zoom) * w,
      (1 / zoom) * w
    ])
    .attr("cursor", "grab");

  const svg = svgOrigin.append("g").attr("transform", "translate(0, 0)");
  const fontName = "Cormorant SC";

  GFontToDataURI(
    "https://fonts.googleapis.com/css2?family=Cormorant SC&display=swap"
  )
    .then((cssRules) => {
      let fontRules = cssRules.join("\n");
      svg
        .append("defs")
        .append("style")
        .attr("type", "text/css")
        .text(fontRules);
      console.log("Added Font");
    })
    .catch((reason) => console.log(reason));

  if (check.includes("background")) {
    drawRing(svg, Ramparts);
    drawRing(svg, grass1);
    drawRing(svg, grass2);
    drawRing(svg, grass3);
    drawRing(svg, grass4);
  }

  if (check.includes("4NT")) drawRing(svg, DonjonChemise);

  if (check.includes("ring1")) {
    drawRing(svg, HigherBaileyTitle);
    drawRing(svg, HigherBailey);
  }
  if (check.includes("ring2")) {
    drawRing(svg, LowerBaileySubTitle);
    drawRing(svg, LowerBaileyTitle);
    drawRing(svg, LowerBailey);
  }
  if (check.includes("4NT")) drawRing(svg, Donjon);
  if (check.includes("do")) {
    drawRing(svg, InnerWall);
    drawRing(svg, InnerWallTitle);
  }
  if (check.includes("corner")) drawRing(svg, CornerStones);
  if (check.includes("nutriments")) {
    drawRing(svg, OuterWallBackGround);
    drawRing(svg, OuterWall);
    drawRing(svg, OuterWallTitle);
  }
  if (check.includes("centerRadius")) {
    drawRing(svg, WBattlements);
    drawRing(svg, EBattlements);
    drawRing(svg, NEBattlements);
    drawRing(svg, SBattlements);
    drawRing(svg, SBattlements2);
    drawRing(svg, WBattlementsNumbers);
    drawRing(svg, SBattlementsNumbers);
    drawRing(svg, EBattlementsNumbers);
    drawRing(svg, EBattlementsNumbersTitle);
    drawRing(svg, WBattlementsTitle);
    drawRing(svg, EBattlementsTitle);
    drawRing(svg, NBattlementsTitle);
    drawRing(svg, SBattlementsTitle);
    drawRing(svg, NWCornerTower);
    drawRing(svg, NECornerTower);
    drawRing(svg, SECornerTower);
    drawRing(svg, NECornerTowerSubTitle);
    drawRing(svg, SWCornerTower);
  }
  if (check.includes("moat")) {
    drawRing(svg, Moat);
    drawRing(svg, MoatTitle);
  }
  if (check.includes("flanking")) {
    drawRing(svg, EFlankingTowerTitle);
    drawRing(svg, EFlankingTower);
    drawRing(svg, NFlankingTowerTitle);
    drawRing(svg, WFlankingTowerTitle);
    drawRing(svg, SFlankingTowerTitle);
    drawRing(svg, NFlankingTower);
  }
  if (check.includes("watch")) {
    drawRing(svg, NNEWatchTower);
    drawRing(svg, ENEWatchTower);
  }

  svgOrigin.call(d3.zoom().scaleExtent([1, 1]).on("zoom", zoomed));

  function zoomed({ transform }) {
    svg.attr("transform", transform);
  }

  return svgOrigin.node();
}


function _x(Inputs){return(
Inputs.range([-1000, 1000], { label: "x", step: 1, value:0 })
)}

function _y(Inputs){return(
Inputs.range([-1000, 1000], { label: "y", step: 1, calue: 0 })
)}

function _p()
{
  const p = {};

  p.gap = 2.5;
  p.river = 10; // Between Bailey & Inner Wall
  p.fade = 7; // Subtitle
  p.strokeWidth = 1;
  p.arrowFactor = 0.5;
  p.backFade = 10;
  p.backOpacity = 0.7;

  // Donjon
  p.padDonjon = 0;
  p.donjon = 60;
  p.donjonInner = 31.5;
  p.chemise = 75.2 + 1.3;
  p.chemiseInner = 17;

  // Higher Bailey
  p.higherBailey = p.donjon + p.donjonInner + 2 * p.gap;
  p.higherBaileyInner = 100;
  p.higherBaileyTitle = p.higherBailey + p.higherBaileyInner + p.gap;
  p.higherBaileyTitleInner = 20;

  // Lower Bailey
  p.lowerBailey = p.higherBaileyTitle + p.higherBaileyTitleInner + p.gap;
  p.lowerBaileyInner = 90;
  p.lowerBaileySubTitle = p.lowerBailey + p.lowerBaileyInner + p.gap;
  p.lowerBaileySubTitleInner = 20;
  p.lowerBaileyTitle =
    p.lowerBaileySubTitle + p.lowerBaileySubTitleInner + p.gap;
  p.lowerBaileyTitleInner = 22;

  // Inner Wall
  p.innerWall = p.lowerBaileyTitle + p.lowerBaileyTitleInner + p.river;
  p.innerWallInner = 25;
  p.innerWallTitle = p.innerWall + p.innerWallInner + p.gap;
  p.innerWallTitleInner = 13;

  // Outer Wall
  p.outerWall = p.innerWallTitle + p.innerWallTitleInner + p.gap;
  p.outerWallInner = 25;
  //p.outerWallTitle = p.outerWall + 1 * p.gap + 28;
  p.outerWallTitle = p.outerWall + p.outerWallInner + 1 * p.gap;
  p.outerWallTitleInner = 13;

  // Corner Stones
  p.CornerStones = ((p.outerWall - 2 * p.gap) / 2) * (1 - 1 / Math.SQRT2); // radius
  p.CornerStonesInner = 20;
  p.dCornerStones = (p.outerWall * (Math.SQRT2 - 1)) / 2; // diagonal radius
  p.cCornerStonesx = p.outerWall - p.CornerStones - p.gap;
  p.cCornerStonesy = p.cCornerStonesx;

  // Battlements
  p.battlements = p.outerWallTitle + p.outerWallTitleInner + p.gap;
  p.battlementsInner = 120;
  p.battlementsTitle = p.battlements + p.battlementsInner + p.gap;
  p.battlementsTitleInner = 20;
  p.battlementNumbers = 20;

  // Corner Tower
  p.cornerTowerx = p.battlements + p.battlementsInner / 2;
  p.cornerTowery = p.battlements + p.battlementsInner / 2;
  p.cornerTower = p.battlementsInner / 2 + p.strokeWidth;

  // Moat
  p.moat =
    Math.SQRT2 * (p.battlementsTitle + p.battlementsTitleInner) + 2.5 * p.gap;
  p.moatInner = 17;
  p.moatTitle = p.moat + p.moatInner + p.gap;
  p.moatTitleInner = 13;

  // Flanking tower
  p.FlankingTowerCenter = p.battlementsTitle + p.battlementsTitleInner + p.gap;
  p.FlankingTowerTitleInner = 20;
  p.FlankingTower =
    p.moat - p.FlankingTowerCenter - p.FlankingTowerTitleInner - p.gap;
  p.step = 61;

  // Watch tower
  p.watchTowerCenterLong = p.moat - 172;
  p.watchTowerCenterShort = p.battlements - 100;
  p.watchTower = 40;
  p.watchTowerTitle = 15;

  // Ramparts
  p.ramparts = p.moatTitle + p.moatTitleInner + 1.5 * p.gap;
  p.rampartsInner = 30;

  return p;
}


function _grass2(p,colorCessation,colorPath,colorOrigin,colorSuffering){return(
{
  r: 0,
  innerR: p.chemise,
  opacity: 1,
  padAngle: 0,
  strokeWidth: 0,
  data: [1, 2, 3, 4].map((d, i) => {
    const arrColors = [colorCessation, colorPath, colorOrigin, colorSuffering];
    const centerX = [0, p.FlankingTowerCenter, 0, -p.FlankingTowerCenter];
    const centerY = [-p.FlankingTowerCenter, 0, p.FlankingTowerCenter, 0];
    return {
      innerR: p.FlankingTower,
      cx: centerX[i],
      cy: centerY[i],
      color: arrColors[i],
      startAngle: -90 + 90 * i,
      endAngle: 90 + 270 + 90 * i,
      gradientID: "FL" + i,
      gradientR: 60,
      gradientX: 50,
      gradientY: 50
    };
  })
}
)}

function _grass3(p,colorCessation,colorPath,colorOrigin,colorSuffering){return(
{
  cx: 0,
  cy: 0,
  r: p.battlements / 2,
  innerR: 0,
  square: true,
  squareEnds: true,
  centerInnerR: true,
  centerRadius: true,
  padAngle: 0,
  strokeWidth: 0,
  polyPad: 0,
  fade: p.backFade,
  opacity: p.backOpacity,
  data: [1, 2, 3, 4] // any array of dim 4
    .map((d, i) => {
      return {
        cx: p.battlements / 2,
        cy: -p.battlements / 2,
        text: "",
        startAngle: 45 + 90 * i,
        endAngle: 45 + 90 * (i + 1),
        polyId: "1",
        color: colorCessation,
        gradientID: "grass-poly-1",
        gradientR: 115,
        gradientX: 100,
        gradientY: 0
      };
    })

    .concat(
      [1, 2, 3, 4] // any array of dim 4
        .map((d, i) => {
          return {
            cx: p.battlements / 2,
            cy: p.battlements / 2,
            text: "",
            startAngle: 45 + 90 * i,
            endAngle: 45 + 90 * (i + 1),
            polyId: "2",
            color: colorPath,
            gradientID: "grass-poly-2",
            gradientR: 115,
            gradientX: 100,
            gradientY: 100
          };
        })
    )
    .concat(
      [1, 2, 3, 4] // any array of dim 4
        .map((d, i) => {
          return {
            cx: -p.battlements / 2,
            cy: p.battlements / 2,
            text: "",
            startAngle: 45 + 90 * i,
            endAngle: 45 + 90 * (i + 1),
            polyId: "3",
            color: colorOrigin,
            gradientID: "grass-poly-3",
            gradientR: 115,
            gradientX: 0,
            gradientY: 100
          };
        })
    )
    .concat(
      [1, 2, 3, 4] // any array of dim 4
        .map((d, i) => {
          return {
            cx: -p.battlements / 2,
            cy: -p.battlements / 2,
            text: "",
            startAngle: 45 + 90 * i,
            endAngle: 45 + 90 * (i + 1),
            polyId: "4",
            color: colorSuffering,
            gradientID: "grass-poly-4",
            gradientR: 115,
            gradientX: 0,
            gradientY: 0
          };
        })
    )
    .concat({
      r: p.battlements,
      innerR: p.battlementsInner + p.battlementsTitleInner + 2 * p.gap,
      innerSide: 2 * p.battlements,
      text: "",
      startAngle: 180 + 45,
      endAngle: 270 + 45,
      color: colorSuffering,
      endPadRatio: -0.158
    })
    .concat({
      r: p.battlements - p.gap,
      innerR: p.battlementsInner + p.battlementsTitleInner + 3 * p.gap,
      innerSide: 2 * p.battlements,
      text: "",
      startAngle: 45,
      endAngle: 90 + 45,
      color: colorPath,
      startPadRatio: -0.158
    })
    .concat({
      r: p.battlements,
      innerR: p.battlementsInner + p.battlementsTitleInner + 2 * p.gap,
      innerSide: 2 * (p.battlementsTitle + p.battlementsTitleInner),
      text: "",
      startAngle: 90 + 45,
      endAngle: 90 + 90 + 45,
      color: colorSuffering
    })
}
)}

function _grass4(p,colorCessation,colorPath,colorOrigin,colorSuffering){return(
{
  r: 0,
  innerR: p.chemise,
  opacity: 1,
  padAngle: 0,
  strokeWidth: 0,
  data: [1, 2, 3, 4].map((d, i) => {
    const arrColors = [colorCessation, colorPath, colorOrigin, colorSuffering];
    const arrGradX = [0, 0, 100, 100];
    const arrGradY = [100, 0, 0, 100];
    return {
      color: arrColors[i],
      startAngle: 90 * i,
      endAngle: 90 * (i + 1),
      gradientID: "CH2" + i,
      gradientR: 95,
      gradientX: arrGradX[i],
      gradientY: arrGradY[i]
    };
  })
}
)}

function _grass1(p,colorCessation,colorPath,colorOrigin,colorSuffering,option){return(
{
  r: 0,
  innerR: p.moat,
  padAngle: 0,
  strokeWidth: 0,
  data: [1, 2, 3, 4].map((d, i) => {
    const arrColors = [colorCessation, colorPath, colorOrigin, colorSuffering];
    const arrGradX = option.includes("backrotate")
      ? [50, 0, 50, 100]
      : [0, 0, 100, 100];
    const arrGradY = option.includes("backrotate")
      ? [100, 50, 0, 50]
      : [100, 0, 0, 100];
    return {
      color: arrColors[i],
      startAngle: (option.includes("backrotate") ? -45 : 0) + 90 * i,
      endAngle: (option.includes("backrotate") ? -45 : 0) + 90 * (i + 1),
      gradientID: "MO" + i,
      gradientR: 95,
      gradientX: arrGradX[i],
      gradientY: arrGradY[i]
    };
  })
}
)}

function _NNEWatchTower(p,colorPath,dataOfId){return(
{
  cx: p.watchTowerCenterShort,
  cy: -p.watchTowerCenterLong,
  r: p.watchTower,
  innerR: p.watchTowerTitle,
  // square: true,
  centerInnerR: true,
  centerRadius: true,
  fade: 10,
  padAngle: 1.3,
  opacity: 0.3,
  color: colorPath,
  data: [
    {
      r: 0,
      innerR: p.watchTower + p.watchTowerTitle + p.gap,
      fade: 10,
      opacity: 0.7,
      startAngle: 0,
      endAngle: 360
    },
    {
      r: 0,
      innerR: p.watchTower - p.gap,
      fade: 0,
      opacity: 1,
      startAngle: 0,
      endAngle: 360
    }
  ]
    .concat(
      dataOfId("4BOP") // square has 4 side
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            startAngle: 45 + 90 * i,
            endAngle: 45 + 90 * (i + 1)
            // polyId: "31PL",
            // polyPad: 0,
            // strokeWidth: 0
          };
        })
    )
    .concat(
      dataOfId("T4BOP").map((d) => {
        return {
          centerText: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing
        };
      })
    )
}
)}

function _ENEWatchTower(p,colorPath,dataOfId){return(
{
  cx: p.watchTowerCenterLong,
  cy: -p.watchTowerCenterShort,
  r: p.watchTower,
  innerR: p.watchTowerTitle,
  // square: true,
  centerInnerR: true,
  centerRadius: true,
  fade: 10,
  padAngle: 1.3,
  opacity: 0.3,
  color: colorPath,
  data: [
    {
      r: 0,
      innerR: p.watchTower + p.watchTowerTitle + p.gap,
      fade: 10,
      opacity: 0.7,
      startAngle: 0,
      endAngle: 360
    },
    {
      r: 0,
      innerR: p.watchTower - p.gap,
      fade: 0,
      opacity: 1,
      startAngle: 0,
      endAngle: 360
    }
  ]
    .concat(
      dataOfId("4DA") // square has 4 side
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            startAngle: 45 + 90 * i,
            endAngle: 45 + 90 * (i + 1)
            // polyId: "31PL",
            // polyPad: 0,
            // strokeWidth: 0
          };
        })
    )
    .concat(
      dataOfId("T4DA").map((d) => {
        return {
          centerText: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing
        };
      })
    )
}
)}

function _Ramparts(p,colorFourNobleTruths,colorPath){return(
{
  r: p.ramparts,
  innerR: p.rampartsInner,
  square: true,
  centerInnerR: true,
  centerRadius: true,
  padAngle: 0,
  opacity: 1,
  data: [1, 2, 3, 4] // any array of dim 4
    .map((d, i) => {
      return {
        color: colorFourNobleTruths,
        gradientID: "1",
        gradientR: 65,
        polyFade: 0,
        polyOpacity: 1,
        text: "",
        startAngle: 45 + 90 * i,
        endAngle: 45 + 90 * (i + 1),
        polyId: "1",
        polyPad: 0,
        strokeWidth: 0
      };
    })
    .concat(
      [1, 2, 3, 4] // any array of dim 4
        .map((d, i) => {
          return {
            color: colorPath,
            fade: 30,
            text: "",
            startAngle: 45 + 90 * i,
            endAngle: 45 + 90 * (i + 1),
            // polyId: "1",
            // polyPad: 0,
            strokeWidth: 1,
            strokeColor: colorPath
          };
        })
    )
}
)}

function _Moat(p,colorCessation,colorSuffering,dataOfId){return(
{
  r: p.moat,
  innerR: p.moatInner,
  fade: 10,
  opacity: 0.3,
  padAngle: 0.2,
  data: [
    {
      r: p.moat - p.gap,
      innerR: p.moatInner + p.moatTitleInner + 2.5 * p.gap,
      text: "", // background
      color: colorCessation,
      startAngle: -90,
      endAngle: 90,
      strokeWidth: 0,
      fade: 0,
      opacity: 0.7,
      padAngle: 0.01
    },
    {
      r: p.moat - p.gap,
      innerR: p.moatInner + p.moatTitleInner + 2.5 * p.gap,
      text: "", // background
      color: colorSuffering,
      startAngle: 90,
      endAngle: 270,
      strokeWidth: 0,
      fade: 0,
      opacity: 0.7,
      padAngle: 0.01
    }
  ]
    .concat(
      dataOfId("33SYN").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation,
          startAngle: -90,
          endAngle: 90,
          div: 33,
          n: i + 1
        };
      })
    )
    .concat(
      dataOfId("32PAR")
        .reverse()
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorSuffering,
            startAngle: 90,
            endAngle: 270,
            div: 32,
            n: i + 1
          };
        })
    )
}
)}

function _MoatTitle(p,dataOfId,colorCessation,colorSuffering){return(
{
  r: p.moatTitle,
  innerR: p.moatTitleInner,
  fade: 0,
  opacity: 1,
  padAngle: 0.2,
  data: dataOfId("T33SYN")
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorCessation,
        startAngle: -90,
        endAngle: 90,
      };
    })
    .concat(
      dataOfId("T32PAR").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 90,
          endAngle: 270,
        };
      })
    )
}
)}

function _NFlankingTowerTitle(p,dataOfId,colorCessation){return(
{
  cx: 0,
  cy: -p.FlankingTowerCenter,
  r: p.FlankingTower,
  fade: 0,
  opacity: 0.9,
  strokeWidth: 1,
  innerR: p.FlankingTowerTitleInner,
  padAngle: 0,
  data: dataOfId("T3PLG").map((d, i) => {
    return {
      text: d.text,
      fontSize: d.fontSize,
      letterSpacing: d.letterSpacing,
      color: colorCessation,
      startAngle: -90,
      endAngle: 90
    };
  })
}
)}

function _WFlankingTowerTitle(p,dataOfId,colorSuffering){return(
{
  cx: -p.FlankingTowerCenter,
  cy: 0,
  r: p.FlankingTower,
  fade: 0,
  opacity: 0.9,
  strokeWidth: 1,
  innerR: p.FlankingTowerTitleInner,
  padAngle: 0,
  data: dataOfId("T3PLG").map((d, i) => {
    return {
      text: "Recollections",
      fontSize: d.fontSize,
      letterSpacing: d.letterSpacing,
      color: colorSuffering,
      startAngle: 180,
      endAngle: 360
    };
  })
}
)}

function _SFlankingTowerTitle(p,dataOfId,colorOrigin){return(
{
  cx: 0,
  cy: p.FlankingTowerCenter,
  r: p.FlankingTower,
  fade: 0,
  opacity: 0.9,
  strokeWidth: 1,
  innerR: p.FlankingTowerTitleInner,
  padAngle: 0,
  data: dataOfId("T3PLG").map((d, i) => {
    return {
      text: "Wrong View",
      fontSize: d.fontSize,
      letterSpacing: d.letterSpacing,
      color: colorOrigin,
      startAngle: 90,
      endAngle: 270
    };
  })
}
)}

function _NFlankingTower(p,colorCessation,dataOfId){return(
{
  r: p.FlankingTowerCenter,
  innerR: p.step + 4,
  innerSide: 432 - 4,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  padSquare: 2,
  fade: 10,
  opacity: 0.3,
  centerRadius: true,
  squareEnds: true,
  color: colorCessation,
  data: dataOfId("3PLG1")
    .map((d, i) => {
      // Buddha Background
      return {
        opacity: 0.7,
        innerR: p.step,
        innerSide: 242 + 5,
        r: p.FlankingTowerCenter + p.step + 2.5 + p.step + 2.5,
        text: "",
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        startAngle: -45,
        endAngle: +45
      };
    })

    .concat(
      dataOfId("3PLG") // Buddha Qualities
        .slice(1, 5)
        .map((d, i) => {
          return {
            innerR: p.step / 3,
            innerSide: 242,
            r: p.FlankingTowerCenter + p.step + 2.5 + p.step + 2.5 + 1.5,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            startAngle: -45,
            endAngle: +45,
            div: 4,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("3PLG") // Buddha Qualities 2
        .slice(5, 9)
        .map((d, i) => {
          return {
            innerR: p.step / 3,
            innerSide: 242,
            r: p.FlankingTowerCenter + p.step + 2.5 + p.step + 25 + 1,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            startAngle: -45,
            endAngle: +45,
            div: 4,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("3PLG1").map((d, i) => {
        // Buddha
        return {
          opacity: 0.9,
          innerR: 15,
          innerSide: 247,
          r: p.FlankingTowerCenter + p.step + 2.5 + p.step + 2.5 + p.step - 15,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: -45,
          endAngle: +45
        };
      })
    )
    .concat(
      dataOfId("3PLG11").map((d, i) => {
        // Dhamma
        return {
          opacity: 0.7,
          innerR: p.step - 4,
          innerSide: 375,
          r: p.FlankingTowerCenter + p.step + 2.5 + 4,
          text: "",
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: -45,
          endAngle: +45
        };
      })
    )
    .concat(
      dataOfId("3PLG11").map((d, i) => {
        // Dhamma
        return {
          opacity: 0.9,
          innerR: 15,
          innerSide: 375,
          r: p.FlankingTowerCenter + p.step + 2.5 + p.step - 15,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: -45,
          endAngle: +45
        };
      })
    )
    .concat(
      dataOfId("3PLG") // Dhamma Qualities
        .slice(11, 14)
        .map((d, i) => {
          return {
            innerR: p.step / 3.5,
            innerSide: 375 - 8,
            r: p.FlankingTowerCenter + p.step + 2.5 + 26,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            startAngle: -45,
            endAngle: +45,
            div: 3,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("3PLG") // Dhamma Qualities 2
        .slice(14, 17)
        .map((d, i) => {
          return {
            innerR: p.step / 3.5,
            innerSide: 375 - 8,
            r: p.FlankingTowerCenter + p.step + 2.5 + 6,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            startAngle: -45,
            endAngle: +45,
            div: 3,
            n: i + 1
          };
        })
    )

    .concat(
      dataOfId("3PLG18").map((d, i) => {
        // Sangha
        return {
          opacity: 0.7,
          text: "",
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: -45,
          endAngle: +45
        };
      })
    )
    .concat(
      dataOfId("3PLG") // SAangha Qualities
        .slice(18, 22)
        .map((d, i) => {
          return {
            innerR: p.step / 4.2,
            innerSide: 432 - 8,
            r: p.FlankingTowerCenter + 33,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            startAngle: -45,
            endAngle: +45,
            div: 4,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("3PLG") // Sangha Qualities 2
        .slice(22, 26)
        .map((d, i) => {
          return {
            innerR: p.step / 4.2,
            innerSide: 432 - 8,
            r: p.FlankingTowerCenter + 17,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            startAngle: -45,
            endAngle: +45,
            div: 4,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("3PLG27").map((d, i) => {
        // Sangha Quality 3
        return {
          innerR: p.step / 4.2,
          innerSide: 432 - 8,
          r: p.FlankingTowerCenter + 1,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: -45,
          endAngle: +45
        };
      })
    )
    .concat(
      dataOfId("3PLG18").map((d, i) => {
        // Sangha
        return {
          opacity: 0.9,
          innerR: 15,
          innerSide: 432 - 4,
          r: p.FlankingTowerCenter + p.step - 15 + 4,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: -45,
          endAngle: +45
        };
      })
    )
}
)}

function _EFlankingTowerTitle(p,dataOfId,colorPath){return(
{
  cx: p.FlankingTowerCenter,
  cy: 0,
  r: p.FlankingTower,
  innerR: p.FlankingTowerTitleInner,
  padAngle: 0,
  data: dataOfId("T37WTA")
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorPath,
        startAngle: 0,
        endAngle: 180
      };
    })
}
)}

function _EFlankingTower(p,dataOfId,colorPath){return(
{
  r: p.FlankingTowerCenter,
  innerR: p.step,
  innerSide: 383,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  padSquare: 5,
  fade: 10,
  opacity: 0.3,
  centerRadius: true,
  squareEnds: true,
  data: dataOfId("37WTA1")
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorPath,
        startAngle: 90 - 45,
        endAngle: 90 + 45
      };
    })
    .concat(
      dataOfId("37WTA5").map((d, i) => {
        return {
          innerR: p.step,
          innerSide: 335,
          r: p.FlankingTowerCenter + p.step + 2.5,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorPath,
          startAngle: 90 - 45,
          endAngle: 90 + 45
        };
      })
    )
    .concat(
      dataOfId("37WTA11").map((d, i) => {
        return {
          innerR: p.step,
          innerSide: 232,
          r: p.FlankingTowerCenter + p.step + 2.5 + p.step + 2.5,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorPath,
          startAngle: 90 - 45,
          endAngle: 90 + 45
        };
      })
    )
}
)}

function _NEBattlements(p,colorPath,colorSuffering){return(
{
  r: p.battlements,
  innerR: p.battlementsInner,
  innerSide: (p.battlements - p.gap) * 2,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  padSquare: 5,
  fade: 10,
  opacity: 0.3,
  centerRadius: true,
  squareEnds: true,
  radial: true,
  data: [...Array(11).keys()]
    .map((d, i) => {
      return {
        text: "test " + String(i),
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        startAngle: -45,
        endAngle: 45,
        color: colorPath,
        div: 22,
        n: 21 - i + 1
      };
    })
    .concat(
      [...Array(11).keys()].map((d, i) => {
        return {
          text: "test " + String(i),
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: -45,
          endAngle: 45,
          color: colorSuffering,
          div: 22,
          n: i + 1
        };
      })
    )
}
)}

function _SBattlements(p,dataOfId,colorOrigin,colorCessation){return(
{
  cy: p.battlements + p.battlementsInner / 2,
  cx: 100 - p.gap / 2,
  r: 100,
  innerR: p.battlementsInner + 19,
  innerSide: p.battlementsInner,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  padSquare: 5,
  fade: 10,
  opacity: 0.3,
  centerRadius: true,
  squareEnds: true,
  radial: true,
  padRatio: 0.0015,

  data: dataOfId("8FDH")
    .reverse()
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorOrigin,
        startAngle: 180 + 45,
        endAngle: 270 + 45,
        div: 8,
        n: i + 1
      };
    })
    .concat(
      dataOfId("8TDH").map((d, i) => {
        return {
          cx: -100 + p.gap / 2,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation,
          startAngle: 0 + 45,
          endAngle: 90 + 45,
          div: 8,
          n: i + 1
        };
      })
    )
}
)}

function _SBattlements2(p,dataOfId,colorPath,colorSuffering){return(
{
  r: p.battlements + p.battlementNumbers + p.gap,
  innerR: p.battlementsInner - p.battlementNumbers - 1 * p.gap,
  innerSide: (p.battlements - p.gap) * 2,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  padSquare: 5,
  fade: 10,
  opacity: 0.3,
  centerRadius: true,
  squareEnds: true,
  radial: true,
  padRatio: 0.0015,

  data: dataOfId("10CRA")
    .reverse()
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorPath,
        startAngle: 180 - 45,
        endAngle: 180 - 45 + 90,
        startRatio: 0,
        startPadRatio: 0,
        endRatio: 11 / 32,
        div: 10,
        n: i + 1,
        flipLetters: true
      };
    })
    .concat(
      dataOfId("10CWA").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 180 - 45,
          endAngle: 180 - 45 + 90,
          startRatio: 21 / 32,
          endRatio: 1,
          endPadRatio: 0,
          div: 10,
          n: i + 1
        };
      })
    )
}
)}

function _SBattlementsNumbers(p,dataOfId,colorPath,colorSuffering){return(
{
  r: p.battlements,
  innerR: p.battlementNumbers,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  innerSide: (p.battlements - p.gap) * 2,
  padSquare: 5,
  fade: 10,
  opacity: 0.3,
  centerRadius: true,
  squareEnds: true,
  radial: false,
  padRatio: 0.0015,

  data: dataOfId("10CRA")
    .map((d, i) => {
      return {
        text: String(10 - i),
        fontSize: 9,
        color: colorPath,
        startAngle: 180 - 45,
        endAngle: 180 - 45 + 90,
        startRatio: 0,
        startPadRatio: 0,
        endRatio: 11 / 32,
        div: 10,
        n: i + 1
      };
    })
    .concat(
      dataOfId("10CWA").map((d, i) => {
        return {
          text: String(i + 1),
          fontSize: 9,
          color: colorSuffering,
          startAngle: 180 - 45,
          endAngle: 180 - 45 + 90,
          startRatio: 21 / 32,
          endRatio: 1,
          endPadRatio: 0,
          div: 10,
          n: i + 1
        };
      })
    )
}
)}

function _SBattlementsTitle(p,dataOfId,colorPath,colorCessation,colorOrigin,colorSuffering){return(
{
  r: p.battlementsTitle,
  innerR: p.battlementsTitleInner,
  innerSide: (p.battlements - p.gap) * 2,
  square: true,
  centerInnerR: true,
  fade: 0,
  padAngle: 0,
  opacity: 1,
  centerRadius: true,
  squareEnds: true,
  // padSquare: 0.0,
  padRatio: 0.0015,
  data: dataOfId("T10CRA")
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorPath,
        startAngle: 180 - 45,
        endAngle: 180 - 45 + 90,
        startRatio: 0,
        startPadRatio: 0,
        endRatio: 11 / 32
      };
    })
    .concat(
      dataOfId("T8TDH").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation,
          startAngle: 180 - 45,
          endAngle: 180 - 45 + 90,
          startRatio: 11 / 32,
          endRatio: 4 / 8
        };
      })
    )
    .concat(
      dataOfId("T8FDH").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: 180 - 45,
          endAngle: 180 - 45 + 90,
          startRatio: 4 / 8,
          endRatio: (32 - 11) / 32
        };
      })
    )
    .concat(
      dataOfId("T10CRA").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 180 - 45,
          endAngle: 180 - 45 + 90,
          startRatio: (32 - 11) / 32,
          endRatio: 1,
          endPadRatio: 0
        };
      })
    )
}
)}

function _NBattlementsTitle(p,colorCessation){return(
{
  r: p.battlementsTitle,
  innerR: p.battlementsTitleInner,
  color: colorCessation,
  square: true,
  centerInnerR: true,
  fade: 0,
  padAngle: 0,
  opacity: 1,
  centerRadius: true,
  squareEnds: true,
  innerSide: (p.battlements - p.gap) * 2,
  
  data: [1].map((d, i) => {
    return {
      text: "Test Title",
      fontSize: d.fontSize,
      letterSpacing: d.letterSpacing,
      startAngle: -45,
      endAngle: 45,
      startRatio: 0,
      startPadRatio: 0
    };
  })
}
)}

function _WBattlementsTitle(p,dataOfId,colorSuffering){return(
{
  r: p.battlementsTitle,
  innerR: p.battlementsTitleInner,
  innerSide: (p.battlements - p.gap) * 2,
  square: true,
  centerInnerR: true,
  fade: 0,
  padAngle: 0,
  opacity: 0.7,
  centerRadius: true,
  squareEnds: true,
  // padSquare: 0.0,
  padRatio: 0.0015,
  data: dataOfId("4REL4")
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorSuffering,
        startAngle: 180 + 45,
        endAngle: 180 + 45 + 90,
        startRatio: 0,
        startPadRatio: 0,
        endRatio: 4 / 31
      };
    })
    .concat(
      dataOfId("4REL3").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 180 + 45,
          endAngle: 180 + 45 + 90,
          startRatio: 4 / 31,
          endRatio: 7 / 31
        };
      })
    )
    .concat(
      dataOfId("4REL2").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 180 + 45,
          endAngle: 180 + 45 + 90,
          startRatio: 7 / 31,
          endRatio: 16 / 31
        };
      })
    )
    .concat(
      dataOfId("4REL1").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 180 + 45,
          endAngle: 180 + 45 + 90,
          startRatio: 16 / 31,
          endRatio: 31 / 31,
          endPadRatio: 0
        };
      })
    )
}
)}

function _WBattlements(p,dataOfId,colorSuffering){return(
{
  r: p.battlements + p.battlementNumbers + p.gap,
  innerR: p.battlementsInner - p.battlementNumbers - 1 * p.gap,
  innerSide: (p.battlements - p.gap) * 2,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  padSquare: 5,
  fade: 10,
  opacity: 0.3,
  centerRadius: true,
  squareEnds: true,
  radial: true,
  data: dataOfId("31PL").map((d, i) => {
    return {
      text: d.text,
      fontSize: d.fontSize,
      letterSpacing: d.letterSpacing,
      color: colorSuffering,
      startAngle: 180 + 45,
      endAngle: 270 + 45,
      div: 31,
      n: i + 1
    };
  })
}
)}

function _WBattlementsNumbers(p,dataOfId,colorSuffering){return(
{
  r: p.battlements,
  innerR: p.battlementNumbers,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  innerSide: (p.battlements - p.gap) * 2,
  padSquare: 5,
  fade: 10,
  opacity: 0.3,
  centerRadius: true,
  squareEnds: true,
  radial: true,
  data: dataOfId("31PL").map((d, i) => {
    return {
      text: String(i + 1),
      fontSize: d.fontSize,
      letterSpacing: d.letterSpacing,
      color: colorSuffering,
      startAngle: 180 + 45,
      endAngle: 270 + 45,
      div: 31,
      n: i + 1
    };
  })
}
)}

function _EBattlementsTitle(p,colorPath,dataOfId){return(
{
  r: p.battlementsTitle,
  innerR: p.battlementsTitleInner,
  innerSide: (p.battlements - p.gap) * 2,
  color: colorPath,
  square: true,
  centerInnerR: true,
  fade: 0,
  padAngle: 0,
  opacity: 1,
  centerRadius: true,
  squareEnds: true,
  padRatio: 0.0015,
  data: dataOfId("4FUN4")
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        startAngle: 45,
        endAngle: 45 + 90,
        startRatio: 0,
        startPadRatio: 0,
        endRatio: 9 / 33
      };
    })
    .concat(
      dataOfId("4FUN3").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: 45,
          endAngle: 45 + 90,
          startRatio: 9 / 33,
          endRatio: 17 / 33
        };
      })
    )
    .concat(
      dataOfId("4FUN2").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: 45,
          endAngle: 45 + 90,
          startRatio: 17 / 33,
          endRatio: 24 / 33
        };
      })
    )
    .concat(
      dataOfId("4FUN1").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: 45,
          endAngle: 45 + 90,
          startRatio: 24 / 33,
          endRatio: 33 / 33,
          endPadRatio: 0
        };
      })
    )
}
)}

function _EBattlementsNumbers(p,colorPath){return(
{
  // we want to divid the height by 2 ? looks better
  // 5 / 4 / 4 / 4 / mid / 3 / 4 / 5 / 4
  //   5   9   13  17        3   7   12   16
  //      17                    16
  r: p.battlements,
  innerR: p.battlementNumbers,
  innerSide: (p.battlements - p.gap) * 2,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  //endPadAngle: 0.2,
  padSquare: 5,
  // padRatio: 0,
  // endPadRatio: 0, // padRatio by default
  // startPadRatio: 0, // padRatio by default
  fade: 20,
  opacity: 0.5,
  opacityLimit: 0.8,
  centerRadius: true,
  squareEnds: true,
  radial: true,
  data: [...Array(4).keys()]
    .map((d, i) => {
      return {
        text: String(17 - (i + 1)),
        fontSize: 8,
        letterSpacing: d.letterSpacing,
        color: colorPath,
        startAngle: 90 - 45,
        endAngle: 90 + 45,
        div: 33,
        n: i + 1 + 5
      };
    })
    .concat(
      [...Array(4).keys()].map((d, i) => {
        return {
          text: String(13 - (i + 1)),
          fontSize: 8,
          letterSpacing: d.letterSpacing,
          color: colorPath,
          startAngle: 90 - 45,
          endAngle: 90 + 45,
          div: 33,
          n: i + 1 + 13
        };
      })
    )
    .concat(
      [...Array(4).keys()].map((d, i) => {
        return {
          text: String(9 - (i + 1)),
          fontSize: 8,
          letterSpacing: d.letterSpacing,
          color: colorPath,
          startAngle: 90 - 45,
          endAngle: 90 + 45,
          div: 33,
          n: i + 1 + 20
        };
      })
    )
    .concat(
      [...Array(4).keys()].map((d, i) => {
        return {
          text: String(5 - (i + 1)),
          fontSize: 8,
          letterSpacing: d.letterSpacing,
          color: colorPath,
          startAngle: 90 - 45,
          endAngle: 90 + 45,
          div: 33,
          n: i + 1 + 29
        };
      })
    )
}
)}

function _EBattlementsNumbersTitle(p,colorPath,dataOfId){return(
{
  // we want to divid the height by 2 ? looks better
  // 5 / 4 / 4 / 4 / mid / 3 / 4 / 5 / 4
  //   5   9   13  17        3   7   12   16
  //      17                    16
  r: p.battlements,
  innerR: p.battlementNumbers,
  innerSide: (p.battlements - p.gap) * 2,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  //endPadAngle: 0.2,
  padSquare: 5,
  arrowEnd: true,
  // padRatio: 0,
  // endPadRatio: 0, // padRatio by default
  // startPadRatio: 0, // padRatio by default
  fade: 0,
  opacity: 1,
  centerRadius: true,
  squareEnds: true,
  color: colorPath,
  data: dataOfId("4TET4")
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        startAngle: 90 - 45,
        endAngle: 90 + 45,
        startRaio: 0,
        endRatio: 5 / 33,
        endPadRatio: 0.015
      };
    })
    .concat(
      dataOfId("4TET3").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: 90 - 45,
          endAngle: 90 + 45,
          startRatio: 9 / 33,
          endRatio: 13 / 33,
          startPadRatio: 0.002,
          endPadRatio: 0.015
        };
      })
    )
    .concat(
      dataOfId("4TET2").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: 90 - 45,
          endAngle: 90 + 45,
          startRatio: 17 / 33,
          endRatio: 20 / 33,
          startPadRatio: 0.002,
          endPadRatio: 0.015
        };
      })
    )
    .concat(
      dataOfId("4TET1").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: 90 - 45,
          endAngle: 90 + 45,
          startRatio: 24 / 33,
          endRatio: 29 / 33,
          startPadRatio: 0.002,
          endPadRatio: 0.015
        };
      })
    )
}
)}

function _EBattlements(p,dataOfId,colorPath){return(
{
  // we want to divid the height by 2 ? looks better ?
  // 5 / 4 / 4 / 4 / mid / 3 / 4 / 5 / 4
  //   5   9   13  17        3   7   12   16
  //      17                    16
  //                   33
  r: p.battlements + p.battlementNumbers + p.gap,
  innerR: p.battlementsInner - p.battlementNumbers - p.gap,
  innerSide: (p.battlements - p.gap) * 2,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  padSquare: 5,
  fade: 10,
  opacity: 0.3,
  centerRadius: true,
  squareEnds: true,
  radial: true,
  data: dataOfId("13SAT")
    .slice(8, 13)
    .reverse()
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorPath,
        startAngle: 90 - 45,
        endAngle: 90 + 45,
        div: 33,
        n: i + 1
      };
    })
    .concat(
      dataOfId("16STE")
        .slice(12, 16)
        .reverse()
        .map((d, i) => {
          return {
            fade: 20,
            opacity: 0.5,
            opacityLimit: 0.8,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 - 45,
            endAngle: 90 + 45,
            div: 33,
            n: i + 1 + 5
          };
        })
    )
    .concat(
      dataOfId("8MIN")
        .slice(0, 4)
        .reverse()
        .map((d, i) => {
          return {
            innerR: (p.battlementsInner - p.battlementNumbers - 2 * p.gap) / 2,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 - 45,
            endAngle: 90 + 45,
            div: 33,
            n: i + 1 + 9
          };
        })
    )
    .concat(
      dataOfId("8MIN")
        .slice(4, 8)
        .reverse()
        .map((d, i) => {
          return {
            r:
              p.battlements +
              p.battlementNumbers +
              p.gap +
              (p.battlementsInner - p.battlementNumbers - 2 * p.gap) / 2 +
              1 * p.gap,
            innerR: (p.battlementsInner - p.battlementNumbers - 2 * p.gap) / 2,
            endPadAngle: 4.45,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 - 45,
            endAngle: 90 + 45,
            div: 33,
            n: i + 1 + 9
          };
        })
    )
    .concat(
      dataOfId("16STE")
        .slice(8, 12)
        .reverse()
        .map((d, i) => {
          return {
            fade: 20,
            opacity: 0.5,
            opacityLimit: 0.8,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 - 45,
            endAngle: 90 + 45,
            div: 33,
            n: i + 1 + 13
          };
        })
    )
    .concat(
      dataOfId("6FEL")
        .slice(0, 3)
        .reverse()
        .map((d, i) => {
          return {
            innerR: (p.battlementsInner - p.battlementNumbers - 2 * p.gap) / 2,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 - 45,
            endAngle: 90 + 45,
            div: 33,
            n: i + 1 + 17
          };
        })
    )
    .concat(
      dataOfId("6FEL")
        .slice(3, 6)
        .reverse()
        .map((d, i) => {
          return {
            r:
              p.battlements +
              p.battlementNumbers +
              p.gap +
              (p.battlementsInner - p.battlementNumbers - 2 * p.gap) / 2 +
              1 * p.gap,
            innerR: (p.battlementsInner - p.battlementNumbers - 2 * p.gap) / 2,
            endPadAngle: 4.5,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 - 45,
            endAngle: 90 + 45,
            div: 33,
            n: i + 1 + 17
          };
        })
    )
    .concat(
      dataOfId("16STE")
        .slice(4, 8)
        .reverse()
        .map((d, i) => {
          return {
            fade: 20,
            opacity: 0.5,
            opacityLimit: 0.8,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 - 45,
            endAngle: 90 + 45,
            div: 33,
            n: i + 1 + 20
          };
        })
    )
    .concat(
      dataOfId("13SAT")
        .slice(1, 6)
        .reverse()
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 - 45,
            endAngle: 90 + 45,
            div: 33,
            n: i + 1 + 24
          };
        })
    )
    .concat(
      dataOfId("16STE")
        .slice(0, 4)
        .reverse()
        .map((d, i) => {
          return {
            fade: 20,
            opacity: 0.5,
            opacityLimit: 0.8,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 - 45,
            endAngle: 90 + 45,
            div: 33,
            n: i + 1 + 29
          };
        })
    )
}
)}

function _NWCornerTower(p,colorSuffering,dataOfId){return(
{
  cx: -p.cornerTowerx,
  cy: -p.cornerTowery,
  r: p.cornerTower,
  innerR: 0,
  square: true,
  centerInnerR: true,
  centerRadius: true,
  fade: 10,
  padAngle: 1.3,
  opacity: 0.3,
  color: colorSuffering,
  data: [1, 2, 3, 4] // square has 4 side
    .map((d, i) => {
      return {
        text: "",
        startAngle: 45 + 90 * i,
        endAngle: 45 + 90 * (i + 1),
        polyId: "31PL",
        polyPad: 0,
        strokeWidth: 0
      };
    })
    .concat(
      dataOfId("T31P").map((d) => {
        return {
          centerText: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing
        };
      })
    )

}
)}

function _SECornerTower(p,colorPath,dataOfId){return(
{
  cx:
    p.battlements +
    p.battlementsInner / 2 +
    p.battlementsTitleInner / 2 +
    p.gap / 2,
  cy:
    p.battlements +
    p.battlementsInner / 2 +
    p.battlementsTitleInner / 2 +
    p.gap / 2,
  r: (p.battlementsInner - p.battlementsTitleInner + p.gap) / 2 - 8,
  innerR: p.battlementsTitleInner + 8,
  square: true,
  squareEnds: true,
  centerInnerR: true,
  centerRadius: true,
  fade: 10,
  padAngle: 1.3,
  opacity: 0.3,
  color: colorPath,
  data: dataOfId("4REF") // square has 4 side
    .map((d, i) => {
      return {
        text: "",
        innerR: 0,
        startAngle: 45 + 90 * i,
        endAngle: 45 + 90 * (i + 1),
        polyId: "tttt",
        polyPad: p.gap,
        strokeWidth: 0
      };
    })
    .concat(
      dataOfId("4REF") // square has 4 side
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            endPadRatio: -0.345,
            startAngle: 45 + 90 * i,
            endAngle: 45 + 90 * (i + 1)
          };
        })
    )
    .concat(
      dataOfId("T4REF").map((d) => {
        return {
          centerText: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing
        };
      })
    )
}
)}

function _SWCornerTower(p,colorSuffering,dataOfId){return(
{
  cx: -(
    p.battlements +
    p.battlementsInner / 2 +
    p.battlementsTitleInner / 2 +
    p.gap / 2
  ),
  cy:
    p.battlements +
    p.battlementsInner / 2 +
    p.battlementsTitleInner / 2 +
    p.gap / 2,
  r: (p.battlementsInner - p.battlementsTitleInner + p.gap) / 2 - 8,
  innerR: p.battlementsTitleInner + 8,
  square: true,
  squareEnds: true,
  centerInnerR: true,
  centerRadius: true,
  fade: 10,
  padAngle: 1.3,
  opacity: 0.3,
  color: colorSuffering,
  data: dataOfId("4UNS") // square has 4 side
    .map((d, i) => {
      return {
        text: "",
        innerR: 0,
        startAngle: 45 + 90 * i,
        endAngle: 45 + 90 * (i + 1),
        polyId: "sfdg",
        polyPad: p.gap,
        strokeWidth: 0
      };
    })
    .concat(
      dataOfId("4UNS") // square has 4 side
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            startPadRatio: -0.345,
            startAngle: 45 + 90 * i,
            endAngle: 45 + 90 * (i + 1)
          };
        })
    )
    .concat(
      dataOfId("T4UNS").map((d) => {
        return {
          centerText: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing
        };
      })
    )
}
)}

function _NECornerTower(p,colorPath,dataOfId){return(
{
  cx: p.cornerTowerx,
  cy: -p.cornerTowery,
  r: p.cornerTower,
  innerR: 0,
  square: true,
  centerInnerR: true,
  centerRadius: true,
  fade: 10,
  padAngle: 1.3,
  opacity: 0.3,
  color: colorPath,
  data: [1, 2, 3, 4] // any array of dim 4
    .map((d, i) => {
      return {
        text: "",
        startAngle: 45 + 90 * i,
        endAngle: 45 + 90 * (i + 1),
        polyId: "4REF",
        polyPad: 0,
        strokeWidth: 0
      };
    })
    .concat(
      dataOfId("T16STE").map((d) => {
        return {
          centerText: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing
        };
      })
    )
}
)}

function _NECornerTowerSubTitle(p,colorPath,dataOfId){return(
{
  cx: p.cornerTowerx,
  cy: -p.cornerTowery,
  r: p.cornerTower + p.gap - p.strokeWidth,
  //innerSide: p.cornerTower * 2, // cannot use because we need the tilted angles
  innerR: p.battlementsTitleInner,
  square: true,
  centerInnerR: true,
  centerRadius: true,
  squareEnds: false,
  fade: 0,
  opacity: 1,
  padAngle: 1,
  color: colorPath,
  data: dataOfId("T4FUN")
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorPath,
        startAngle: 90 - 45,
        endAngle: 90 + 45,
        arrowEnd: true,
        arrowFactor: p.arrowFactor,
        endPadRatio: 0.05
      };
    })
    .concat(
      dataOfId("T9JHA").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorPath,
          startAngle: 360 - 45,
          endAngle: 360 + 45,
          arrowStart: true,
          arrowFactor: -p.arrowFactor,
          startPadRatio: 0.05
        };
      })
    )
}
)}

function _CornerStones(p,dataOfId,colorPath,colorCessation,colorSuffering,colorOrigin){return(
{
  cx: p.cCornerStonesx,
  cy: p.cCornerStonesy,
  r: p.CornerStones - p.CornerStonesInner - 2,
  innerR: p.CornerStonesInner,
  square: true,
  centerRadius: true,
  centerInnerR: true,
  fade: 10,
  PadAngle: 1.3,
  opacity: 0.3,
  data: dataOfId("4FUN")
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorPath,
        startAngle: 45 + 90 * i,
        endAngle: 45 + 90 * (i + 1),
        polyId: "4FUN",
        polyPad: 2
      };
    })
    .concat(
      dataOfId("T4FUN").map((d) => {
        return {
          centerText: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorPath
        };
      })
    )
    .concat(
      dataOfId("7FOE").map((d, i) => {
        // background
        return {
          cy: -p.cCornerStonesy + 7,
          cx: p.cCornerStonesx - 11,
          r: p.CornerStones + 2.5 * p.gap,
          innerR: 0,
          color: colorCessation,
          startAngle: 180 + (360 / 7) * i,
          endAngle: 180 + (360 / 7) * (i + 1),
          polyPad: 0,
          polyId: "7FOEb",
          polyFade: 10,
          polyOpacity: 0.7,
          polyPad: 2,
          strokeWidth: 0
        };
      })
    )
    .concat(
      dataOfId("7FOE").map((d, i) => {
        return {
          cy: -p.cCornerStonesy + 7,
          cx: p.cCornerStonesx - 11,
          r: p.CornerStones - p.CornerStonesInner + 3,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation,
          startAngle: 180 + (360 / 7) * i,
          endAngle: 180 + (360 / 7) * (i + 1),
          polyId: "7FOE",

          polyPad: 2
        };
      })
    )

    .concat(
      dataOfId("T7FOE").map((d) => {
        return {
          cy: -p.cCornerStonesy + 7,
          cx: p.cCornerStonesx - 11,
          r: p.CornerStones - p.CornerStonesInner + 3,
          centerText: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation
        };
      })
    )

    .concat(
      dataOfId("6SEN").map((d, i) => {
        return {
          cy: -p.cCornerStonesy + 12,
          cx: -p.cCornerStonesx + 9,
          r: p.CornerStones - p.CornerStonesInner,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 180 + (360 / 6) * i,
          endAngle: 180 + (360 / 6) * (i + 1),
          polyId: "6SEN",
          polyPad: 2
        };
      })
    )
    .concat(
      dataOfId("T6SEN").map((d) => {
        return {
          cy: -p.cCornerStonesy + 12,
          cx: -p.cCornerStonesx + 9,
          r: p.CornerStones - p.CornerStonesInner,
          centerText: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorPath
        };
      })
    )
    .concat(
      dataOfId("5HIN").map((d, i) => {
        return {
          cy: +p.cCornerStonesy - 5,
          cx: -p.cCornerStonesx + 15,
          r: p.CornerStones - p.CornerStonesInner,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: (360 / 5) * i,
          endAngle: (360 / 5) * (i + 1),
          polyId: "5HIN",
          polyPad: 2
        };
      })
    )
    .concat(
      dataOfId("T5HIN").map((d) => {
        return {
          cy: +p.cCornerStonesy - 5,
          cx: -p.cCornerStonesx + 15,
          r: p.CornerStones - p.CornerStonesInner,
          centerText: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorPath
        };
      })
    )
}
)}

function _OuterWall(p,dataOfId,colorCessation,colorOrigin){return(
{
  r: p.outerWall,
  innerR: p.outerWallInner,
  square: true,
  centerInnerR: true,
  fade: 10,
  padAngle: 0.1,
  opacity: 0.3,
  centerRadius: true,
  padSquare: 0.6,
  data: dataOfId("9NUTL")
    .slice(0, 2)
    .reverse()
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorCessation,
        startAngle: 90 + 45,
        endAngle: 180 + 45,
        div: 4,
        n: i + 1
      };
    })
    .concat(
      dataOfId("9NUTL")
        .slice(2, 6)
        .reverse()
        .map((d, i) => {
          return {
            flipLetters: false,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorCessation,
            startAngle: 45,
            endAngle: 90 + 45,
            div: 4,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("9NUTL")
        .slice(6, 8)
        .reverse()
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorCessation,
            startAngle: -45,
            endAngle: 45,
            div: 4,
            n: i + 3
          };
        })
    )
    .concat(
      dataOfId("8NUTI")
        .slice(0, 2)
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorOrigin,
            startAngle: 90 + 45,
            endAngle: 180 + 45,
            div: 4,
            n: i + 3
          };
        })
    )
    .concat(
      dataOfId("8NUTI")
        .slice(2, 6)
        .map((d, i) => {
          return {
            text: d.text,
            flipLetters: false,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorOrigin,
            startAngle: 180 + 45,
            endAngle: 180 + 45 + 90,
            div: 4,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("8NUTI")
        .slice(6, 8)
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorOrigin,
            startAngle: -45,
            endAngle: 45,
            div: 4,
            n: i + 1
          };
        })
    )
}
)}

function _OuterWallBackGround(p,colorCessation,dataOfId,colorOrigin){return(
{
  r: p.outerWall - p.gap / 2,
  innerR: p.outerWallTitleInner + p.outerWallInner + p.gap,
  fade: p.backFade,
  opacity: p.backOpacity,
  square: true,
  centerInnerR: true,
  padAngle: 0,
  centerRadius: true,
  strokeWidth: 0,
  data: [
    {
      text: "",
      color: colorCessation,
      startAngle: 90 + 45,
      endAngle: 180 + 45,
      div: 2,
      n: 1,
      padSquare: 0.3
    }
  ]
    .concat(
      dataOfId("T9NUTL").map((d, i) => {
        return {
          text: "",
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation,
          startAngle: 45,
          endAngle: 90 + 45
        };
      })
    )
    .concat([
      {
        text: "",
        color: colorCessation,
        startAngle: -45,
        endAngle: 45,
        div: 2,
        n: 2,
        padSquare: 0.3
      }
    ])
    .concat([
      {
        text: "",
        color: colorOrigin,
        startAngle: 90 + 45,
        endAngle: 180 + 45,
        div: 2,
        n: 2,
        padSquare: 0.3
      }
    ])
    .concat(
      dataOfId("T8NUTI").map((d, i) => {
        return {
          text: "",
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: 180 + 45,
          endAngle: 180 + 45 + 90
        };
      })
    )
    .concat([
      {
        text: "",
        color: colorOrigin,
        startAngle: -45,
        endAngle: 45,
        div: 2,
        n: 1,
        padSquare: 0.3
      }
    ])
}
)}

function _OuterWallTitle(p,colorCessation,dataOfId,colorOrigin){return(
{
  r: p.outerWallTitle,
  innerR: p.outerWallTitleInner,
  square: true,
  centerInnerR: true,
  flipLetters: false,
  padAngle: 0.02,
  centerRadius: true,
  data: [
    {
      text: "",
      color: colorCessation,
      startAngle: 90 + 45,
      endAngle: 180 + 45,
      div: 2,
      n: 1,
      padSquare: 0.3
    }
  ]
    .concat(
      dataOfId("T9NUTL").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation,
          startAngle: 45,
          endAngle: 90 + 45
        };
      })
    )
    .concat([
      {
        text: "",
        color: colorCessation,
        startAngle: -45,
        endAngle: 45,
        div: 2,
        n: 2,
        padSquare: 0.3
      }
    ])
    .concat([
      {
        text: "",
        color: colorOrigin,
        startAngle: 90 + 45,
        endAngle: 180 + 45,
        div: 2,
        n: 2,
        padSquare: 0.3
      }
    ])
    .concat(
      dataOfId("T8NUTI").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: 180 + 45,
          endAngle: 180 + 45 + 90
        };
      })
    )
    .concat([
      {
        text: "",
        color: colorOrigin,
        startAngle: -45,
        endAngle: 45,
        div: 2,
        n: 1,
        padSquare: 0.3
      }
    ])
}
)}

function _InnerWallTitle(p,dataOfId,colorOrigin,colorCessation){return(
{
  r: p.innerWallTitle,
  innerR: p.innerWallTitleInner,
  padAngle: 0.25,
  data: dataOfId("T12DO")
    .map((d) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorOrigin,
        startAngle: 180,
        endAngle: 360
      };
    })

    .concat(
      dataOfId("T12TDO").map((d) => {
        return {
          flipLetters: false,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation,
          startAngle: 0,
          endAngle: 180
        };
      })
    )
}
)}

function _InnerWall(p,colorOrigin,colorCessation,dataOfId){return(
{
  r: p.innerWall,
  innerR: p.innerWallInner,
  fade: 10,
  opacity: 0.3,
  padAngle: 0.25,
  data: [
    {
      r: p.innerWall - (p.gap * 2) / 3,
      innerR: p.innerWallInner + p.innerWallTitleInner + p.gap * 2,
      strokeWidth: 0,
      text: "", // background
      color: colorOrigin,
      startAngle: 180,
      endAngle: 360,
      opacity: 0.7,
      padAngle: 0
    },
    {
      r: p.innerWall - (p.gap * 2) / 3,
      innerR: p.innerWallInner + +p.innerWallTitleInner + p.gap * 2,
      strokeWidth: 0,
      text: "", // background
      color: colorCessation,
      startAngle: 0,
      endAngle: 180,
      opacity: 0.7,
      padAngle: 0
    }
  ]
    .concat(
      dataOfId("12DO").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          // color:
          //   d.id == "12DO2" ||
          //   d.id == "12DO3" ||
          //   d.id == "12DO4" ||
          //   d.id == "12DO5" ||
          //   d.id == "12DO5" ||
          //   d.id == "12DO6" ||
          //   d.id == "12DO7" ||
          //   d.id == "12DO11" ||
          //   d.id == "12DO12"
          //     ? colorOrigin
          //     : colorOrigin,
          // opacity:
          //   d.id == "12DO4" ||
          //   d.id == "12DO5" ||
          //   d.id == "12DO8" ||
          //   d.id == "12DO9" ||
          //   d.id == "12DO10" ||
          //   d.id == "12DO1"
          //     ? 1
          //     : 0.3,
          // fade:
          //   d.id == "12DO4" ||
          //   d.id == "12DO5" ||
          //   d.id == "12DO8" ||
          //   d.id == "12DO9" ||
          //   d.id == "12DO10" ||
          //   d.id == "12DO1"
          //     ? 0
          //     : 10,
          // strokeWidth:
          //   d.id == "12DO4" ||
          //   d.id == "12DO5" ||
          //   d.id == "12DO8" ||
          //   d.id == "12DO9" ||
          //   d.id == "12DO10" ||
          //   d.id == "12DO1"
          //     ? 1.2
          //     : undefined,
          // strokeColor: colorOrigin,

          startAngle: 180,
          endAngle: 360,
          div: 12,
          n: i + 1
        };
      })
    )
    .concat(
      dataOfId("12TDO")
        .reverse()
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorCessation,
            startAngle: 0,
            endAngle: 180,
            div: 12,
            n: i + 1
          };
        })
    )
}
)}

function _LowerBaileySubTitle(p,colorSuffering,dataOfId,colorCessation,colorOrigin){return(
{
  r: p.lowerBaileySubTitle,
  innerR: p.lowerBaileySubTitleInner,
  padAngle: 0.35,
  fade: p.fade,
  opacity: 1,
  color: colorSuffering,
  data: dataOfId("T4EL")
    .map((d) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        startAngle: 270,
        endAngle: 270 + 90 / 5
      };
    })
    .concat(
      dataOfId("T3FE").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: 270 + 90 / 5,
          endAngle: 270 + (2 * 90) / 5
        };
      })
    )
    .concat({
      r: p.lowerBailey,
      text: dataOfId("N&F1")[0].text,
      fontSize: dataOfId("N&F1")[0].fontSize,
      letterSpacing: dataOfId("N&F1")[0].letterSpacing,
      startAngle: 270 + (90 / 5) * 2,
      endAngle: 270 + (90 / 5) * 4,
      div: 2,
      n: 1
    })
    .concat({
      r: p.lowerBailey,

      text: dataOfId("N&F4")[0].text,
      fontSize: dataOfId("N&F4")[0].fontSize,
      letterSpacing: dataOfId("N&F4")[0].letterSpacing,
      startAngle: 270 + (90 / 5) * 2,
      endAngle: 270 + (90 / 5) * 4,
      div: 2,
      n: 2
    })
    .concat({
      text: dataOfId("N&F3")[0].text,
      fontSize: dataOfId("N&F3")[0].fontSize,
      letterSpacing: dataOfId("N&F3")[0].letterSpacing,
      startAngle: 270 + (90 / 5) * 2,
      endAngle: 270 + (90 / 5) * 4,
      div: 2,
      n: 1
    })
    .concat({
      text: dataOfId("N&F2")[0].text,
      fontSize: dataOfId("N&F2")[0].fontSize,
      letterSpacing: dataOfId("N&F2")[0].letterSpacing,
      startAngle: 270 + (90 / 5) * 2,
      endAngle: 270 + (90 / 5) * 4,
      div: 2,
      n: 2
    })
    // 10 Fetters Abondonned
    .concat({
      innerR: p.lowerBaileySubTitleInner / 4,
      r: p.lowerBaileySubTitle + (p.lowerBaileySubTitleInner / 2.7) * 2,
      text: dataOfId("4SOE")[0].text,
      fontSize: dataOfId("4SOE")[0].fontSize - 5,
      letterSpacing: dataOfId("4SOE")[0].letterSpacing,
      color: colorCessation,
      startAngle: 0 + ((90 - (90 / 8) * 2 - p.padDonjon) / 10) * 0,
      endAngle: 0 + ((90 - (90 / 8) * 2 - p.padDonjon) / 10) * 7
    })
    .concat({
      innerR: p.lowerBaileySubTitleInner / 3.6,
      r: p.lowerBaileySubTitle + p.lowerBaileySubTitleInner / 2.8,
      text: dataOfId("4SOE")[1].text,
      fontSize: dataOfId("4SOE")[1].fontSize - 5,
      letterSpacing: dataOfId("4SOE")[1].letterSpacing,
      color: colorCessation,
      strokeWidth: 0,
      opacity: 0.8,
      startAngle: 0 + ((90 - (90 / 8) * 2 - p.padDonjon) / 10) * 0,
      endAngle: 0 + ((90 - (90 / 8) * 2 - p.padDonjon) / 10) * 7
    })
    .concat({
      innerR: p.lowerBaileySubTitleInner / 4,
      r: p.lowerBaileySubTitle + p.lowerBaileySubTitleInner / 2.7,
      text: dataOfId("4SOE")[1].text,
      fontSize: dataOfId("4SOE")[1].fontSize - 5,
      letterSpacing: dataOfId("4SOE")[1].letterSpacing,
      color: colorCessation,
      startAngle: 0 + ((90 - (90 / 8) * 2 - p.padDonjon) / 10) * 0,
      endAngle: 0 + ((90 - (90 / 8) * 2 - p.padDonjon) / 10) * 5
    })

    .concat({
      innerR: p.lowerBaileySubTitleInner / 4,
      r: p.lowerBaileySubTitle + (p.lowerBaileySubTitleInner / 3) * 0,
      text: dataOfId("4SOE")[2].text,
      fontSize: dataOfId("4SOE")[2].fontSize - 5,
      letterSpacing: dataOfId("4SOE")[2].letterSpacing,
      color: colorCessation,
      startAngle: 0 + ((90 - (90 / 8) * 2 - p.padDonjon) / 10) * 0,
      endAngle: 0 + ((90 - (90 / 8) * 2 - p.padDonjon) / 10) * 5
    })
    // Effluants
    .concat(
      dataOfId("T4IGN").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: 180 + (90 / 4) * 0,
          endAngle: 180 + 90 / 4
        };
      })
    )
    .concat(
      dataOfId("T3BEC").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: 180 + (90 / 4) * 1,
          endAngle: 180 + (90 / 4) * 2
        };
      })
    )
    .concat(
      dataOfId("T5STR").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: 180 + (90 / 4) * 2,
          endAngle: 180 + (90 / 4) * 3
        };
      })
    )
}
)}

function _LowerBaileyTitle(p,colorSuffering,dataOfId,colorCessation,colorOrigin,colorPath){return(
{
  r: p.lowerBaileyTitle,
  innerR: p.lowerBaileyTitleInner,
  padAngle: 0.35,
  color: colorSuffering,
  data: dataOfId("TN&F")
    .map((d) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        startAngle: 270,
        endAngle: 270 + (90 / 5) * 4
      };
    })
    .concat(
      dataOfId("T6CO").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          startAngle: 270 + (90 / 5) * 4,
          endAngle: 360
        };
      })
    )
    .concat(
      dataOfId("T10FET").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation,
          startAngle: 0,
          endAngle: 90 - (90 / 8) * 2 - p.padDonjon
        };
      })
    )
    .concat(
      dataOfId("T6HK").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation,
          startAngle: 90 - (90 / 8) * 2,
          endAngle: 90
        };
      })
    )
    .concat(
      dataOfId("T3EFF").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: 180,
          endAngle: 180 + (90 / 4) * 3
        };
      })
    )
    .concat(
      dataOfId("T4CLIN").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: 180 + (90 / 4) * 3,
          endAngle: 180 + (90 / 4) * 4
        };
      })
    )
    .concat(
      dataOfId("T8FP").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorPath,
          startAngle: 90,
          endAngle: 180
        };
      })
    )
}
)}

function _LowerBailey(p,dataOfId,colorSuffering,colorCessation,colorOrigin,colorPath){return(
{
  r: p.lowerBailey,
  innerR: p.lowerBaileyInner,
  radial: true,
  fade: 10,
  opacity: 0.3,
  padAngle: 0.3,
  endPadAngle: 0.1,
  data: dataOfId("4EL")
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorSuffering,
        startAngle: 270,
        endAngle: 270 + 90 / 5,
        div: 4,
        n: i + 1
      };
    })
    .concat(
      dataOfId("3FE").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 270 + 90 / 5,
          endAngle: 270 + (2 * 90) / 5,
          div: 3,
          n: i + 1
        };
      })
    )
    .concat(
      dataOfId("CON").map((d, i) => {
        return {
          innerR: p.lowerBaileyInner - p.lowerBaileySubTitleInner - p.gap,
          r: p.lowerBailey + p.lowerBaileySubTitleInner + p.gap,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 270 + (90 / 5) * 2,
          endAngle: 270 + (90 / 5) * 3,
          div: 3,
          n: i + 1
        };
      })
    )
    .concat(
      dataOfId("3FAB").map((d, i) => {
        return {
          innerR: p.lowerBaileyInner - p.lowerBaileySubTitleInner - p.gap,
          r: p.lowerBailey + p.lowerBaileySubTitleInner + p.gap,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 270 + (90 / 5) * 3,
          endAngle: 270 + (90 / 5) * 4,
          div: 3,
          n: i + 1
        };
      })
    )
    .concat(
      dataOfId("6CO").map((d, i) => {
        return {
          innerR: p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 270 + (90 / 5) * 4,
          endAngle: 270 + 90,
          div: 6,
          n: i + 1
        };
      })
    )
    .concat(
      dataOfId("10FET")
        .reverse()
        .map((d, i) => {
          return {
            innerR:
              i > 6
                ? p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap
                : i > 4
                ? p.lowerBaileyInner + p.lowerBaileySubTitleInner / 2.8
                : undefined,
            text: d.text,
            flipLines: true,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorCessation,
            startAngle: 0,
            endAngle: 90 - (90 / 8) * 2 - p.padDonjon,
            div: 10,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("6HK")
        .reverse()
        .map((d, i) => {
          return {
            innerR: p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorCessation,
            startAngle: 90 - (90 / 8) * 2,
            endAngle: 90,
            div: 6,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("4IGN")
        // .reverse()
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorOrigin,
            startAngle: 180 + 90 / 4,
            endAngle: 180,
            div: 4,
            n: i + 1,
            flipLines: true
          };
        })
    )
    .concat(
      dataOfId("3BEC")
        .reverse()
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorOrigin,
            startAngle: 180 + 90 / 4,
            endAngle: 180 + (90 / 4) * 2,
            div: 3,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("5STR")
        .reverse()
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorOrigin,
            startAngle: 180 + (90 / 4) * 2,
            endAngle: 180 + (90 / 4) * 3,
            div: 5,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("4CLIN")
        .reverse()
        .map((d, i) => {
          return {
            innerR: p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorOrigin,
            startAngle: 180 + (90 / 4) * 3,
            endAngle: 180 + (90 / 4) * 4,
            div: 4,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("4RC")
        .reverse()
        .map((d, i) => {
          return {
            innerR: p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90,
            endAngle: 90 + (90 / 8) * 1,
            div: 4,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("4RM")
        .reverse()
        .map((d, i) => {
          return {
            innerR: p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 + (90 / 8) * 1,
            endAngle: 90 + (90 / 8) * 2,
            div: 4,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("4REF")
        .reverse()
        .map((d, i) => {
          return {
            innerR: p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap,
            flipLines: true,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 + (90 / 8) * 2,
            endAngle: 90 + (90 / 8) * 3,
            div: 4,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("5RL")
        .reverse()
        .map((d, i) => {
          return {
            innerR: p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 + (90 / 8) * 3,
            endAngle: 90 + (90 / 8) * 4,
            div: 5,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("3RA")
        .reverse()
        .map((d, i) => {
          return {
            innerR: p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 + (90 / 8) * 4,
            endAngle: 90 + (90 / 8) * 5,
            div: 3,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("4RS")
        .reverse()
        .map((d, i) => {
          return {
            innerR: p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 + (90 / 8) * 5,
            endAngle: 90 + (90 / 8) * 6,
            div: 4,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("3RI")
        .reverse()
        .map((d, i) => {
          return {
            innerR: p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 + (90 / 8) * 6,
            endAngle: 90 + (90 / 8) * 7,
            div: 3,
            n: i + 1
          };
        })
    )
    .concat(
      dataOfId("3RV")
        .reverse()
        .map((d, i) => {
          return {
            innerR: p.lowerBaileyInner + p.lowerBaileySubTitleInner + p.gap,
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorPath,
            startAngle: 90 + (90 / 8) * 7,
            endAngle: 90 + (90 / 8) * 8,
            div: 3,
            n: i + 1
          };
        })
    )
}
)}

function _HigherBaileyTitle(p,dataOfId,colorSuffering,colorOrigin,colorCessation,colorPath){return(
{
  r: p.higherBaileyTitle,
  innerR: p.higherBaileyTitleInner,
  padAngle: 0.48,
  // opacity: 0.8,
  data: dataOfId("T5A")
    .map((d) => {
      return {
        text: "",
        color: colorSuffering,
        fade: 10,
        opacity: 0.7,
        startAngle: 270,
        endAngle: 270 + 90 / 1.5,
        r: p.higherBailey,
        innerR: p.higherBaileyInner + p.higherBaileyTitleInner + p.gap
      };
    })
    .concat(
      dataOfId("T5A").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          //opacity: 0.9,
          startAngle: 270,
          endAngle: 270 + 90 / 1.5
        };
      })
    )
    .concat(
      dataOfId("T3CE").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 270 + 90 / 1.5,
          endAngle: 360
        };
      })
    )
    .concat(
      dataOfId("T3CR").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: 180 + 90 / 2.5,
          endAngle: 270
        };
      })
    )
    .concat(
      dataOfId("T3DEF").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: 180,
          endAngle: 180 + 90 / 2.5
        };
      })
    )
    .concat(
      dataOfId("T4SOE").map((d) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation,
          startAngle: 0,
          endAngle: 90 - (90 / 8) * 2 - p.padDonjon
        };
      })
    )
    // .concat(
    //   dataOfId("T8FP").map((d) => {
    //     return {
    //       text: d.text,
    //       fontSize: d.fontSize,
    //       letterSpacing: d.letterSpacing,
    //       color: colorPath,
    //       startAngle: 90,
    //       endAngle: 180
    //     };
    //   })
    // )
    // Sila Samadhi Panna
    .concat(
      dataOfId("3DIV3").map((d) => {
        return {
          fade: p.fade,
          r: p.higherBaileyTitle,
          innerR: p.higherBaileyTitleInner,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorPath,
          startAngle: 90 + 0.8 + ((90 - 1.6) / 8) * 0,
          endAngle: 90 + 0.8 + ((90 - 1.6) / 8) * 3
        };
      })
    )
    .concat(
      dataOfId("3DIV2").map((d) => {
        return {
          fade: p.fade,
          r: p.higherBaileyTitle,
          innerR: p.higherBaileyTitleInner,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorPath,
          startAngle: 90 + 0.8 + ((90 - 1.6) / 8) * 3,
          endAngle: 90 + 0.8 + ((90 - 1.6) / 8) * 6
        };
      })
    )
    .concat(
      dataOfId("3DIV1").map((d) => {
        return {
          fade: p.fade,
          r: p.higherBaileyTitle,
          innerR: p.higherBaileyTitleInner,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorPath,
          startAngle: 90 + 0.8 + ((90 - 1.6) / 8) * 6,
          endAngle: 90 + 0.8 + ((90 - 1.6) / 8) * 8
        };
      })
    )
    .concat(
      dataOfId("3DIV4").map((d) => {
        return {
          fade: p.fade,
          r: p.higherBaileyTitle,
          innerR: p.higherBaileyTitleInner,
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorCessation,
          startAngle: 90 - (90 / 8) * 2,
          endAngle: 90
        };
      })
    )
}
)}

function _HigherBailey(p,dataOfId,colorSuffering,colorOrigin,colorCessation,colorPath){return(
{
  r: p.higherBailey + p.gap,
  innerR: p.higherBaileyInner - p.gap,
  radial: true,
  fade: 10,
  opacity: 0.3,
  padAngle: 0.7,
  endPadAngle: 0.7,
  data: dataOfId("5A")
    .map((d, i) => {
      return {
        text: d.text,
        fontSize: d.fontSize,
        letterSpacing: d.letterSpacing,
        color: colorSuffering,
        startAngle: 270,
        endAngle: 270 + 90 / 1.5,
        div: 5,
        n: i + 1
      };
    })
    .concat(
      dataOfId("3CE").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorSuffering,
          startAngle: 270 + 90 / 1.5,
          endAngle: 360,
          div: 3,
          n: i + 1
        };
      })
    )
    .concat(
      dataOfId("3DEF")
        .reverse()
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorOrigin,
            startAngle: 180,
            endAngle: 180 + 90 / 2.5,
            div: 3,
            n: i + 1,
            flipLines: false
          };
        })
    )
    .concat(
      dataOfId("3CR").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorOrigin,
          startAngle: 180 + 90 / 2.5,
          endAngle: 180 + 90,
          div: 3,
          n: i + 1
        };
      })
    )
    .concat(
      dataOfId("4SOE")
        .reverse()
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorCessation,
            startAngle: 0,
            endAngle: 90 - (90 / 8) * 2 - p.padDonjon,
            div: 4,
            n: i + 1
            // endPadAngle: 1
          };
        })
    )
    .concat(
      dataOfId("8FP").map((d, i) => {
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: colorPath,
          darkenFactor: 20,
          startAngle: 90,
          endAngle: 180,
          div: 8,
          n: i + 1
        };
      })
    )
    .concat(
      dataOfId("10FP")
        .reverse()
        .map((d, i) => {
          return {
            text: d.text,
            fontSize: d.fontSize,
            letterSpacing: d.letterSpacing,
            color: colorCessation,
            darkenFactor: 20,
            startAngle: 90 - (90 / 8) * 2,
            endAngle: 90,
            div: 2,
            n: i + 1
          };
        })
    )
}
)}

function _DonjonChemise(p,dataOfId,colorFourNobleTruths){return(
{
  r: p.chemise,
  innerR: p.chemiseInner,
  fade: 30,
  opacity: 0.4,
  padAngle: 0,
  strokeWidth: 0.5,
  darkenFactor: 10,
  fontSize: 8,
  data: dataOfId("4D").map((d, i) => {
    const arrStartAngles = [270, 180, 0, 90];
    const arrEndAngles = [360, 270, 90, 180];
    return {
      text: d.text,
      fontSize: d.fontSize,
      letterSpacing: d.letterSpacing,
      color: colorFourNobleTruths,
      startAngle: arrStartAngles[i],
      endAngle: arrEndAngles[i]
    };
  })
}
)}

function _Donjon(p,colorFourNobleTruths,dataOfId,colorSuffering,colorOrigin,colorCessation,colorPath){return(
{
  r: p.donjon,
  innerR: p.donjonInner,
  fade: 10,
  opacity: 0.3,
  square: true,
  padAngle: 0.5,
  centerRadius: false,
  centerInnerR: false,
  strokeWidth: p.strokeWidth + 0.2,
  data: [1, 2, 3, 4]
    .map((d, i) => {
      const arrStartAngles = [0, 90, 180, 270];
      const arrEndAngles = [90, 180, 270, 360];
      return {
        text: "",
        r: p.donjon + p.donjonInner + 1,
        innerR: 0,
        color: colorFourNobleTruths,
        startAngle: arrStartAngles[i],
        endAngle: arrEndAngles[i],
        polyFade: 10,
        polyOpacity: 0.7,
        polyId: "4NT0",
        polyPad: 0,
        strokeWidth: 1
      };
    })
    .concat(
      [1, 2, 3, 4].map((d, i) => {
        const arrStartAngles = [0, 90, 180, 270];
        const arrEndAngles = [90, 180, 270, 360];
        return {
          text: "",
          r: p.donjon - 3,
          innerR: 0,

          color: colorFourNobleTruths,
          startAngle: arrStartAngles[i],
          endAngle: arrEndAngles[i],
          polyId: "4NT",
          polyPad: 0,
          gradientID: "4N",
          gradientR: 97,
          gradientI: 38,
          invertGradient: true,
          strokeWidth: 1
        };
      })
    )
    .concat(
      dataOfId("4NT").map((d, i) => {
        const arrStartAngles = [270, 180, 0, 90];
        const arrEndAngles = [360, 270, 90, 180];
        const arrDarkenFactor = [0, 0, 0, 20];
        const arrColors = [
          colorSuffering,
          colorOrigin,
          colorCessation,
          colorPath
        ];
        return {
          text: d.text,
          fontSize: d.fontSize,
          letterSpacing: d.letterSpacing,
          color: arrColors[i],
          darkenFactor: arrDarkenFactor[i],
          startAngle: arrStartAngles[i],
          endAngle: arrEndAngles[i]
        };
      })
    )
    .concat(
      dataOfId("T4NT").map((d) => {
        return {
          centerText: d.text,
          fontSize: d.fontSize,
          // letterSpacing: d.letterSpacing,
          up: d.text.includes("//") ? 0.4 + d.letterSpacing : -0.3
        };
      })
    )
}
)}

function _dataOfId(data){return(
(str) => {
  const filteredData = data.filter(
    (d) => d.id.toString().slice(0, str.length) === str
  );
  return !isNaN(str.slice(-1)) ? [filteredData[0]] : filteredData;
}
)}

function _drawRing(d3,DOM){return(
(svgOrigin, ringParam) => {
  const defaultParam = {
    // Geometry //
    cx: 0, // Angles are mesured from top like a clock in deg
    cy: 0,
    r: 100,
    innerR: 20,
    padAngle: 1, // Angle Padding (actually work linear)
    padRadius: null, // arcline = padRadius x padAngle
    padLinear: false, // Linear Padding (not used)
    cornerRadius: 0,

    // Aspect //
    radial: false, // Direction of text
    strokeWidth: 0.6,
    strokeColor: false,
    fontSize: 12,
    fontName: "Cormorant SC",
    letterSpacing: 0,
    flipLetters: false, // Upside Down
    flipLines: false, // Top & Bottom
    bold: 700,
    bottomAdjust: 0, // Line Height
    topAdjust: 0, // Line height

    // Coloring //
    color: "black",
    fade: 0,
    fadeLimit: 30, // Turn the background dark and letters white
    opacity: 1,
    opacityLimit: 0.5, // same (could have a variable switchColor)
    darkenFactor: 0,
    opaque: true, // Add white background behind ring
    gradientID: false,
    gradientR: 50,
    gradientI: 0,
    gradientX: 50,
    gradientY: 50,
    invertGradient: false,

    // Divisions //
    div: 1, // |-endPadAngle-|-1-|-2-|-n-|-4-|-div-|-endPadAngle-|
    n: 1, // Segment num
    endPadAngle: 0, // Angle End Padding
    endPadLinear: false, // Linear End Padding
    startRatio: 0, // |sR*L|-1-|-2-|-n-|-4-|-div-|L-eR*L|
    endRatio: 1, // L : arcLength/square side depends on R and angles
    padRatio: 0, //  |sR*L|-startPadRatio-|-text-|-endPadRatio-|L-eR*L|
    startPadRatio: false, // padRatio by default
    endPadRatio: false, // padRatio by default

    // Square Style //
    square: false,
    squareEnds: false,
    centerRadius: true, // Radius is mesured from origin to center of cells.
    centerInnerR: true, // Inner Radius is mesured from center of cells.
    innerSide: false, // length of inner side, overwrite angles and padAngle
    padSquare: 0, // Padding between div cells
    tilted: false, // Angle of cells wall (not used)
    arrowEnd: false, // end in an arrow
    arrowStart: false,
    arrowFactor: 1,

    // Polygone Coloring //
    polyId: false, // Identify the poly
    polyPad: 0, // inner Padding
    polyOpacity: 1,
    polyFade: 0,
    polyOpaque: true,
    centerText: "",
    up: 0
  };

  // Global Constants & function
  const pi = Math.PI;
  const dTR = (deg) => (pi / 180) * deg; // deg to rad
  const rTD = (rad) => (180 / pi) * rad; // rad to deg
  const modPi = (angle) => angle % (2 * pi);
  const sin = (x) => Math.sin(x);
  const cos = (x) => Math.cos(x);

  // Color Functions
  const fading = (color, f) => {
    const { l, c, h } = d3.lch(color);
    return d3.lch(l + f, c, h);
  };
  const darken = (color, f) => fading(color, -f);

  // Create Ring
  const svg = d3.create("svg");

  // For Filling Polygone later
  let arrPoints = [];
  let d2 = {}; // alternative data

  const background = svg.append("g").attr("id", "background");

  ringParam.data.forEach((dOrigin, index) => {
    // d will be our main data element
    const structuredClone = (val) => JSON.parse(JSON.stringify(val));
    const d = structuredClone(dOrigin);

    // Index for adding text to arc
    const id = DOM.uid("p-" + d.index);

    // define local parameter for each data according to priority
    // d.origin (data) > ring Param > Default Param
    for (const p in defaultParam) {
      dOrigin[p] != undefined
        ? (d[p] = dOrigin[p])
        : ringParam[p] != undefined
        ? (d[p] = ringParam[p])
        : (d[p] = defaultParam[p]);
    }

    // All to Rad !
    d.startAngle = dTR(d.startAngle);
    d.endAngle = dTR(d.endAngle);
    d.padAngle = dTR(d.padAngle);
    d.endPadAngle = dTR(d.endPadAngle);

    // Definition
    let a = d.startAngle;
    let b = d.endAngle;
    let c = (b - a) / 2;

    if (d.endPadLinear)
      d.endPadAngle = Math.abs(
        Math.atan(Math.tan(c) - d.endPadLinear / d.r) - c
      );
    a = d.startAngle + d.endPadAngle;
    b = d.endAngle - d.endPadAngle;
    c = (b - a) / 2;

    let e = (a + b) / 2;
    let R = d.r;
    let Rs = R * cos(c);
    let r = d.innerR;
    let rs = r * cos(c);
    const div = d.div;
    const n = d.n;
    const polyPad = d.polyPad;

    // by default d.padRatio
    d.startPadRatio = d.startPadRatio !== false ? d.startPadRatio : d.padRatio;
    d.endPadRatio = d.endPadRatio !== false ? d.endPadRatio : d.padRatio;

    // CenterText
    if (d.centerText != "") {
      d.text = "";
      d.startAngle = 0;
      d.endAngle = 0;
      d.strokeWidth = 0;
      d.opacity = 0;
      d.opaque = false;
    }

    // OuterSquare
    if (d.square) {
      if (d.centerRadius) R = R / cos(c);
      if (d.innerSide) {
        // mess up the tilted corners
        // L = innerSide
        // (L/2)^2 + R^2 = r^2
        Rs = R * cos(c);
        R = Math.sqrt((d.innerSide * d.innerSide) / 4 + Rs * Rs);
        a = e - Math.atan(d.innerSide / 2 / Rs);
        b = e + Math.atan(d.innerSide / 2 / Rs);
        c = (b - a) / 2;
      }
      if (d.centerInnerR) r = r / cos(c);
      Rs = R * cos(c);
      rs = r * cos(c);
    } else {
      // Calculate angles when division is made
      const thetaDiv = (b - a) / div;
      const thetaStart = a + (n - 1) * thetaDiv;
      const thetaEnd = a + n * thetaDiv;

      a = thetaStart;
      b = thetaEnd;
      c = (b - a) / 2;
      e = (a + b) / 2;
    }

    // At the bottom ?
    e = modPi(e);
    const atBottom = e > pi / 2 && e < (3 * pi) / 2;
    const atLeft = e > pi && e < 2 * pi;

    // Start drawing here
    const g = svg
      .append("g")
      .attr("class", "arcLabel")
      .attr("transform", `translate(${d.cx}, ${d.cy})`);

    // Gradient //
    //Append a defs (for definition) element to your SVG
    const defs = g.append("defs");

    //Append a radialGradient element to the defs and give it a unique id
    const radialGradient = defs
      .append("radialGradient")
      .attr("id", "radial-gradient-" + d.gradientID)
      .attr("cx", d.gradientX + "%") //The x-center of the gradient
      .attr("cy", d.gradientY + "%") //The y-center of the gradient
      .attr("r", d.gradientR + "%"); //The radius of the gradient

    //Add colors to make the gradient
    radialGradient
      .append("stop")
      .attr("offset", d.gradientI + "%")
      .attr("stop-color", d.invertGradient ? d.color : "#FFFFFF");
    radialGradient
      .append("stop")
      .attr("offset", "100%")
      .attr("stop-color", d.invertGradient ? "#FFFFFF" : d.color);

    // SQUARE SHAPE //
    // Square Calculation (y axis is inverted & angle start at the top !)

    const OA00x = R * sin(a);
    const OA00y = R * -cos(a);

    const OAddx = R * sin(b);
    const OAddy = R * -cos(b);

    const OB00x = (R + r) * sin(a);
    const OB00y = (R + r) * -cos(a);

    const OBddx = (R + r) * sin(b);
    const OBddy = (R + r) * -cos(b);

    const OA0x =
      OA00x + (d.startRatio + d.padAngle + d.startPadRatio) * (OAddx - OA00x);
    const OA0y =
      OA00y + (d.startRatio + d.padAngle + d.startPadRatio) * (OAddy - OA00y);

    const OAdx =
      OA00x + (d.endRatio - d.padAngle - d.endPadRatio) * (OAddx - OA00x);
    const OAdy =
      OA00y + (d.endRatio - d.padAngle - d.endPadRatio) * (OAddy - OA00y);

    const OA0xP = (R - polyPad) * sin(a);
    const OA0yP = (R - polyPad) * cos(a);

    const OAdxP = (R - polyPad) * sin(b);
    const OAdyP = (R - polyPad) * cos(b);

    const OAix = (i) => (1 - i / div) * OA0x + (i / div) * OAdx;
    const OAiy = (i) => (1 - i / div) * OA0y + (i / div) * OAdy;

    const OAixP = (i) => (1 - i / div) * OA0xP + (i / div) * OAdxP;
    const OAiyP = (i) => (1 - i / div) * OA0yP + (i / div) * OAdyP;

    const OB0tx = OA0x + OB00x - OA00x;
    const OB0ty = OA0y + OB00y - OA00y;

    const OB0txP = OA0xP + OB00x - OA00x;
    const OB0tyP = OA0yP + OB00y - OA00y;

    const OBdtx = OAdx + OBddx - OAddx;
    const OBdty = OAdy + OBddy - OAddy;

    const OBix = (i) => (1 - i / div) * OB0tx + (i / div) * OBdtx;
    const OBiy = (i) => (1 - i / div) * OB0ty + (i / div) * OBdty;

    const A0B0x = (1 / 2) * (OB0tx - OA0x + OBdtx - OAdx);
    const A0B0y = (1 / 2) * (OB0ty - OA0y + OBdty - OAdy);

    const A0A1x = OAix(1) - OA0x;
    const A0A1y = OAiy(1) - OA0y;

    const px = (A0A1x * d.padSquare) / 100;
    const py = (A0A1y * d.padSquare) / 100;

    if (d.square) {
      // Square Path
      g.append("path")
        .attr("display", d.square ? "" : "none")
        .attr(
          "d",
          //d3.line().curve(d3.curveCardinalClosed.tension(0.8))([
          d3.line().curve(d3.curveLinearClosed)([
            // first point
            n <= 1
              ? [OAix(n - 1), OAiy(n - 1)]
              : [OAix(n - 1) + px, OAiy(n - 1) + py],
            // second start arrow point
            d.squareEnds || d.arrowStart
              ? [
                  OAix(n - 1) +
                    (1 / 2) * A0B0x -
                    (1 / 2) * A0B0y * (d.arrowStart ? 1 : 0) * d.arrowFactor +
                    px * (n <= 1 ? 0 : 1),
                  OAiy(n - 1) +
                    (1 / 2) * A0B0y +
                    (1 / 2) * A0B0x * (d.arrowStart ? 1 : 0) * d.arrowFactor +
                    py * (n <= 1 ? 0 : 1)
                ]
              : n <= 1 // copy of first point
              ? [OAix(n - 1), OAiy(n - 1)]
              : [OAix(n - 1) + px, OAiy(n - 1) + py],
            // third point
            n <= 1
              ? d.squareEnds || d.arrowStart
                ? [OAix(n - 1) + A0B0x, OAiy(n - 1) + A0B0y]
                : [OB0tx, OB0ty]
              : [OAix(n - 1) + A0B0x + px, OAiy(n - 1) + A0B0y + py],
            // fourth point
            n == div
              ? d.squareEnds || d.arrowEnd
                ? [OAix(n) + A0B0x, OAiy(n) + A0B0y]
                : [OBdtx, OBdty]
              : [OAix(n) + A0B0x - px, OAiy(n) + A0B0y - py],
            // fifth end arrow point
            d.squareEnds || d.arrowEnd
              ? [
                  OAix(n) +
                    (1 / 2) * A0B0x -
                    (1 / 2) * A0B0y * (d.arrowEnd ? 1 : 0) * d.arrowFactor -
                    px * (n == div ? 0 : 1),
                  OAiy(n) +
                    (1 / 2) * A0B0y +
                    (1 / 2) * A0B0x * (d.arrowEnd ? 1 : 0) * d.arrowFactor -
                    py * (n == div ? 0 : 1)
                ]
              : n == div // copy of fourth point
              ? [OAix(n), OAiy(n)]
              : [OAix(n) - px, OAiy(n) - py],
            // sixth point
            n == div ? [OAix(n), OAiy(n)] : [OAix(n) - px, OAiy(n) - py]
          ])
        )
        .style("stroke", d.stokeColor ? d.strokeColor : d.color)
        .style("stroke-width", d.strokeWidth)
        .style("fill", fading(d.color, d.fade))
        .style("fill-opacity", d.opacity)
        .clone()
        .lower()
        .style("fill", d.opaque ? "white" : "")
        .style("fill-opacity", d.opaque ? 1 : 0);
    }

    // fill polygone
    if (
      d.polyId != d2.polyId ||
      (index == ringParam.data.length - 1 && d.polyId)
    ) {
      if (index == ringParam.data.length - 1 && d.polyId)
        arrPoints.push([OAixP(1), OAiyP(1)]);

      // Gradient //

      //Append a radialGradient element to the defs and give it a unique id
      const radialGradient = defs
        .append("radialGradient")
        .attr("id", "radial-gradient-" + d2.gradientID)
        .attr("cx", d2.gradientX + "%") //The x-center of the gradient
        .attr("cy", d2.gradientY + "%") //The y-center of the gradient
        .attr("r", d2.gradientR + "%"); //The radius of the gradient

      //Add colors to make the gradient
      radialGradient
        .append("stop")
        .attr("offset", d2.gradientI + "%")
        .attr("stop-color", d2.invertGradient ? d2.color : "#FFFFFF");
      radialGradient
        .append("stop")
        .attr("offset", "100%")
        .attr("stop-color", d2.invertGradient ? "#FFFFFF" : d2.color);

      background
        .append("g")
        .append("path")
        .attr("transform", `translate(${d2.cx}, ${d2.cy}) rotate(180)`)
        .attr("d", d3.line().curve(d3.curveLinearClosed)(arrPoints))
        .style("stroke", d2.color)
        .style("stroke-width", d2.strokeWidth)
        .style(
          "fill",
          d2.gradientID
            ? "url(#radial-gradient-" + d2.gradientID + ")"
            : fading(d2.color, d2.polyFade)
        )
        .style("fill-opacity", d2.polyOpacity)
        .clone()
        .lower()
        .style("fill", d2.polyOpaque ? "white" : "")
        .style("fill-opacity", d2.polyOpaque ? 1 : 0);

      arrPoints = [];
    }
    // arrPoints.push([OB0txP, OB0tyP]); // outside of polygone
    arrPoints.push([OAixP(1), OAiyP(1)]);

    for (const p in d) {
      d2[p] = d[p];
    }

    // Adding Center Text for polygone
    const centerText = g
      .append("text")
      .style("font-weight", d.bold)
      .style("fill", darken(d.color, d.darkenFactor))
      .style("fill", "white")
      .attr("font-family", d.fontName)
      .attr("font-size", d.fontSize);

    const titleLines = d.centerText.split("//");

    if (titleLines.length == 1)
      // one line break
      centerText
        .text(d.centerText)
        .attr("text-anchor", "middle")
        .attr("dy", -d.up + "em");

    if (titleLines.length == 2)
      // one line break
      centerText
        .text(titleLines[0])
        .attr("text-anchor", "middle")
        .attr("dy", "-0.8" - d.up + "em")
        .clone(true)
        .text(titleLines[1])
        .attr("dy", "0.6" - d.up + "em");

    if (titleLines.length == 3)
      // two line breaks
      centerText
        .text(titleLines[0])
        .attr("text-anchor", "middle")
        .attr("dy", -1.2 - d.up + "em")
        .clone(true)
        .text(titleLines[1])
        .attr("dy", 0.1 - d.up + "em")
        .clone(true)
        .text(titleLines[2])
        .attr("dy", 1.4 - d.up + "em");

    // Function that split lines and add spacing
    const lines = d.text?.split("//");
    const numberOfLines = lines?.length;
    const line = (d, n) =>
      numberOfLines > 1
        ? lines[n - 1].split("").join("\u200A".repeat(d.letterSpacing))
        : d.text?.split("").join("\u200A".repeat(d.letterSpacing));

    // Arc //
    if (!d.square) {
      // Adding Arc
      g.append("path")
        .style("stroke", d.strokeColor ? d.strokeColor : d.color)
        .style("stroke-width", d.strokeWidth)
        // .style("fill", fading(d.color, d.fade))
        .style(
          "fill",
          d.gradientID
            ? "url(#radial-gradient-" + d.gradientID + ")"
            : fading(d.color, d.fade)
        )
        .style("fill-opacity", d.opacity)
        .attr(
          "d",
          d3
            .arc()
            .innerRadius(R)
            .outerRadius(R + r)
            .padAngle(d.padAngle)
            .startAngle(a)
            .endAngle(b)
            .cornerRadius(d.cornerRadius)
            .padRadius(d.padRadius)
        )
        .clone()
        .lower()
        .style("fill", d.opaque ? "white" : "")
        .style("fill-opacity", d.opaque ? 1 : 0);

      if (!d.radial) {
        // If Arc not radial
        // Adding Arc path for text
        g.append("path")
          .attr("id", id)
          .style("fill", "none")
          .attr("d", () => {
            const context = d3.path();
            context.arc(
              0,
              0,
              R,
              (atBottom ? b : a) - pi / 2,
              (atBottom ? a : b) - pi / 2,
              atBottom
            );
            return context.toString();
          });

        g.append("text")
          .style(
            "fill",
            d.opacity < d.opacityLimit || d.fade > d.fadeLimit
              ? darken(d.color, d.opacity * d.darkenFactor)
              : "white"
          )
          .style("font-size", d.fontSize)
          .style("font-weight", d.bold ? d.bold : "normal")
          .attr("font-family", d.fontName)
          .attr("dy", (d.innerR / 2) * (atBottom ? +1 : -0.9))
          .attr("dominant-baseline", "middle")
          .attr("text-anchor", "middle")
          .append("textPath")
          .attr("startOffset", "50%")
          .attr("xlink:href", "#" + id)
          .text(numberOfLines == 1 ? line(d, 1) : "")
          .select(function () {
            return this.parentNode;
          })
          .clone()
          .attr(
            "dy",
            (d.innerR / 2) *
              (atBottom ? +0.7 + d.bottomAdjust : -1.3 + d.topAdjust)
          )
          .append("textPath")
          .attr("startOffset", "50%")
          .attr("xlink:href", "#" + id)
          .text(numberOfLines > 1 ? line(d, 1) : "")
          .select(function () {
            return this.parentNode;
          })
          .clone()
          .attr(
            "dy",
            (d.innerR / 2) *
              (atBottom ? +1.5 + d.topAdjust : -0.55 + d.bottomAdjust)
          )
          .append("textPath")
          .attr("startOffset", "50%")
          .attr("xlink:href", "#" + id)
          .text(numberOfLines > 1 ? line(d, 2) : "");
      }
    }

    // Square Style or Radial
    if (d.radial || d.square) {
      function labelTransform(d, twoLines = 0) {
        // 0 middle, 1 up, 2 down

        // For arc radial transform
        const f = modPi(e - pi / 2); // clockwise from base
        const df = c / 3;
        const f2 =
          twoLines == 0 // Middle Line
            ? f
            : twoLines == 1 // Top Line
            ? d.flipLines
              ? f + df
              : f - df
            : d.flipLines // Bottom Line
            ? f - df
            : f + df;

        // For square transformations
        const cornerX = OAix(n - 1);
        const cornerY = OAiy(n - 1);
        const halfWayX = d.radial
          ? twoLines == 0 // Middle line
            ? (OAix(1) - OAix(0)) / 2
            : twoLines == 1 // Top Line
            ? ((OAix(1) - OAix(0)) * 4) / 6
            : ((OAix(1) - OAix(0)) * 2) / 6
          : (OAix(1) - OAix(0)) / 2;
        const halfWayY = d.radial
          ? twoLines == 0
            ? (OAiy(1) - OAiy(0)) / 2
            : twoLines == 1
            ? ((OAiy(1) - OAiy(0)) * 4) / 6
            : ((OAiy(1) - OAiy(0)) * 2) / 6
          : (OAiy(1) - OAiy(0)) / 2;
        const heightLineX = d.radial
          ? A0B0x / 2
          : twoLines == 0 // Middle line
          ? A0B0x / 2
          : twoLines == 1 // Top Line
          ? (A0B0x * 4) / 6
          : (A0B0x * 2) / 6; // Bottom Line
        const heightLineY = d.radial
          ? A0B0y / 2
          : twoLines == 0
          ? A0B0y / 2
          : twoLines == 1
          ? (A0B0y * 4) / 6
          : (A0B0y * 2) / 6;

        return d.square
          ? `translate(${cornerX + halfWayX + heightLineX},
            ${cornerY + halfWayY + heightLineY}
            )
           rotate(
            ${
              rTD(f) +
              (d.flipLetters ? 180 : 0) +
              (d.radial ? 0 : 90) +
              (atBottom ? 180 : 0) +
              (atLeft && d.radial ? 180 : 0)
            }
          )`
          : `rotate(${rTD(f2)}) translate(${R + r / 2},0) rotate(${
              (d.flipLetters ? 180 : 0) + atLeft ? 180 : 0 // arc radial
            })`;
      }

      g.append("text")
        .style(
          "fill",
          d.opacity < d.opacityLimit || d.fade > d.fadeLimit
            ? darken(d.color, d.opacity * d.darkenFactor)
            : "white"
        )
        .style("font-size", d.fontSize)
        .style("font-weight", d.bold ? d.bold : "normal")
        .attr("font-family", d.fontName)
        .attr("dominant-baseline", "middle")
        .attr("text-anchor", "middle")
        .text(
          line(
            d,
            (!d.flipLines && numberOfLines > 1 && atLeft) ^
              (!d.radial && !atLeft)
              ? 1
              : 2
          )
        )
        .attr(
          "transform",
          numberOfLines > 1 ? labelTransform(d, 1) : labelTransform(d, 0)
        )
        .clone()
        .text(
          numberOfLines > 1
            ? line(
                d,
                (!d.flipLines && numberOfLines > 1 && atLeft) ^
                  (!d.radial && !atLeft)
                  ? 2
                  : 1
              )
            : ""
        )
        .attr("transform", labelTransform(d, 2));
    }
  });

  const svgRing = svg.node().innerHTML;
  svgOrigin.append("g").html(svgRing);
}
)}

function _selectedLanguage(select,languages){return(
select({
  options: languages,
  value: "english",
  title: "Languages"
})
)}

function _darkColors(option){return(
option.includes("darkColors")
)}

function _colorFourNobleTruths(color,darkColors){return(
color({
  value: darkColors ? "#321a3c" : "#54364c",
  title: "4 Noble T."
})
)}

function _colorSuffering(color,darkColors){return(
color({
  value: darkColors ? "#28391e" : "#344927",
  title: "Suffering"
})
)}

function _colorOrigin(color,darkColors){return(
color({
  value: darkColors ? "#763737": "#8b4141",
  title: "Origin"
})
)}

function _colorCessation(color,darkColors){return(
color({
  value: darkColors ? "#102051" : "#1b306f",
  title: "Cessation"
})
)}

function _colorPath(color,darkColors){return(
color({
  value: darkColors ? "#5d440e" : "#5f4611",
  title: "Path"
})
)}

function _PNGprecision(slider){return(
slider({
  title: "PNG Resolution Factor",
  min: 0,
  max: 12,
  step: 1,
  value: 3
})
)}

function _zoom(slider,zoomAt){return(
slider({
  title: "Zoom",
  min: 0.1,
  max: 1.5,
  step: 0.01,
  value: zoomAt
})
)}

function _zoomAt(Inputs){return(
Inputs.button(
  [
    ["Outer Wall", (value) => 0.44],
    ["Battlements", (value) => 0.32],
    ["Flanking Tower", (value) => 0.24],
    ["Overview", (value) => 0.21]
  ],
  { value: 0.21 }
)
)}

function _zC(zoomCenter)
{
  zoomCenter;
  return 0.44;
}


function _zOS(zoomOuterSquare)
{
  zoomOuterSquare;
  return 0.36;
}


function _zoomCenter(Inputs){return(
Inputs.button("Center Square")
)}

function _zoomOuterSquare(Inputs){return(
Inputs.button("Outer Square")
)}

function _updateChart(Inputs){return(
Inputs.button("Refresh Translation")
)}

/*
function _url(){return(
"https://docs.google.com/spreadsheets/d/14jOoMTnVV0dQc4NZ8keP3pjiLVOrS4IIDPc_xISSxlA/edit?usp=sharing"
)}
*/

function _url(){return(
"https://docs.google.com/spreadsheets/d/1FU5X6W1Gzk3Fv7rdbaUJ11Q2RTQRb20PVGKZI9Uul9w/edit#gid=0"
)}


function _getCsvUrl(URLSearchParams){return(
(url) => {
  url = new URL(url);
  const id = url.pathname.split("/")[3];
  const gid = new URLSearchParams(url.hash.slice(1)).get("gid") || 0;
  return `https://docs.google.com/spreadsheets/d/${id}/export?format=csv&gid=${gid}`;
}
)}

function _data0(updateChart,d3,getCsvUrl,url)
{
  updateChart;
  return d3.csv(getCsvUrl(url), d3.autoType);
}


function _data1(d3,getCsvUrl,url)
{
  return d3.csv(getCsvUrl(url), d3.autoType);
}


function _languages(data1)
{
  const arr = data1.columns.filter((d) => d.includes("FontSize"));
  return arr.map((d) => d.replace("FontSize", ""));
}


function _data(data0,selectedLanguage){return(
data0.map((d) => {
  return {
    id: d.id,
    text: d[selectedLanguage] ? d[selectedLanguage] : "",
    fontSize: d[selectedLanguage + "FontSize"]
      ? d[selectedLanguage + "FontSize"]
      : 10,
    letterSpacing: d[selectedLanguage + "LetterSpacing"]
      ? d[selectedLanguage + "LetterSpacing"]
      : 0
  };
})
)}

function _GFontToDataURI(){return(
function GFontToDataURI(url) {
  return fetch(url) // first fecth the embed stylesheet page
    .then((resp) => resp.text()) // we only need the text of it
    .then((text) => {
      // now we need to parse the CSSruleSets contained
      // but chrome doesn't support styleSheets in DOMParsed docs...
      let s = document.createElement("style");
      s.innerHTML = text;
      document.head.appendChild(s);
      let styleSheet = s.sheet;

      // this will help us to keep track of the rules and the original urls
      let FontRule = (rule) => {
        let src =
          rule.style.getPropertyValue("src") ||
          rule.style.cssText.match(/url\(.*?\)/g)[0];
        if (!src) return null;
        let url = src.split("url(")[1].split(")")[0];
        return {
          rule: rule,
          src: src,
          url: url.replace(/\"/g, "")
        };
      };
      let fontRules = [],
        fontProms = [];

      // iterate through all the cssRules of the embedded doc
      // Edge doesn't make CSSRuleList enumerable...
      for (let i = 0; i < styleSheet.cssRules.length; i++) {
        let r = styleSheet.cssRules[i];
        let fR = FontRule(r);
        if (!fR) {
          continue;
        }
        fontRules.push(fR);
        fontProms.push(
          fetch(fR.url) // fetch the actual font-file (.woff)
            .then((resp) => resp.blob())
            .then((blob) => {
              return new Promise((resolve) => {
                // we have to return it as a dataURI
                //   because for whatever reason,
                //   browser are afraid of blobURI in <img> too...
                let f = new FileReader();
                f.onload = (e) => resolve(f.result);
                f.readAsDataURL(blob);
              });
            })
            .then((dataURL) => {
              // now that we have our dataURI version,
              //  we can replace the original URI with it
              //  and we return the full rule's cssText
              return fR.rule.cssText.replace(fR.url, dataURL);
            })
        );
      }
      document.head.removeChild(s); // clean up
      return Promise.all(fontProms); // wait for all this has been done
    });
}
)}

function _rasterize(DOM,PNGprecision,serialize){return(
function rasterize(svg) {
  let resolve, reject;
  const promise = new Promise((y, n) => ((resolve = y), (reject = n)));
  const image = new Image();
  image.onerror = reject;
  image.onload = () => {
    const rect = svg.getBoundingClientRect();
    const context = DOM.context2d(
      rect.width * PNGprecision,
      rect.height * PNGprecision
    );
    context.drawImage(
      image,
      0,
      0,
      rect.width * PNGprecision,
      rect.height * PNGprecision
    );
    context.canvas.toBlob(resolve, "image/png", 1);
  };
  image.src = URL.createObjectURL(serialize(svg));
  return promise;
}
)}

function _rasterizeWhite(DOM,PNGprecision,serialize){return(
function rasterizeWhite(svg) {
  let resolve, reject;
  const promise = new Promise((y, n) => ((resolve = y), (reject = n)));
  const image = new Image();
  image.onerror = reject;
  image.onload = () => {
    const rect = svg.getBoundingClientRect();
    const context = DOM.context2d(
      rect.width * PNGprecision,
      rect.height * PNGprecision
    );
    context.fillStyle = "white";
    context.fillRect(
      0,
      0,
      rect.width * PNGprecision,
      rect.height * PNGprecision
    );
    context.drawImage(
      image,
      0,
      0,
      rect.width * PNGprecision,
      rect.height * PNGprecision
    );
    context.canvas.toBlob(resolve, "image/png", 1);
  };
  image.src = URL.createObjectURL(serialize(svg));
  return promise;
}
)}

function _85(FileAttachment){return(
FileAttachment("Chart43-dark2.png").image()
)}

function _screenshot20221130At154010(FileAttachment){return(
FileAttachment("Screenshot 2022-11-30 at 15.40.10.png").image()
)}

function _medievalCastleTerminology(FileAttachment){return(
FileAttachment(
  "Medieval-Castle-Terminology.webp"
).image()
)}

export default function define(runtime, observer) {
  const main = runtime.module();
  function toString() { return this.url; }
  const fileAttachments = new Map([
    ["Chart43-dark2.png", {url: new URL("./files/96dc7f6d63ffafdbd82ae0e4fe21dce75a22821363cdbfd7430b2d6559884c66594614ce90b01cd2a72f3d3a0c57e57f1b0f51e92956fe27aeb1544e05d51862.png", import.meta.url), mimeType: "image/png", toString}],
    ["Screenshot 2022-11-30 at 15.40.10.png", {url: new URL("./files/90aedc63dc1c58218eb48ea5dcf9e18c0de264d9121d6c7d9fdfc7b294a0a4c5e937f6d4dd719c271540201f86619347c16a9a3993cbfd1197bef1924b655b59.png", import.meta.url), mimeType: "image/png", toString}],
    ["Medieval-Castle-Terminology.webp", {url: new URL("./files/7df0193ccdb6de2e1d8efad4c99eff4d1f31f7c58be89b5cf0bd09059758699dd4f9adcac89d6d0070e087a7d200d12daa543baa64747771d3b1fead14aa2209.webp", import.meta.url), mimeType: "image/webp", toString}]
  ]);
  main.builtin("FileAttachment", runtime.fileAttachments(name => fileAttachments.get(name)));
  main.variable(observer()).define(["md"], _1);
  main.variable(observer()).define(["md"], _2);
  main.variable(observer()).define(["viewof colorFourNobleTruths","viewof colorSuffering","viewof colorOrigin","viewof colorCessation","viewof colorPath","htl"], _3);
  main.variable(observer("viewof option")).define("viewof option", ["checkbox"], _option);
  main.variable(observer("option")).define("option", ["Generators", "viewof option"], (G, _) => G.input(_));
  main.variable(observer("viewof check")).define("viewof check", ["checkbox"], _check);
  main.variable(observer("check")).define("check", ["Generators", "viewof check"], (G, _) => G.input(_));
  main.variable(observer()).define(["viewof PNGprecision","DOM","rasterizeWhite","chart","serialize","viewof zoom","viewof zoomAt","viewof selectedLanguage","viewof updateChart","htl"], _6);
  main.variable(observer("chart")).define("chart", ["d3","zoom","x","y","GFontToDataURI","check","drawRing","Ramparts","grass1","grass2","grass3","grass4","DonjonChemise","HigherBaileyTitle","HigherBailey","LowerBaileySubTitle","LowerBaileyTitle","LowerBailey","Donjon","InnerWall","InnerWallTitle","CornerStones","OuterWallBackGround","OuterWall","OuterWallTitle","WBattlements","EBattlements","NEBattlements","SBattlements","SBattlements2","WBattlementsNumbers","SBattlementsNumbers","EBattlementsNumbers","EBattlementsNumbersTitle","WBattlementsTitle","EBattlementsTitle","NBattlementsTitle","SBattlementsTitle","NWCornerTower","NECornerTower","SECornerTower","NECornerTowerSubTitle","SWCornerTower","Moat","MoatTitle","EFlankingTowerTitle","EFlankingTower","NFlankingTowerTitle","WFlankingTowerTitle","SFlankingTowerTitle","NFlankingTower","NNEWatchTower","ENEWatchTower"], _chart);
  main.variable(observer("viewof x")).define("viewof x", ["Inputs"], _x);
  main.variable(observer("x")).define("x", ["Generators", "viewof x"], (G, _) => G.input(_));
  main.variable(observer("viewof y")).define("viewof y", ["Inputs"], _y);
  main.variable(observer("y")).define("y", ["Generators", "viewof y"], (G, _) => G.input(_));
  main.variable(observer("p")).define("p", _p);
  main.variable(observer("grass2")).define("grass2", ["p","colorCessation","colorPath","colorOrigin","colorSuffering"], _grass2);
  main.variable(observer("grass3")).define("grass3", ["p","colorCessation","colorPath","colorOrigin","colorSuffering"], _grass3);
  main.variable(observer("grass4")).define("grass4", ["p","colorCessation","colorPath","colorOrigin","colorSuffering"], _grass4);
  main.variable(observer("grass1")).define("grass1", ["p","colorCessation","colorPath","colorOrigin","colorSuffering","option"], _grass1);
  main.variable(observer("NNEWatchTower")).define("NNEWatchTower", ["p","colorPath","dataOfId"], _NNEWatchTower);
  main.variable(observer("ENEWatchTower")).define("ENEWatchTower", ["p","colorPath","dataOfId"], _ENEWatchTower);
  main.variable(observer("Ramparts")).define("Ramparts", ["p","colorFourNobleTruths","colorPath"], _Ramparts);
  main.variable(observer("Moat")).define("Moat", ["p","colorCessation","colorSuffering","dataOfId"], _Moat);
  main.variable(observer("MoatTitle")).define("MoatTitle", ["p","dataOfId","colorCessation","colorSuffering"], _MoatTitle);
  main.variable(observer("NFlankingTowerTitle")).define("NFlankingTowerTitle", ["p","dataOfId","colorCessation"], _NFlankingTowerTitle);
  main.variable(observer("WFlankingTowerTitle")).define("WFlankingTowerTitle", ["p","dataOfId","colorSuffering"], _WFlankingTowerTitle);
  main.variable(observer("SFlankingTowerTitle")).define("SFlankingTowerTitle", ["p","dataOfId","colorOrigin"], _SFlankingTowerTitle);
  main.variable(observer("NFlankingTower")).define("NFlankingTower", ["p","colorCessation","dataOfId"], _NFlankingTower);
  main.variable(observer("EFlankingTowerTitle")).define("EFlankingTowerTitle", ["p","dataOfId","colorPath"], _EFlankingTowerTitle);
  main.variable(observer("EFlankingTower")).define("EFlankingTower", ["p","dataOfId","colorPath"], _EFlankingTower);
  main.variable(observer("NEBattlements")).define("NEBattlements", ["p","colorPath","colorSuffering"], _NEBattlements);
  main.variable(observer("SBattlements")).define("SBattlements", ["p","dataOfId","colorOrigin","colorCessation"], _SBattlements);
  main.variable(observer("SBattlements2")).define("SBattlements2", ["p","dataOfId","colorPath","colorSuffering"], _SBattlements2);
  main.variable(observer("SBattlementsNumbers")).define("SBattlementsNumbers", ["p","dataOfId","colorPath","colorSuffering"], _SBattlementsNumbers);
  main.variable(observer("SBattlementsTitle")).define("SBattlementsTitle", ["p","dataOfId","colorPath","colorCessation","colorOrigin","colorSuffering"], _SBattlementsTitle);
  main.variable(observer("NBattlementsTitle")).define("NBattlementsTitle", ["p","colorCessation"], _NBattlementsTitle);
  main.variable(observer("WBattlementsTitle")).define("WBattlementsTitle", ["p","dataOfId","colorSuffering"], _WBattlementsTitle);
  main.variable(observer("WBattlements")).define("WBattlements", ["p","dataOfId","colorSuffering"], _WBattlements);
  main.variable(observer("WBattlementsNumbers")).define("WBattlementsNumbers", ["p","dataOfId","colorSuffering"], _WBattlementsNumbers);
  main.variable(observer("EBattlementsTitle")).define("EBattlementsTitle", ["p","colorPath","dataOfId"], _EBattlementsTitle);
  main.variable(observer("EBattlementsNumbers")).define("EBattlementsNumbers", ["p","colorPath"], _EBattlementsNumbers);
  main.variable(observer("EBattlementsNumbersTitle")).define("EBattlementsNumbersTitle", ["p","colorPath","dataOfId"], _EBattlementsNumbersTitle);
  main.variable(observer("EBattlements")).define("EBattlements", ["p","dataOfId","colorPath"], _EBattlements);
  main.variable(observer("NWCornerTower")).define("NWCornerTower", ["p","colorSuffering","dataOfId"], _NWCornerTower);
  main.variable(observer("SECornerTower")).define("SECornerTower", ["p","colorPath","dataOfId"], _SECornerTower);
  main.variable(observer("SWCornerTower")).define("SWCornerTower", ["p","colorSuffering","dataOfId"], _SWCornerTower);
  main.variable(observer("NECornerTower")).define("NECornerTower", ["p","colorPath","dataOfId"], _NECornerTower);
  main.variable(observer("NECornerTowerSubTitle")).define("NECornerTowerSubTitle", ["p","colorPath","dataOfId"], _NECornerTowerSubTitle);
  main.variable(observer("CornerStones")).define("CornerStones", ["p","dataOfId","colorPath","colorCessation","colorSuffering","colorOrigin"], _CornerStones);
  main.variable(observer("OuterWall")).define("OuterWall", ["p","dataOfId","colorCessation","colorOrigin"], _OuterWall);
  main.variable(observer("OuterWallBackGround")).define("OuterWallBackGround", ["p","colorCessation","dataOfId","colorOrigin"], _OuterWallBackGround);
  main.variable(observer("OuterWallTitle")).define("OuterWallTitle", ["p","colorCessation","dataOfId","colorOrigin"], _OuterWallTitle);
  main.variable(observer("InnerWallTitle")).define("InnerWallTitle", ["p","dataOfId","colorOrigin","colorCessation"], _InnerWallTitle);
  main.variable(observer("InnerWall")).define("InnerWall", ["p","colorOrigin","colorCessation","dataOfId"], _InnerWall);
  main.variable(observer("LowerBaileySubTitle")).define("LowerBaileySubTitle", ["p","colorSuffering","dataOfId","colorCessation","colorOrigin"], _LowerBaileySubTitle);
  main.variable(observer("LowerBaileyTitle")).define("LowerBaileyTitle", ["p","colorSuffering","dataOfId","colorCessation","colorOrigin","colorPath"], _LowerBaileyTitle);
  main.variable(observer("LowerBailey")).define("LowerBailey", ["p","dataOfId","colorSuffering","colorCessation","colorOrigin","colorPath"], _LowerBailey);
  main.variable(observer("HigherBaileyTitle")).define("HigherBaileyTitle", ["p","dataOfId","colorSuffering","colorOrigin","colorCessation","colorPath"], _HigherBaileyTitle);
  main.variable(observer("HigherBailey")).define("HigherBailey", ["p","dataOfId","colorSuffering","colorOrigin","colorCessation","colorPath"], _HigherBailey);
  main.variable(observer("DonjonChemise")).define("DonjonChemise", ["p","dataOfId","colorFourNobleTruths"], _DonjonChemise);
  main.variable(observer("Donjon")).define("Donjon", ["p","colorFourNobleTruths","dataOfId","colorSuffering","colorOrigin","colorCessation","colorPath"], _Donjon);
  main.variable(observer("dataOfId")).define("dataOfId", ["data"], _dataOfId);
  main.variable(observer("drawRing")).define("drawRing", ["d3","DOM"], _drawRing);
  main.variable(observer("viewof selectedLanguage")).define("viewof selectedLanguage", ["select","languages"], _selectedLanguage);
  main.variable(observer("selectedLanguage")).define("selectedLanguage", ["Generators", "viewof selectedLanguage"], (G, _) => G.input(_));
  main.variable(observer("darkColors")).define("darkColors", ["option"], _darkColors);
  main.variable(observer("viewof colorFourNobleTruths")).define("viewof colorFourNobleTruths", ["color","darkColors"], _colorFourNobleTruths);
  main.variable(observer("colorFourNobleTruths")).define("colorFourNobleTruths", ["Generators", "viewof colorFourNobleTruths"], (G, _) => G.input(_));
  main.variable(observer("viewof colorSuffering")).define("viewof colorSuffering", ["color","darkColors"], _colorSuffering);
  main.variable(observer("colorSuffering")).define("colorSuffering", ["Generators", "viewof colorSuffering"], (G, _) => G.input(_));
  main.variable(observer("viewof colorOrigin")).define("viewof colorOrigin", ["color","darkColors"], _colorOrigin);
  main.variable(observer("colorOrigin")).define("colorOrigin", ["Generators", "viewof colorOrigin"], (G, _) => G.input(_));
  main.variable(observer("viewof colorCessation")).define("viewof colorCessation", ["color","darkColors"], _colorCessation);
  main.variable(observer("colorCessation")).define("colorCessation", ["Generators", "viewof colorCessation"], (G, _) => G.input(_));
  main.variable(observer("viewof colorPath")).define("viewof colorPath", ["color","darkColors"], _colorPath);
  main.variable(observer("colorPath")).define("colorPath", ["Generators", "viewof colorPath"], (G, _) => G.input(_));
  main.variable(observer("viewof PNGprecision")).define("viewof PNGprecision", ["slider"], _PNGprecision);
  main.variable(observer("PNGprecision")).define("PNGprecision", ["Generators", "viewof PNGprecision"], (G, _) => G.input(_));
  main.variable(observer("viewof zoom")).define("viewof zoom", ["slider","zoomAt"], _zoom);
  main.variable(observer("zoom")).define("zoom", ["Generators", "viewof zoom"], (G, _) => G.input(_));
  main.variable(observer("viewof zoomAt")).define("viewof zoomAt", ["Inputs"], _zoomAt);
  main.variable(observer("zoomAt")).define("zoomAt", ["Generators", "viewof zoomAt"], (G, _) => G.input(_));
  main.variable(observer("zC")).define("zC", ["zoomCenter"], _zC);
  main.variable(observer("zOS")).define("zOS", ["zoomOuterSquare"], _zOS);
  main.variable(observer("viewof zoomCenter")).define("viewof zoomCenter", ["Inputs"], _zoomCenter);
  main.variable(observer("zoomCenter")).define("zoomCenter", ["Generators", "viewof zoomCenter"], (G, _) => G.input(_));
  main.variable(observer("viewof zoomOuterSquare")).define("viewof zoomOuterSquare", ["Inputs"], _zoomOuterSquare);
  main.variable(observer("zoomOuterSquare")).define("zoomOuterSquare", ["Generators", "viewof zoomOuterSquare"], (G, _) => G.input(_));
  main.variable(observer("viewof updateChart")).define("viewof updateChart", ["Inputs"], _updateChart);
  main.variable(observer("updateChart")).define("updateChart", ["Generators", "viewof updateChart"], (G, _) => G.input(_));
  const child1 = runtime.module(define1);
  main.import("slider", child1);
  main.import("select", child1);
  main.import("color", child1);
  main.import("checkbox", child1);
  main.import("button", child1);
  main.variable(observer("url")).define("url", _url);
  main.variable(observer("getCsvUrl")).define("getCsvUrl", ["URLSearchParams"], _getCsvUrl);
  main.variable(observer("data0")).define("data0", ["updateChart","d3","getCsvUrl","url"], _data0);
  main.variable(observer("data1")).define("data1", ["d3","getCsvUrl","url"], _data1);
  main.variable(observer("languages")).define("languages", ["data1"], _languages);
  main.variable(observer("data")).define("data", ["data0","selectedLanguage"], _data);
  main.variable(observer("GFontToDataURI")).define("GFontToDataURI", _GFontToDataURI);
  main.variable(observer("rasterize")).define("rasterize", ["DOM","PNGprecision","serialize"], _rasterize);
  const child2 = runtime.module(define2);
  main.import("serialize", child2);
  main.variable(observer("rasterizeWhite")).define("rasterizeWhite", ["DOM","PNGprecision","serialize"], _rasterizeWhite);
  main.variable(observer()).define(["FileAttachment"], _85);
  main.variable(observer("screenshot20221130At154010")).define("screenshot20221130At154010", ["FileAttachment"], _screenshot20221130At154010);
  main.variable(observer("medievalCastleTerminology")).define("medievalCastleTerminology", ["FileAttachment"], _medievalCastleTerminology);
  return main;
}


</script>
