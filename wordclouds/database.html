<!DOCTYPE html>
<html>
<head>
  <title>Google Sheets Form</title>
</head>
<body>
  <form id="myForm">
    <label for="id">ID:</label>
    <input type="text" id="id" name="id" required><br><br>
    
    <label for="message">Message:</label><br>
    <textarea id="message" name="message" rows="5" cols="30" required></textarea><br><br>
    
    <button type="submit">Submit</button>
  </form>

  <script>
    document.getElementById("myForm").addEventListener("submit", function(event) {
  event.preventDefault(); // Prevent the form from submitting normally

  var id = document.getElementById("id").value;
  var message = document.getElementById("message").value;

  var data = {
    id: id,
    message: message
  };

  var url = "https://script.google.com/macros/s/AKfycbxrdw8jYxD3qXBkGLPMC7EL78j-BLgRKEQ7805njkZkncymxE72yfG2Kfnrd0ouN2mVMA/exec";

  var proxyUrl = 'https://cors-anywhere.herokuapp.com/' + url; // Lis채채 t채m채 rivi

  fetch(proxyUrl, { // Korvaa 'url' 'proxyUrl'-muuttujalla
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(data)
  })
  .then(response => response.text())
  .then(result => {
    console.log(result);
    // Optionally, display a success message or perform any other desired actions
  })
  .catch(error => {
    console.error('Error:', error);
    // Optionally, display an error message or perform any other desired actions
  });
});

  </script>
</body>
</html>
